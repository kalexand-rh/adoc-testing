

<!DOCTYPE html>
<!--[if IE 8]> <html class="ie8"> <![endif]-->
<!--[if IE 9]> <html class="ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html>
<!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  
  <title>Installing a cluster on AWS using CloudFormation templates - Installing on user-provisioned AWS | Installing | OpenShift Container Platform 4.1</title>
  <link href="https://assets.openshift.net/content/subdomain.css" rel="stylesheet" type="text/css">
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/docs.css" rel="stylesheet" />
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/search.css" rel="stylesheet" />
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/autumn.css" rel="stylesheet" />
  <link href="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" type="image/png">
  <link href="https://assets.openshift.net/content/subdomain/favicon32x32.png" rel="shortcut icon" type="text/css">
  <link href="https://assets.openshift.net/content/osh-nav-footer.css" rel="stylesheet" type="text/css" media="screen, print" />
  <!--[if IE]><link rel="shortcut icon" href="https://assets.openshift.net/content/subdomain/favicon.ico"><![endif]-->
  <!-- or, set /favicon.ico for IE10 win -->
  <meta content="OpenShift" name="application-name">
  <meta content="#000000" name="msapplication-TileColor">
  <meta content="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" name="msapplication-TileImage">
  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PMDVKG');</script>
<!-- End Google Tag Manager -->

<!-- Adobe DTM -->
<script src="//www.redhat.com/dtm.js" type="text/javascript"></script>
<!-- End Adobe DTM -->
</head>
<body onload="selectVersion('4.1');">
  <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PMDVKG"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<nav id="main">
  <div class="container">
    <div class="row">
      <div class="navbar navbar-default navbar-openshift" role="navigation">
        <div class="navbar-header">
            <a href="#nav-main" class="dropdown-toggle navbar-menu-toggle hidden visible-xs" data-toggle="collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>
          <a class="navbar-brand" href="/"></a>
        </div>
        <div id="nav-main" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li id="products" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="true">
                Products <span class="fa fa-angle-down"></span>
              </a>
              <div class="dropdown-menu">
                <div class="row flex-column flex-md-row">
                  <div class="col-xs-12 col-sm-3">
                    <h3>Overview</h3>
                    <ul class="nav flex-column">
                      <li><a target="_blank" href="https://www.openshift.com/products/features/">Features</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/products/pricing/">Pricing</a></li>
                    </ul>
                  </div>
                  <div class="col-xs-12 col-sm-9">
                    <h3>Featured Products</h3>
                    <ul class="nav">
                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/container-platform/">Red Hat OpenShift Container&nbsp;Platform</a>
                        <p class="d-none d-md-block">Build, deploy and manage your applications across cloud- and on-premise infrastructure</p>
                      </li>
                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/dedicated/">Red Hat OpenShift Dedicated</a>
                        <p class="d-none d-md-block">Single-tenant, high-availability Kubernetes clusters in the public cloud</p>
                      </li>

                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/online/">Red Hat OpenShift Online</a>
                        <p class="d-none d-md-block">The fastest way for developers to build, host and scale applications in the public cloud</p>
                      </li>

                      <li class="nav-item">
                        <a target="_blank" href="https://www.openshift.com/products/">All products <span class="fa fa-angle-right"></span></a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>

            <li id="learn" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Learn <span class="fa fa-angle-down"></span>
              </a>
              <div class="dropdown-menu">
                <div class="row flex-md-nowrap">
                  <div class="col-xs-12 col-sm-6">
                    <h3>Learn</h3>
                    <ul class="nav">
                      <li><a target="_blank" href="https://www.openshift.com/learn/what-is-openshift/">What is OpenShift</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/get-started/">Get started</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/partners/">Partners</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/success-stories/">Customer success stories</a></li>
                      <li><a target="_blank" href="https://blog.openshift.com">Blog</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/resources/">Resources</a></li>
                    </ul>
                  </div>
                  <div class="col-xs-12 col-sm-6">
                    <h3>Technology Topics</h3>
                    <ul class="nav">
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/knative/">Knative</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/security/">Security</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/kubernetes/">Kubernetes</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/service-brokers/">Service Brokers</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Community <span class="fa fa-angle-down"></span>
              </a>
              <ul class="dropdown-menu">
                <li><a target="_blank" href="https://commons.openshift.org">OpenShift Commons</a></li>
                <li><a target="_blank" href="https://www.okd.io">Open Source (OKD)</a></li>
                <li><a target="_blank" href="https://www.openshift.com/community/programs/startups/">Startups</a></li>
                <li><a target="_blank" href="https://www.openshift.com/community/programs/grants/">Grants</a></li>
              </ul>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Support <span class="fa fa-angle-down"></span>
              </a>
              <ul class="dropdown-menu">
                <li><a target="_blank" href="https://help.openshift.com">Help Center</a></li>
                <li><a href="https://docs.openshift.com">OpenShift Docs</a></li>
              </ul>
            </li>

            <li><a target="_blank" class="nav-sign-up" href="https://www.openshift.com/trial/">Free Trial</a></li>

            <li><a target="_blank" href="https://manage.openshift.com" class="nav-sign-in">Log In <span class="fa fa-angle-right"></span></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</nav>

  
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a href="/">Documentation</a>
      </li>
      <li class="hidden-xs active">
        
          
            <a href="https://docs.openshift.com/container-platform/4.1/welcome/index.html">
              OpenShift Container Platform
            </a>
          
          <select id="version-selector" onchange="versionSelector(this);">
              
              <option value="4.7">4.7</option>
              <option value="4.6">4.6</option>
              <option value="4.5">4.5</option>
              <option value="4.4">4.4</option>
              <option value="4.3">4.3</option>
              <option value="4.2">4.2</option>
              <option value="4.1">4.1</option>
              <option value="3.11">3.11</option>
              <option value="3.10">3.10</option>
              <option value="3.9">3.9</option>
              <option value="3.7">3.7</option>
              <option value="3.6">3.6</option>
              <option value="3.5">3.5</option>
              <option value="3.4">3.4</option>
              <option value="3.3">3.3</option>
              <option value="3.2">3.2</option>
              <option value="3.1">3.1</option>
              <option value="3.0">3.0</option>
          </select>
        
      </li>
      <li class="hidden-xs active">
        Installing
      </li>
      <li class="hidden-xs active"><a href="../../installing/installing_aws_user_infra/installing-aws-user-infra.html">Installing on user-provisioned AWS</a></li>
      <li class="hidden-xs active">
        Installing a cluster on AWS using CloudFormation templates
      </li>

      
      <span text-align="right" style="float: right !important">
        <a href="https://github.com/openshift/openshift-docs/commits/enterprise-4.1/installing/installing_aws_user_infra/installing-aws-user-infra.adoc">
          Page history
        </a>
        
      </span>
      
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <div class="row-fluid">
          <div id="hc-search">
            <input id="hc-search-input" type="text">
            <button id="hc-search-btn">Search</button>
          </div>

          <div id="hc-search-modal">
            <div id="hc-modal-content">
              <span id="hc-modal-close">&times;</span>
              <div id="hc-search-results-wrapper">
                <div id="hc-search-results"></div>
                <div id="hc-search-progress-indicator" class="text-center search-progress-indicator"><i class="fa fa-circle-o-notch fa-spin" style="font-size:42px"></i></div>
                <div class="text-center">
                  <button id="hc-search-more-btn">Show more results</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <ul class="nav nav-sidebar">

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-right"></span>
          Welcome
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup0" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../welcome/index.html">Welcome</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../welcome/oce_about.html">About OpenShift Container Engine</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../welcome/legal-notice.html">Legal notice</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup1">
        <span id="tgSpan1" class="fa fa-angle-right"></span>
          Release notes
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup1" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../release_notes/ocp-4-1-release-notes.html">OpenShift Container Platform 4.1 release notes</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../release_notes/versioning-policy.html">Versioning policy</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup2">
        <span id="tgSpan2" class="fa fa-angle-right"></span>
          Architecture
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup2" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../architecture/architecture.html">Product architecture</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../architecture/architecture-installation.html">Installation and update</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../architecture/control-plane.html">The control plane</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../architecture/understanding-development.html">Understanding OpenShift development</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../architecture/architecture-rhcos.html">Red Hat Enterprise Linux CoreOS</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup3">
        <span id="tgSpan3" class="fa fa-angle-down"></span>
          Installing
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup3" class="collapse in list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-3-0">
                <span id="sgSpan-3-0" class="fa fa-caret-right"></span>
                  &nbsp;Installing on AWS

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-3-0" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../installing/installing_aws/installing-aws-account.html">
                      Configuring an AWS account
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../installing/installing_aws/installing-aws-default.html">
                      Installing a cluster quickly on AWS
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../installing/installing_aws/installing-aws-customizations.html">
                      Installing a cluster on AWS with customizations
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../installing/installing_aws/installing-aws-network-customizations.html">
                      Installing a cluster on AWS with network customizations
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../installing/installing_aws/uninstalling-cluster-aws.html">
                      Uninstalling a cluster on AWS
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-3-1">
                <span id="sgSpan-3-1" class="fa fa-caret-down"></span>
                  &nbsp;Installing on user-provisioned AWS

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-3-1" class="nav-tertiary list-unstyled collapse in">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class=" active" href="../../installing/installing_aws_user_infra/installing-aws-user-infra.html">
                      Installing a cluster on AWS using CloudFormation templates
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-3-2">
                <span id="sgSpan-3-2" class="fa fa-caret-right"></span>
                  &nbsp;Installing on bare metal

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-3-2" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../installing/installing_bare_metal/installing-bare-metal.html">
                      Installing a cluster on bare metal
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-3-3">
                <span id="sgSpan-3-3" class="fa fa-caret-right"></span>
                  &nbsp;Installing on vSphere

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-3-3" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../installing/installing_vsphere/installing-vsphere.html">
                      Installing a cluster on vSphere
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../installing/installing-gather-logs.html">Gathering installation logs</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-3-5">
                <span id="sgSpan-3-5" class="fa fa-caret-right"></span>
                  &nbsp;Installation configuration

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-3-5" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../installing/install_config/customizations.html">
                      Available cluster customizations
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../installing/install_config/configuring-firewall.html">
                      Configuring your firewall
                    </a>
                  </li>

                

              </ul>
            </li>
      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup4">
        <span id="tgSpan4" class="fa fa-angle-right"></span>
          Updating clusters
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup4" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../updating/updating-cluster.html">Updating a cluster within a minor version from the web console</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../updating/updating-cluster-cli.html">Updating a cluster within a minor version by using the CLI</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../updating/updating-cluster-rhel-compute.html">Updating a cluster that includes RHEL compute machines</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup5">
        <span id="tgSpan5" class="fa fa-angle-right"></span>
          Support
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup5" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../support/getting-support.html">Getting support</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../support/gathering-cluster-data.html">Gathering data about your cluster</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup6">
        <span id="tgSpan6" class="fa fa-angle-right"></span>
          Web console
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup6" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../web-console/web-console.html">Accessing the web console</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../web-console/configuring-web-console.html">Configuring the web console</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../web-console/disabling-web-console.html">Disabling the web console</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup7">
        <span id="tgSpan7" class="fa fa-angle-right"></span>
          Authentication
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup7" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../authentication/understanding-authentication.html">Understanding authentication</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../authentication/configuring-internal-oauth.html">Configuring the internal OAuth server</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../authentication/understanding-identity-provider.html">Understanding identity provider configuration</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-7-3">
                <span id="sgSpan-7-3" class="fa fa-caret-right"></span>
                  &nbsp;Configuring identity providers

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-7-3" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../authentication/identity_providers/configuring-htpasswd-identity-provider.html">
                      Configuring an HTPasswd identity provider
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../authentication/identity_providers/configuring-keystone-identity-provider.html">
                      Configuring a Keystone identity provider
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../authentication/identity_providers/configuring-ldap-identity-provider.html">
                      Configuring an LDAP identity provider
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../authentication/identity_providers/configuring-basic-authentication-identity-provider.html">
                      Configuring a basic authentication identity provider
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../authentication/identity_providers/configuring-request-header-identity-provider.html">
                      Configuring a request header identity provider
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../authentication/identity_providers/configuring-github-identity-provider.html">
                      Configuring a GitHub or GitHub Enterprise identity provider
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../authentication/identity_providers/configuring-gitlab-identity-provider.html">
                      Configuring a GitLab identity provider
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../authentication/identity_providers/configuring-google-identity-provider.html">
                      Configuring a Google identity provider
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../authentication/identity_providers/configuring-oidc-identity-provider.html">
                      Configuring an OpenID Connect identity provider
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-7-4">
                <span id="sgSpan-7-4" class="fa fa-caret-right"></span>
                  &nbsp;Configuring certificates

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-7-4" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../authentication/certificates/replacing-default-ingress-certificate.html">
                      Replacing the default ingress certificate
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../authentication/certificates/api-server.html">
                      Adding API server certificates
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../authentication/certificates/service-serving-certificate.html">
                      Securing service traffic using service serving certificates
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../authentication/using-rbac.html">Using RBAC to define and apply permissions</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../authentication/remove-kubeadmin.html">Removing the kubeadmin user</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../authentication/configuring-user-agent.html">Configuring the user agent</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../authentication/understanding-and-creating-service-accounts.html">Understanding and creating service accounts</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../authentication/using-service-accounts-in-applications.html">Using service accounts in applications</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../authentication/using-service-accounts-as-oauth-client.html">Using a service account as an OAuth client</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../authentication/tokens-scoping.html">Scoping tokens</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../authentication/managing-security-context-constraints.html">Managing Security Context Constraints</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../authentication/impersonating-system-admin.html">Impersonating the system:admin user</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../authentication/ldap-syncing.html">Syncing LDAP groups</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup8">
        <span id="tgSpan8" class="fa fa-angle-right"></span>
          Networking
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup8" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../networking/understanding-networking.html">Understanding networking</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../networking/accessing-hosts.html">Accessing hosts</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../networking/cluster-network-operator.html">Understanding the Cluster Network Operator (CNO)</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../networking/dns-operator.html">Understanding the DNS Operator</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../networking/ingress-operator.html">Understanding the Ingress Operator</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../networking/managing-multinetworking.html">Multiple networks</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../networking/configuring-networkpolicy.html">Configuring network policy</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-8-7">
                <span id="sgSpan-8-7" class="fa fa-caret-right"></span>
                  &nbsp;OpenShift SDN

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-8-7" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../networking/openshift-sdn/about-openshift-sdn.html">
                      About OpenShift SDN
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../networking/openshift-sdn/assigning-egress-ips.html">
                      Enabling egress IPs for a project
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../networking/openshift-sdn/using-multicast.html">
                      Using multicast
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../networking/openshift-sdn/multitenant-isolation.html">
                      Configuring multitenant isolation
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../networking/openshift-sdn/configuring-kube-proxy.html">
                      Configuring kube-proxy
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-8-8">
                <span id="sgSpan-8-8" class="fa fa-caret-right"></span>
                  &nbsp;Configuring Routes

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-8-8" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../networking/routes/route-configuration.html">
                      Route configuration
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../networking/routes/secured-routes.html">
                      Secured routes
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-8-9">
                <span id="sgSpan-8-9" class="fa fa-caret-right"></span>
                  &nbsp;Configuring ingress cluster traffic

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-8-9" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../networking/configuring-ingress-cluster-traffic/overview-traffic.html">
                      Overview
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../networking/configuring-ingress-cluster-traffic/configuring-ingress-cluster-traffic-ingress-controller.html">
                      Configuring ingress cluster traffic using an Ingress Controller
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../networking/configuring-ingress-cluster-traffic/configuring-ingress-cluster-traffic-load-balancer.html">
                      Configuring ingress cluster traffic using a load balancer
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../networking/configuring-ingress-cluster-traffic/configuring-ingress-cluster-traffic-service-external-ip.html">
                      Configuring ingress cluster traffic using a service external IP
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../networking/configuring-ingress-cluster-traffic/configuring-ingress-cluster-traffic-nodeport.html">
                      Configuring ingress cluster traffic using a NodePort
                    </a>
                  </li>

                

              </ul>
            </li>
      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup9">
        <span id="tgSpan9" class="fa fa-angle-right"></span>
          Storage
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup9" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../storage/understanding-persistent-storage.html">Understanding persistent storage</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-9-1">
                <span id="sgSpan-9-1" class="fa fa-caret-right"></span>
                  &nbsp;Configuring persistent storage

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-9-1" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../storage/persistent-storage/persistent-storage-aws.html">
                      Persistent storage using AWS Elastic Block Store
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../storage/persistent-storage/persistent-storage-fibre.html">
                      Persistent storage using Fibre Channel
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../storage/persistent-storage/persistent-storage-nfs.html">
                      Persistent storage using NFS
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../storage/persistent-storage/persistent-storage-hostpath.html">
                      Persistent storage using hostPath
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../storage/persistent-storage/persistent-storage-iscsi.html">
                      Persistent Storage using iSCSI
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../storage/persistent-storage/persistent-storage-csi.html">
                      Persistent storage using Container Storage Interface (CSI)
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../storage/persistent-storage/persistent-storage-vsphere.html">
                      Persistent storage using VMware vSphere
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../storage/persistent-storage/persistent-storage-snapshots.html">
                      Persistent storage using volume snapshots
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../storage/expanding-persistent-volumes.html">Expanding persistent volumes</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../storage/dynamic-provisioning.html">Dynamic provisioning</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup10">
        <span id="tgSpan10" class="fa fa-angle-right"></span>
          Registry
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup10" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../registry/architecture-component-imageregistry.html">Overview</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../registry/configuring-registry-operator.html">Image Registry Operator in Openshift Container Platform</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../registry/registry-options.html">Registry options</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../registry/accessing-the-registry.html">Accessing the registry</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../registry/securing-exposing-registry.html">Exposing the registry</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup11">
        <span id="tgSpan11" class="fa fa-angle-right"></span>
          Builds
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup11" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/understanding-image-builds.html">Understanding image builds</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/understanding-buildconfigs.html">Understanding build configurations</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/creating-build-inputs.html">Creating build inputs</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/managing-build-output.html">Managing build output</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/build-strategies.html">Using build strategies</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/custom-builds-buildah.html">Custom image builds with Buildah</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/basic-build-operations.html">Performing basic builds</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/triggering-builds-build-hooks.html">Triggering and modifying builds</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/advanced-build-operations.html">Performing advanced builds</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/running-entitled-builds.html">Using Red Hat subscriptions in builds</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/securing-builds-by-strategy.html">Securing builds by strategy</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/build-configuration.html">Build configuration resources</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/troubleshooting-builds.html">Troubleshooting builds</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../builds/setting-up-trusted-ca.html">Setting up additional trusted certificate authorities for builds</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup12">
        <span id="tgSpan12" class="fa fa-angle-right"></span>
          Images
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup12" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../openshift_images/configuring-samples-operator.html">Configuring the Samples Operator</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../openshift_images/images-understand.html">Understanding containers, images, and imagestreams</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../openshift_images/create-images.html">Creating images</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-12-3">
                <span id="sgSpan-12-3" class="fa fa-caret-right"></span>
                  &nbsp;Managing images

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-12-3" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../openshift_images/managing-images/managing-images-overview.html">
                      Managing images overview
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../openshift_images/managing-images/tagging-images.html">
                      Tagging images
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../openshift_images/managing-images/image-pull-policy.html">
                      Image pull policy
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../openshift_images/managing-images/using-image-pull-secrets.html">
                      Using image pull secrets
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../openshift_images/image-streams-manage.html">Managing imagestreams</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../openshift_images/image-configuration.html">Image configuration resources</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../openshift_images/using-templates.html">Using templates</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../openshift_images/templates-using-ruby-on-rails.html">Using Ruby on Rails</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-12-8">
                <span id="sgSpan-12-8" class="fa fa-caret-right"></span>
                  &nbsp;Using images

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-12-8" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../openshift_images/using_images/using-images-overview.html">
                      Using images overview
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../openshift_images/using_images/images-other-jenkins.html">
                      Configuring Jenkins images
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../openshift_images/using_images/images-other-jenkins-agent.html">
                      Jenkins agent
                    </a>
                  </li>

                

              </ul>
            </li>
      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup13">
        <span id="tgSpan13" class="fa fa-angle-right"></span>
          Applications
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup13" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-13-0">
                <span id="sgSpan-13-0" class="fa fa-caret-right"></span>
                  &nbsp;Projects

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-13-0" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/projects/working-with-projects.html">
                      Working with projects
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/projects/creating-project-other-user.html">
                      Creating a project as another user
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/projects/configuring-project-creation.html">
                      Configuring project creation
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-13-1">
                <span id="sgSpan-13-1" class="fa fa-caret-right"></span>
                  &nbsp;Operators

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-13-1" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operators/olm-what-operators-are.html">
                      Understanding Operators
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operators/olm-understanding-olm.html">
                      Understanding the Operator Lifecycle Manager (OLM)
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operators/olm-understanding-operatorhub.html">
                      Understanding the OperatorHub
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operators/olm-adding-operators-to-cluster.html">
                      Adding Operators to a cluster
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operators/olm-deleting-operators-from-cluster.html">
                      Deleting Operators from a cluster
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operators/olm-creating-apps-from-installed-operators.html">
                      Creating applications from installed Operators
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operators/olm-managing-resources-from-crds.html">
                      Managing resources from CRDs
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-13-2">
                <span id="sgSpan-13-2" class="fa fa-caret-right"></span>
                  &nbsp;Application life cycle management

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-13-2" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/application-life-cycle-management/creating-new-applications.html">
                      Creating applications
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-13-3">
                <span id="sgSpan-13-3" class="fa fa-caret-right"></span>
                  &nbsp;Service brokers

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-13-3" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/service_brokers/installing-service-catalog.html">
                      Installing the service catalog
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/service_brokers/installing-template-service-broker.html">
                      Installing the Template service Broker
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/service_brokers/provisioning-template-application.html">
                      Provisioning template applications
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/service_brokers/uninstalling-template-service-broker.html">
                      Uninstalling the Template Service Broker
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/service_brokers/installing-ansible-service-broker.html">
                      Installing the OpenShift Ansible Broker
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/service_brokers/configuring-ansible-service-broker.html">
                      Configuring the OpenShift Ansible Broker
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/service_brokers/provisioning-service-bundle.html">
                      Provisioning service bundles
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/service_brokers/uninstalling-ansible-service-broker.html">
                      Uninstalling the OpenShift Ansible Broker
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-13-4">
                <span id="sgSpan-13-4" class="fa fa-caret-right"></span>
                  &nbsp;Deployments

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-13-4" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/deployments/what-deployments-are.html">
                      Understanding Deployments and DeploymentConfigs
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/deployments/managing-deployment-processes.html">
                      Managing deployment processes
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/deployments/deployment-strategies.html">
                      Using DeploymentConfig strategies
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/deployments/route-based-deployment-strategies.html">
                      Using route-based deployment strategies
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-13-5">
                <span id="sgSpan-13-5" class="fa fa-caret-right"></span>
                  &nbsp;CRDs

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-13-5" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/crds/crd-extending-api-with-crds.html">
                      Extending the Kubernetes API with CRDs
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/crds/crd-managing-resources-from-crds.html">
                      Managing resources from CRDs
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-13-6">
                <span id="sgSpan-13-6" class="fa fa-caret-right"></span>
                  &nbsp;Quotas

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-13-6" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/quotas/quotas-setting-per-project.html">
                      Resource quotas per project
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/quotas/quotas-setting-across-multiple-projects.html">
                      Resource quotas across multiple projects
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../applications/application-health.html">Monitoring application health</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../applications/idling-applications.html">Idling applications</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../applications/pruning-objects.html">Pruning objects to reclaim resources</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-13-10">
                <span id="sgSpan-13-10" class="fa fa-caret-right"></span>
                  &nbsp;Operator SDK

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-13-10" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operator_sdk/osdk-getting-started.html">
                      Getting started with the Operator SDK
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operator_sdk/osdk-ansible.html">
                      Creating Ansible-based Operators
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operator_sdk/osdk-helm.html">
                      Creating Helm-based Operators
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operator_sdk/osdk-generating-csvs.html">
                      Generating a ClusterServiceVersion (CSV)
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operator_sdk/osdk-monitoring-prometheus.html">
                      Configuring built-in monitoring with Prometheus
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operator_sdk/osdk-leader-election.html">
                      Configuring leader election
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operator_sdk/osdk-cli-reference.html">
                      Operator SDK CLI reference
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../applications/operator_sdk/osdk-appendices.html">
                      Appendices
                    </a>
                  </li>

                

              </ul>
            </li>
      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup14">
        <span id="tgSpan14" class="fa fa-angle-right"></span>
          Machine management
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup14" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../machine_management/creating-machineset.html">Creating a MachineSet</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../machine_management/manually-scaling-machineset.html">Manually scaling a MachineSet</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../machine_management/modifying-machineset.html">Modifying a MachineSet</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../machine_management/deleting-machine.html">Deleting a Machine</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../machine_management/applying-autoscaling.html">Applying autoscaling to a cluster</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../machine_management/creating-infrastructure-machinesets.html">Creating infrastructure MachineSets</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../machine_management/adding-rhel-compute.html">Adding a RHEL compute machine</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../machine_management/more-rhel-compute.html">Adding more RHEL compute machines</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../machine_management/deploying-machine-health-checks.html">Deploying machine health checks</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup15">
        <span id="tgSpan15" class="fa fa-angle-right"></span>
          Nodes
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup15" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-15-0">
                <span id="sgSpan-15-0" class="fa fa-caret-right"></span>
                  &nbsp;Working with pods

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-15-0" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/pods/nodes-pods-using.html">
                      About Pods
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/pods/nodes-pods-viewing.html">
                      Viewing Pods
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/pods/nodes-pods-configuring.html">
                      Configuring a cluster for Pods
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/pods/nodes-pods-autoscaling.html">
                      Automatically scaling pods
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/pods/nodes-pods-secrets.html">
                      Providing sensitive data to Pods
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/pods/nodes-pods-plugins.html">
                      Using Device Manager to make devices available to nodes
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/pods/nodes-pods-priority.html">
                      Including pod priority in Pod scheduling decisions
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/pods/nodes-pods-node-selectors.html">
                      Placing pods on specific nodes using node selectors
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-15-1">
                <span id="sgSpan-15-1" class="fa fa-caret-right"></span>
                  &nbsp;Controlling pod placement onto nodes (scheduling)

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-15-1" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/scheduling/nodes-scheduler-about.html">
                      About pod placement using the scheduler
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/scheduling/nodes-scheduler-default.html">
                      Configuring the default scheduler to control pod placement
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/scheduling/nodes-scheduler-pod-affinity.html">
                      Placing pods relative to other pods using pod affinity and anti-affinity rules
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/scheduling/nodes-scheduler-node-affinity.html">
                      Controlling pod placement on nodes using node affinity rules
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/scheduling/nodes-scheduler-overcommit.html">
                      Placing pods onto overcommited nodes
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/scheduling/nodes-scheduler-taints-tolerations.html">
                      Controlling pod placement using node taints
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/scheduling/nodes-scheduler-node-selectors.html">
                      Placing pods on specific nodes using node selectors
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-15-2">
                <span id="sgSpan-15-2" class="fa fa-caret-right"></span>
                  &nbsp;Using Jobs and DaemonSets

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-15-2" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/jobs/nodes-pods-daemonsets.html">
                      Running background tasks on nodes automatically with daemonsets
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/jobs/nodes-nodes-jobs.html">
                      Running tasks in pods using jobs
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-15-3">
                <span id="sgSpan-15-3" class="fa fa-caret-right"></span>
                  &nbsp;Working with nodes

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-15-3" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/nodes/nodes-nodes-viewing.html">
                      Viewing and listing the nodes in your cluster
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/nodes/nodes-nodes-working.html">
                      Working with nodes
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/nodes/nodes-nodes-managing.html">
                      Managing Nodes
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/nodes/nodes-nodes-managing-max-pods.html">
                      Managing the maximum number of Pods per Node
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/nodes/nodes-node-tuning-operator.html">
                      Using the Node Tuning Operator
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/nodes/nodes-nodes-rebooting.html">
                      Understanding node rebooting
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/nodes/nodes-nodes-garbage-collection.html">
                      Freeing node resources using garbage collection
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/nodes/nodes-nodes-resources-configuring.html">
                      Allocating resources for nodes
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/nodes/nodes-nodes-opaque-resources.html">
                      Advertising hidden resources for nodes
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/nodes/nodes-nodes-audit-log.html">
                      Viewing node audit logs
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-15-4">
                <span id="sgSpan-15-4" class="fa fa-caret-right"></span>
                  &nbsp;Working with containers

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-15-4" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/containers/nodes-containers-using.html">
                      Using containers
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/containers/nodes-containers-init.html">
                      Using Init Containers to perform tasks before a pod is deployed
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/containers/nodes-containers-volumes.html">
                      Using volumes to persist container data
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/containers/nodes-containers-projected-volumes.html">
                      Mapping volumes using projected volumes
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/containers/nodes-containers-downward-api.html">
                      Allowing containers to consume API objects
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/containers/nodes-containers-copying-files.html">
                      Copying files to or from a container
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/containers/nodes-containers-remote-commands.html">
                      Executing remote commands in a container
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/containers/nodes-containers-port-forwarding.html">
                      Using port forwarding to access applications in a container
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-15-5">
                <span id="sgSpan-15-5" class="fa fa-caret-right"></span>
                  &nbsp;Working with clusters

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-15-5" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/clusters/nodes-containers-events.html">
                      Viewing system event information in a cluster
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/clusters/nodes-cluster-resource-levels.html">
                      Analyzing cluster resource levels
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/clusters/nodes-cluster-resource-configure.html">
                      Configuring cluster memory to meet container memory and risk requirements
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/clusters/nodes-cluster-overcommit.html">
                      Configuring your cluster to place pods on overcommited nodes
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../nodes/clusters/nodes-cluster-enabling-features.html">
                      Enabling features using FeatureGates
                    </a>
                  </li>

                

              </ul>
            </li>
      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup16">
        <span id="tgSpan16" class="fa fa-angle-right"></span>
          Logging
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup16" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../logging/efk-logging.html">About cluster logging</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../logging/efk-logging-deploying-about.html">About deploying cluster logging</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../logging/efk-logging-deploying.html">Deploying cluster logging</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../logging/efk-logging-eventrouter.html">Deploying and Configuring the Event Router</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-16-4">
                <span id="sgSpan-16-4" class="fa fa-caret-right"></span>
                  &nbsp;Configuring your cluster logging deployment

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-16-4" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../logging/config/efk-logging-configuring-about.html">
                      About configuring cluster logging
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../logging/config/efk-logging-management.html">
                      Changing cluster logging management state
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../logging/config/efk-logging-configuring.html">
                      Configuring cluster logging
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../logging/config/efk-logging-elasticsearch.html">
                      Configuring Elasticsearch
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../logging/config/efk-logging-kibana.html">
                      Configuring Kibana
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../logging/config/efk-logging-curator.html">
                      Configuring Curator
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../logging/config/efk-logging-fluentd.html">
                      Configuring Fluentd
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../logging/config/efk-logging-external.html">
                      Sending logs to external devices
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../logging/efk-logging-elasticsearch-status.html">Viewing Elasticsearch status</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../logging/efk-logging-moving-nodes.html">Moving the cluster logging resources with node selectors</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../logging/efk-logging-manual-rollout.html">Manually rolling out Elasticsearch</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../logging/efk-logging-troubleshooting.html">Troubleshooting Kibana</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../logging/efk-logging-exported-fields.html">Exported fields</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../logging/efk-logging-uninstall.html">Uninstalling cluster logging</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup17">
        <span id="tgSpan17" class="fa fa-angle-right"></span>
          Monitoring
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup17" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-17-0">
                <span id="sgSpan-17-0" class="fa fa-caret-right"></span>
                  &nbsp;Cluster monitoring

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-17-0" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../monitoring/cluster-monitoring/about-cluster-monitoring.html">
                      About cluster monitoring
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../monitoring/cluster-monitoring/configuring-the-monitoring-stack.html">
                      Configuring the monitoring stack
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../monitoring/cluster-monitoring/managing-cluster-alerts.html">
                      Managing cluster alerts
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../monitoring/cluster-monitoring/prometheus-alertmanager-and-grafana.html">
                      Accessing Prometheus, Alertmanager, and Grafana
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../monitoring/exposing-custom-application-metrics-for-autoscaling.html">Exposing custom application metrics for autoscaling</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup18">
        <span id="tgSpan18" class="fa fa-angle-right"></span>
          Telemetry
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup18" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../telemetry/about-telemetry.html">About Telemetry</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../telemetry/showing-data-collected-by-telemetry.html">Showing data collected by Telemetry</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../telemetry/opting-out-of-telemetry.html">Opting out of Telemetry</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup19">
        <span id="tgSpan19" class="fa fa-angle-right"></span>
          Scalability and performance
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup19" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../scalability_and_performance/recommended-host-practices.html">Recommended host practices</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../scalability_and_performance/using-node-tuning-operator.html">Using the Node Tuning Operator</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../scalability_and_performance/using-cluster-loader.html">Using Cluster Loader</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../scalability_and_performance/using-cpu-manager.html">Using CPU Manager</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../scalability_and_performance/scaling-cluster-monitoring-operator.html">Scaling the Cluster Monitoring Operator</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../scalability_and_performance/planning-your-environment-according-to-object-maximums.html">Planning your environment according to object maximums</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../scalability_and_performance/optimizing-storage.html">Optimizing storage</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../scalability_and_performance/routing-optimization.html">Optimizing routing</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../scalability_and_performance/what-huge-pages-do-and-how-they-are-consumed-by-apps.html">What huge pages do and how they are consumed by apps</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup20">
        <span id="tgSpan20" class="fa fa-angle-right"></span>
          Backup and restore
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup20" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../backup_and_restore/backing-up-etcd.html">Backing up etcd data</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-20-1">
                <span id="sgSpan-20-1" class="fa fa-caret-right"></span>
                  &nbsp;Disaster recovery

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-20-1" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../backup_and_restore/disaster_recovery/about-disaster-recovery.html">
                      About disaster recovery
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../backup_and_restore/disaster_recovery/scenario-1-infra-recovery.html">
                      Recovering from lost master hosts
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../backup_and_restore/disaster_recovery/scenario-2-restoring-cluster-state.html">
                      Restoring to a previous cluster state
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../backup_and_restore/disaster_recovery/scenario-3-expired-certs.html">
                      Recovering from expired control plane certificates
                    </a>
                  </li>

                

              </ul>
            </li>
      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup21">
        <span id="tgSpan21" class="fa fa-angle-right"></span>
          CLI reference
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup21" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../cli_reference/getting-started-cli.html">Getting started with the CLI</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../cli_reference/configuring-cli.html">Configuring the CLI</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../cli_reference/extending-cli-plugins.html">Extending the CLI with plug-ins</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../cli_reference/developer-cli-commands.html">Developer CLI commands</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../cli_reference/administrator-cli-commands.html">Administrator CLI commands</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../cli_reference/usage-oc-kubectl.html">Usage of oc and kubectl commands</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup22">
        <span id="tgSpan22" class="fa fa-angle-right"></span>
          Service Mesh
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup22" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-22-0">
                <span id="sgSpan-22-0" class="fa fa-caret-right"></span>
                  &nbsp;Service Mesh Architecture

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-22-0" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/service_mesh_arch/understanding-ossm.html">
                      Understanding service mesh
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/service_mesh_arch/ossm-kiali.html">
                      Understanding Kiali
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/service_mesh_arch/ossm-jaeger.html">
                      Understanding Jaeger
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/service_mesh_arch/ossm-vs-community.html">
                      Comparing service mesh and Istio
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-22-1">
                <span id="sgSpan-22-1" class="fa fa-caret-right"></span>
                  &nbsp;Service Mesh Installation

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-22-1" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/service_mesh_install/preparing-ossm-installation.html">
                      Preparing to install service mesh
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/service_mesh_install/installing-ossm.html">
                      Installing service mesh
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/service_mesh_install/customizing-installation-ossm.html">
                      Customizing the installation
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/service_mesh_install/removing-ossm.html">
                      Removing service mesh
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-22-2">
                <span id="sgSpan-22-2" class="fa fa-caret-right"></span>
                  &nbsp;Day Two

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-22-2" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/service_mesh_day_two/prepare-to-deploy-applications-ossm.html">
                      Deploying applications on service mesh
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/service_mesh_day_two/configuring-jaeger.html">
                      Configuring Jaeger
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/service_mesh_day_two/ossm-example-bookinfo.html">
                      Example application
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/service_mesh_day_two/ossm-tutorial-kiali.html">
                      Kiali tutorial
                    </a>
                  </li>

                


                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/service_mesh_day_two/ossm-tutorial-jaeger-tracing.html">
                      Distributed tracing tutorial
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


            <!-- this topic contains subtopics - Welcome 2 -->


            <!-- start a new heading area -->

            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-22-3">
                <span id="sgSpan-22-3" class="fa fa-caret-right"></span>
                  &nbsp;3scale adapter

                  <!-- prints out the names of the second level books with arrow down or to right
                  So in this case: Welcome 2 -->

              </a>
              <ul id="topicSubGroup-22-3" class="nav-tertiary list-unstyled collapse">

                <!-- for each topic in this topic_group, in Welcome 2, what topics exist?
                     Welcome 2 Index Page, Welcome 3 and Welcome 2 More - we list them all.. -->

                
                
                
                
                

                <!-- is this is a single page? That is, does this topic have more topics?
                 Welcome 2 Index Page and Welcome 2 More -->




                  <li>
                    <a class="" href="../../service_mesh/threescale_adapter/threescale-adapter.html">
                      Using the 3scale Istio adapter
                    </a>
                  </li>

                

              </ul>
            </li>

        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../service_mesh/servicemesh-release-notes.html">Service Mesh Release Notes</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>

<!--  the top level  groupings start here -->





<!-- group_id is the one that is user selected. topic_group[id] is what we are parsing via navigation -->

    <li class="nav-header">






      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup23">
        <span id="tgSpan23" class="fa fa-angle-right"></span>
          Serverless applications
          <!-- prints out the names of the top level books with arrow down or to right
               So in this case: Welcome 1 and Another Book -->
      </a>


      <!-- this then goes through all the topics within the top level groups
      depending on whether it itself contains further topics or is a single file -->

      <ul id="topicGroup23" class="collapse  list-unstyled">


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../serverless/serverless-getting-started.html">Getting started with OpenShift Serverless</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../serverless/serverless-architecture.html">OpenShift Serverless product architecture</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../serverless/installing-openshift-serverless.html">Installing OpenShift Serverless</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../serverless/getting-started-knative-services.html">Getting started with Knative services</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../serverless/monitoring-serverless.html">Monitoring OpenShift Serverless components</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../serverless/cluster-logging-serverless.html">Cluster logging with OpenShift Serverless</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../serverless/configuring-knative-serving-autoscaling.html">Configuring Knative Serving autoscaling</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../serverless/knative-client.html">Using Knative Client</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->


        <!-- for each topic in this topic_group, for example in Welcome 1, what topics exist?
        Welcome 2 and Welcome 1 More -->


          <!-- is this is a single page? That is, does this topic have more topics?
          Welcome 1 More -->

            <!-- ^ this establishs whether we are reading this current page -->

            <li><a class="" href="../../serverless/serverless-release-notes.html">Release Notes</a></li>
            <!--  if active, then highlight it,  otherwise nothing to do -->

      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h1>Installing a cluster on AWS using CloudFormation templates</h1>
        </div>
        
        
          <font size="+1" color="red">You are viewing documentation for a release that is no longer supported. The latest supported version of version 3 is <a href="https://docs.openshift.com/container-platform/3.11/welcome/index.html">[3.11]</a>. For the most recent version 4, see <a href="https://docs.openshift.com/container-platform/latest/welcome/index.html">[4]</a></font>
          <div id="annoying-box"
            style="position: fixed; top: 100px; left: 10px; width: 100px; height: 100px; color: red">
              You are viewing documentation for a release that is no longer supported. The latest supported version of version 3 is <a href="https://docs.openshift.com/container-platform/3.11/welcome/index.html">[3.11]</a>. For the most recent version 4, see <a href="https://docs.openshift.com/container-platform/latest/welcome/index.html">[4]</a>
          </div>
        
        
        

        <div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title"></div>
<ul class="sectlevel1">
<li><a href="#cluster-entitlements_installing-aws-user-infra">Internet and Telemetry access for OpenShift Container Platform</a></li>
<li><a href="#installation-aws-user-infra-requirements_installing-aws-user-infra">Required AWS infrastructure components</a>
<ul class="sectlevel2">
<li><a href="#installation-aws-user-infra-cluster-machines_installing-aws-user-infra">Cluster machines</a></li>
<li><a href="#csr-management-aws_installing-aws-user-infra">Certificate signing requests management</a></li>
<li><a href="#installation-aws-user-infra-other-infrastructure_installing-aws-user-infra">Other infrastructure components</a></li>
<li><a href="#installation-aws-permissions_installing-aws-user-infra">Required AWS permissions</a></li>
</ul>
</li>
<li><a href="#installation-obtaining-installer_installing-aws-user-infra">Obtaining the installation program</a></li>
<li><a href="#ssh-agent-using_installing-aws-user-infra">Generating an SSH private key and adding it to the agent</a></li>
<li><a href="#installation-generate-aws-user-infra_installing-aws-user-infra">Creating the installation files for AWS</a></li>
<li><a href="#installation-extracting-infraid_installing-aws-user-infra">Extracting the infrastructure name</a></li>
<li><a href="#installation-creating-aws-vpc_installing-aws-user-infra">Creating a VPC in AWS</a>
<ul class="sectlevel2">
<li><a href="#installation-cloudformation-vpc_installing-aws-user-infra">CloudFormation template for the VPC</a></li>
</ul>
</li>
<li><a href="#installation-creating-aws-dns_installing-aws-user-infra">Creating networking and load balancing components in AWS</a>
<ul class="sectlevel2">
<li><a href="#installation-cloudformation-dns_installing-aws-user-infra">CloudFormation template for the network and load balancers</a></li>
</ul>
</li>
<li><a href="#installation-creating-aws-security_installing-aws-user-infra">Creating security group and roles in AWS</a>
<ul class="sectlevel2">
<li><a href="#installation-cloudformation-security_installing-aws-user-infra">CloudFormation template for security objects</a></li>
</ul>
</li>
<li><a href="#installation-aws-user-infra-rhcos-ami_installing-aws-user-infra">RHCOS AMIs for the AWS infrastructure</a></li>
<li><a href="#installation-creating-aws-bootstrap_installing-aws-user-infra">Creating the bootstrap node in AWS</a>
<ul class="sectlevel2">
<li><a href="#installation-cloudformation-bootstrap_installing-aws-user-infra">CloudFormation template for the bootstrap machine</a></li>
</ul>
</li>
<li><a href="#installation-creating-aws-control-plane_installing-aws-user-infra">Creating the control plane machines in AWS</a>
<ul class="sectlevel2">
<li><a href="#installation-cloudformation-control-plane_installing-aws-user-infra">CloudFormation template for control plane machines</a></li>
</ul>
</li>
<li><a href="#installation-aws-user-infra-bootstrap_installing-aws-user-infra">Initializing the bootstrap node on AWS with user-provisioned infrastructure</a>
<ul class="sectlevel2">
<li><a href="#installation-creating-aws-worker_installing-aws-user-infra">Creating the worker nodes in AWS</a></li>
</ul>
</li>
<li><a href="#cli-install_installing-aws-user-infra">Installing the OpenShift Command-line Interface</a></li>
<li><a href="#cli-logging-in-kubeadmin_installing-aws-user-infra">Logging in to  the cluster</a></li>
<li><a href="#installation-approve-csrs_installing-aws-user-infra">Approving the CSRs for your machines</a></li>
<li><a href="#installation-operators-config_installing-aws-user-infra">Initial Operator configuration</a>
<ul class="sectlevel2">
<li><a href="#installation-registry-storage-config_installing-aws-user-infra">Image registry storage configuration</a></li>
</ul>
</li>
<li><a href="#installation-aws-user-infra-installation_installing-aws-user-infra">Completing an AWS installation on user-provisioned infrastructure</a></li>
</ul>
</div>
<div class="paragraph">
<p>In OpenShift Container Platform version 4.1, you can install a
cluster on Amazon Web Services (AWS) using infrastructure that you provide.</p>
</div>
<div class="paragraph">
<p>One way to create this infrastructure is to use the provided
CloudFormation templates. You can modify the templates to customize your
infrastructure or use the information that they contain to create AWS objects
according to your company&#8217;s policies.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Review details about the
<a href="../../architecture/architecture-installation.html#architecture-installation">OpenShift Container Platform installation and update</a>
processes.</p>
</li>
<li>
<p><a href="../../installing/installing_aws/installing-aws-account.html#installing-aws-account">Configure an AWS account</a>
to host the cluster.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you have an AWS profile stored on your computer, it must not use a temporary
session token that you generated while using a multi-factor authentication
device. The cluster continues to use your current AWS credentials to
create AWS resources for the entire life of the cluster, so you must
use key-based, long-lived credentials. To generate appropriate keys, see
<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html">Managing Access Keys for IAM Users</a>
in the AWS documentation. You can supply the keys when you run the installation
program.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Download the AWS CLI and install it on your computer. See
<a href="https://docs.aws.amazon.com/cli/latest/userguide/install-bundle.html">Install the AWS CLI Using the Bundled Installer (Linux, macOS, or Unix)</a>
in the AWS documentation.</p>
</li>
<li>
<p>If you use a firewall, you must
<a href="../../installing/install_config/configuring-firewall.html#configuring-firewall">configure it to access Red Hat Insights</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cluster-entitlements_installing-aws-user-infra"><a class="anchor" href="#cluster-entitlements_installing-aws-user-infra"></a>Internet and Telemetry access for OpenShift Container Platform</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In OpenShift Container Platform 4.1, Telemetry is the component that provides
metrics about cluster health and the success of updates. To perform subscription
management, including legally entitling your purchase from Red Hat, you must use
the Telemetry service and access the
<a href="https://cloud.redhat.com/openshift">Red Hat OpenShift Cluster Manager</a> page.</p>
</div>
<div class="paragraph">
<p>Because there is no disconnected subscription management, you cannot both opt
out of sending data back to Red Hat and entitle your purchase. Support for
disconnected subscription management might be added in future releases of
OpenShift Container Platform</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Your machines must have direct internet access to install the cluster.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You must have internet access to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access the
<a href="https://cloud.redhat.com/openshift/install">Infrastructure Provider</a> page on the Red Hat OpenShift Cluster Manager site to download the installation program</p>
</li>
<li>
<p>Access <a href="http://quay.io">Quay.io</a> to obtain the packages that are required
to install your cluster</p>
</li>
<li>
<p>Obtain the packages that are required to perform cluster updates</p>
</li>
<li>
<p>Access <a href="http://cloud.redhat.com">Red Hat&#8217;s software as a service page</a>
to perform subscription management</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-aws-user-infra-requirements_installing-aws-user-infra"><a class="anchor" href="#installation-aws-user-infra-requirements_installing-aws-user-infra"></a>Required AWS infrastructure components</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To install OpenShift Container Platform on user-provisioned infrastructure in
Amazon Web Services (AWS), you must manually create both the machines and their
supporting infrastructure.</p>
</div>
<div class="paragraph">
<p>For more information about the integration testing for different platforms,
see the <a href="https://access.redhat.com/articles/4128421">OpenShift Container Platform 4.x Tested Integrations</a>
page.</p>
</div>
<div class="paragraph">
<p>You can use the provided CloudFormation templates to create this infrastructure,
you can manually create the components, or you can reuse existing infrastructure
that meets the cluster requirements. Review the CloudFormation templates
for more details about how the components interrelate.</p>
</div>
<div class="sect2">
<h3 id="installation-aws-user-infra-cluster-machines_installing-aws-user-infra"><a class="anchor" href="#installation-aws-user-infra-cluster-machines_installing-aws-user-infra"></a>Cluster machines</h3>
<div class="paragraph">
<p>You need <code>AWS::EC2::Instance</code> objects for the following machines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A bootstrap machine. This machine is required during installation, but you
can remove it after your cluster deploys.</p>
</li>
<li>
<p>At least three control plane machines. The control plane machines are not
governed by a MachineSet.</p>
</li>
<li>
<p>Compute machines. You must create at least two compute, or worker, machines
during installation. These machines are not governed by a MachineSet.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can use the following instance types for the cluster machines:</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Valid instance types for machines</div>
<div class="paragraph">
<p>If <code>m4</code> instance types are not available in your region, such as with
<code>eu-west-3</code>, use <code>m5</code> types instead.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Instance type</th>
<th class="tableblock halign-left valign-top">Bootstrap</th>
<th class="tableblock halign-left valign-top">Control plane</th>
<th class="tableblock halign-left valign-top">Compute</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>i3.large</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>m4.large</code> or <code>m5.large</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>m4.xlarge</code> or <code>m5.xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>m4.2xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>m4.4xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>m4.8xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>m4.10xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>m4.16xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>c4.large</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>c4.xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>c4.2xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>c4.4xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>c4.8xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>r4.large</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>r4.xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>r4.2xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>r4.4xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>r4.8xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>r4.16xlarge</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You might be able to use other instance types that meet the specifications of these instance types.</p>
</div>
</div>
<div class="sect2">
<h3 id="csr-management-aws_installing-aws-user-infra"><a class="anchor" href="#csr-management-aws_installing-aws-user-infra"></a>Certificate signing requests management</h3>
<div class="paragraph">
<p>Because your cluster has limited access to automatic machine management when you
use infrastructure that you provision, you must provide a mechanism for approving
cluster certificate signing requests (CSRs) after installation. The
<code>kube-controller-manager</code> only approves the kubelet client CSRs. The
<code>machine-approver</code> cannot guarantee the validity of a serving certificate
that is requested by using kubelet credentials because it cannot confirm that
the correct machine issued the request. You must determine and implement a
method of verifying the validity of the kubelet serving certificate requests
and approving them.</p>
</div>
</div>
<div class="sect2">
<h3 id="installation-aws-user-infra-other-infrastructure_installing-aws-user-infra"><a class="anchor" href="#installation-aws-user-infra-other-infrastructure_installing-aws-user-infra"></a>Other infrastructure components</h3>
<div class="ulist">
<ul>
<li>
<p>A VPC</p>
</li>
<li>
<p>DNS entries</p>
</li>
<li>
<p>Load balancers (classic or network) and listeners</p>
</li>
<li>
<p>A Route53 zone</p>
</li>
<li>
<p>Security groups</p>
</li>
<li>
<p>IAM roles</p>
</li>
<li>
<p>S3 buckets</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Required VPC components</div>
<p>You must provide a suitable VPC and subnets that allow communication to your
machines.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 13.3333%;">
<col style="width: 46.6666%;">
<col style="width: 20%;">
<col style="width: 20.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Component</th>
<th class="tableblock halign-left valign-top">AWS type</th>
<th class="tableblock halign-left valign-top" colspan="2">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>VPC</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>AWS::EC2::VPC</code></p>
</li>
<li>
<p><code>AWS::EC2::VPCEndpoint</code></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>You must provide a public VPC for the cluster to use. The VPC requires an
endpoint that references the route tables for each subnet.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Public subnets</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>AWS::EC2::Subnet</code></p>
</li>
<li>
<p><code>AWS::EC2::SubnetNetworkAclAssociation</code></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Your VPC must have public subnets for between 1 and 3 availability zones
and associate them with appropriate Ingress rules.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Internet gateway</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>AWS::EC2::InternetGateway</code></p>
</li>
<li>
<p><code>AWS::EC2::VPCGatewayAttachment</code></p>
</li>
<li>
<p><code>AWS::EC2::RouteTable</code></p>
</li>
<li>
<p><code>AWS::EC2::Route</code></p>
</li>
<li>
<p><code>PublicSubnetRouteTableAssociation</code></p>
</li>
<li>
<p><code>AWS::EC2::NatGateway</code></p>
</li>
<li>
<p><code>AWS::EC2::EIP</code></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>You must have a public internet gateway, with public routes, attached to the
VPC. Each public subnet must also be attached to the route and have a NAT
gateway and EIP address.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="7"><div class="content"><div class="paragraph">
<p>Network access control</p>
</div></div></td>
<td class="tableblock halign-left valign-top" rowspan="7"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>AWS::EC2::NetworkAcl</code></p>
</li>
<li>
<p><code>AWS::EC2::NetworkAclEntry</code></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>You must allow the VPC to access the following ports:</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Port</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Reason</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>80</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Inbound HTTP traffic</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>443</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Inbound HTTPS traffic</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>22</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Inbound SSH traffic</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>1024</code> - <code>65535</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Inbound ephemeral traffic</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>0</code> - <code>65535</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Outbound ephemeral traffic</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Private subnets</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>AWS::EC2::Subnet</code></p>
</li>
<li>
<p><code>AWS::EC2::RouteTable</code></p>
</li>
<li>
<p><code>AWS::EC2::SubnetRouteTableAssociation</code></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Your VPC can have a private subnets. The provided CloudFormation templates
can create private subnets for between 1 and 3 availability zones.
If you use private subnets, you must provide appropriate routes and tables
for them.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Required DNS and load balancing components</div>
<p>Your DNS and load balancer configuration needs to use a public hosted zone and
can use a private hosted zone similar to the one that the installation program
uses if it provisions the cluster&#8217;s infrastructure. You must
create a DNS entry that resolves to your load balancer. An entry for
<code>api.&lt;cluster_name&gt;.&lt;domain&gt;</code> must point to the external load balancer, and an
entry for <code>api-int.&lt;cluster_name&gt;.&lt;domain&gt;</code> must point to the internal load
balancer.</p>
</div>
<div class="paragraph">
<p>The cluster also requires load balancers and listeners for port 6443, which are
required for the Kubernetes API and its extensions, and port 22623, which are
required for the Ignition config files for new machines. The targets will be the
master nodes. Port 6443 must be accessible to both clients external to the
cluster and nodes within the cluster. Port 22623 must be accessible to nodes
within the cluster.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Component</th>
<th class="tableblock halign-left valign-top">AWS type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>DNS</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>AWS::Route53::HostedZone</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The hosted zone for your internal DNS.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>etcd record sets</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>AWS::Route53::RecordSet</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The registration records for etcd for your control plane machines.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Public load balancer</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>AWS::ElasticLoadBalancingV2::LoadBalancer</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The load balancer for your public subnets.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>External API server record</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>AWS::Route53::RecordSetGroup</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Alias records for the external API server.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>External listener</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>AWS::ElasticLoadBalancingV2::Listener</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A listener on port 6443 for the external load balancer.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>External target group</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>AWS::ElasticLoadBalancingV2::TargetGroup</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The target group for the external load balancer.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Private load balancer</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>AWS::ElasticLoadBalancingV2::LoadBalancer</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The load balancer for your private subnets.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Internal API server record</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>AWS::Route53::RecordSetGroup</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Alias records for the internal API server.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Internal listener</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>AWS::ElasticLoadBalancingV2::Listener</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A listener on port 22623 for the internal load balancer.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Internal target group</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>AWS::ElasticLoadBalancingV2::TargetGroup</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The target group for the Internal load balancer.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Internal listener</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>AWS::ElasticLoadBalancingV2::Listener</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A listener on port 6443 for the internal load balancer.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Internal target group</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>AWS::ElasticLoadBalancingV2::TargetGroup</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The target group for the Internal load balancer.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Security groups</div>
<p>The control plane and worker machines require access to the following ports:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Group</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">IP Protocol</th>
<th class="tableblock halign-left valign-top">Port range</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="4"><div class="content"><div class="paragraph">
<p>MasterSecurityGroup</p>
</div></div></td>
<td class="tableblock halign-left valign-top" rowspan="4"><div class="content"><div class="paragraph">
<p><code>AWS::EC2::SecurityGroup</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>icmp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>0</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>22</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>6443</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>22623</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p>WorkerSecurityGroup</p>
</div></div></td>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p><code>AWS::EC2::SecurityGroup</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>icmp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>0</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>22</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p>BootstrapSecurityGroup</p>
</div></div></td>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p><code>AWS::EC2::SecurityGroup</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>22</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>19531</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Control plane Ingress</div>
<p>The control plane machines require the following Ingress groups. Each Ingress group is
a <code>AWS::EC2::SecurityGroupIngress</code> resource.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 18.1818%;">
<col style="width: 45.4545%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Ingress group</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">IP protocol</th>
<th class="tableblock halign-left valign-top">Port range</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>MasterIngressEtcd</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>etcd</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>2379</code>- <code>2380</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>MasterIngressVxlan</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Vxlan packets</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>udp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>4789</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>MasterIngressWorkerVxlan</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Vxlan packets</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>udp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>4789</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>MasterIngressInternal</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Internal cluster communication and Kubernetes proxy metrics</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>9000</code> - <code>9999</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>MasterIngressWorkerInternal</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Internal cluster communication</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>9000</code> - <code>9999</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>MasterIngressKube</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Kubernetes kubelet, scheduler and controller manager</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>10250</code> - <code>10259</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>MasterIngressWorkerKube</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Kubernetes kubelet, scheduler and controller manager</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>10250</code> - <code>10259</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>MasterIngressIngressServices</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Kubernetes Ingress services</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>30000</code> - <code>32767</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>MasterIngressWorkerIngressServices</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Kubernetes Ingress services</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>30000</code> - <code>32767</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Worker Ingress</div>
<p>The worker machines require the following Ingress groups. Each Ingress group is
a <code>AWS::EC2::SecurityGroupIngress</code> resource.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 18.1818%;">
<col style="width: 45.4545%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Ingress group</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">IP protocol</th>
<th class="tableblock halign-left valign-top">Port range</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>WorkerIngressVxlan</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Vxlan packets</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>udp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>4789</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>WorkerIngressWorkerVxlan</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Vxlan packets</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>udp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>4789</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>WorkerIngressInternal</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Internal cluster communication</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>9000</code> - <code>9999</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>WorkerIngressWorkerInternal</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Internal cluster communication</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>9000</code> - <code>9999</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>WorkerIngressKube</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Kubernetes kubelet, scheduler and controller manager</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>10250</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>WorkerIngressWorkerKube</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Kubernetes kubelet, scheduler and controller manager</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>10250</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>WorkerIngressIngressServices</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Kubernetes Ingress services</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>30000</code> - <code>32767</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>WorkerIngressWorkerIngressServices</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Kubernetes Ingress services</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>tcp</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>30000</code> - <code>32767</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Roles and instance profiles</div>
<p>You must grant the machines permissions in AWS. The provided CloudFormation
templates grant the machines permission the following <code>AWS::IAM::Role</code> objects
and provide a <code>AWS::IAM::InstanceProfile</code> for each set of roles. If you do
not use the templates, you can grant the machines the following broad permissions
or the following individual permissions.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Effect</th>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">Resource</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="4"><div class="content"><div class="paragraph">
<p>Master</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Allow</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ec2:*</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>*</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Allow</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>elasticloadbalancing:*</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>*</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Allow</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>iam:PassRole</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>*</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Allow</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>s3:GetObject</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>*</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Worker</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Allow</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ec2:Describe*</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>*</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><div class="content"><div class="paragraph">
<p>Bootstrap</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Allow</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ec2:Describe*</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>*</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Allow</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ec2:AttachVolume</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>*</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Allow</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ec2:DetachVolume</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>*</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="installation-aws-permissions_installing-aws-user-infra"><a class="anchor" href="#installation-aws-permissions_installing-aws-user-infra"></a>Required AWS permissions</h3>
<div class="paragraph">
<p>When you attach the <code>AdministratorAccess</code> policy to the IAM user that you create,
you grant that user all of the required permissions. To deploy an OpenShift Container Platform
cluster, the IAM user requires the following permissions:</p>
</div>
<div class="ulist">
<div class="title">Required EC2 permissions for installation</div>
<ul>
<li>
<p><code>ec2:AllocateAddress</code></p>
</li>
<li>
<p><code>ec2:AssociateAddress</code></p>
</li>
<li>
<p><code>ec2:AssociateDhcpOptions</code></p>
</li>
<li>
<p><code>ec2:AssociateRouteTable</code></p>
</li>
<li>
<p><code>ec2:AttachInternetGateway</code></p>
</li>
<li>
<p><code>ec2:AuthorizeSecurityGroupEgress</code></p>
</li>
<li>
<p><code>ec2:AuthorizeSecurityGroupIngress</code></p>
</li>
<li>
<p><code>ec2:CopyImage</code></p>
</li>
<li>
<p><code>ec2:CreateDhcpOptions</code></p>
</li>
<li>
<p><code>ec2:CreateInternetGateway</code></p>
</li>
<li>
<p><code>ec2:CreateNatGateway</code></p>
</li>
<li>
<p><code>ec2:CreateRoute</code></p>
</li>
<li>
<p><code>ec2:CreateRouteTable</code></p>
</li>
<li>
<p><code>ec2:CreateSecurityGroup</code></p>
</li>
<li>
<p><code>ec2:CreateSubnet</code></p>
</li>
<li>
<p><code>ec2:CreateTags</code></p>
</li>
<li>
<p><code>ec2:CreateVpc</code></p>
</li>
<li>
<p><code>ec2:CreateVpcEndpoint</code></p>
</li>
<li>
<p><code>ec2:CreateVolume</code></p>
</li>
<li>
<p><code>ec2:DescribeAccountAttributes</code></p>
</li>
<li>
<p><code>ec2:DescribeAddresses</code></p>
</li>
<li>
<p><code>ec2:DescribeAvailabilityZones</code></p>
</li>
<li>
<p><code>ec2:DescribeDhcpOptions</code></p>
</li>
<li>
<p><code>ec2:DescribeImages</code></p>
</li>
<li>
<p><code>ec2:DescribeInstanceAttribute</code></p>
</li>
<li>
<p><code>ec2:DescribeInstanceCreditSpecifications</code></p>
</li>
<li>
<p><code>ec2:DescribeInstances</code></p>
</li>
<li>
<p><code>ec2:DescribeInternetGateways</code></p>
</li>
<li>
<p><code>ec2:DescribeKeyPairs</code></p>
</li>
<li>
<p><code>ec2:DescribeNatGateways</code></p>
</li>
<li>
<p><code>ec2:DescribeNetworkAcls</code></p>
</li>
<li>
<p><code>ec2:DescribePrefixLists</code></p>
</li>
<li>
<p><code>ec2:DescribeRegions</code></p>
</li>
<li>
<p><code>ec2:DescribeRouteTables</code></p>
</li>
<li>
<p><code>ec2:DescribeSecurityGroups</code></p>
</li>
<li>
<p><code>ec2:DescribeSubnets</code></p>
</li>
<li>
<p><code>ec2:DescribeTags</code></p>
</li>
<li>
<p><code>ec2:DescribeVpcEndpoints</code></p>
</li>
<li>
<p><code>ec2:DescribeVpcs</code></p>
</li>
<li>
<p><code>ec2:DescribeVpcAttribute</code></p>
</li>
<li>
<p><code>ec2:DescribeVolumes</code></p>
</li>
<li>
<p><code>ec2:DescribeVpcClassicLink</code></p>
</li>
<li>
<p><code>ec2:DescribeVpcClassicLinkDnsSupport</code></p>
</li>
<li>
<p><code>ec2:ModifyInstanceAttribute</code></p>
</li>
<li>
<p><code>ec2:ModifySubnetAttribute</code></p>
</li>
<li>
<p><code>ec2:ModifyVpcAttribute</code></p>
</li>
<li>
<p><code>ec2:RevokeSecurityGroupEgress</code></p>
</li>
<li>
<p><code>ec2:RunInstances</code></p>
</li>
<li>
<p><code>ec2:TerminateInstances</code></p>
</li>
<li>
<p><code>ec2:RevokeSecurityGroupIngress</code></p>
</li>
<li>
<p><code>ec2:ReplaceRouteTableAssociation</code></p>
</li>
<li>
<p><code>ec2:DescribeNetworkInterfaces</code></p>
</li>
<li>
<p><code>ec2:ModifyNetworkInterfaceAttribute</code></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Required Elasticloadbalancing permissions for installation</div>
<ul>
<li>
<p><code>elasticloadbalancing:AddTags</code></p>
</li>
<li>
<p><code>elasticloadbalancing:ApplySecurityGroupsToLoadBalancer</code></p>
</li>
<li>
<p><code>elasticloadbalancing:AttachLoadBalancerToSubnets</code></p>
</li>
<li>
<p><code>elasticloadbalancing:CreateListener</code></p>
</li>
<li>
<p><code>elasticloadbalancing:CreateLoadBalancer</code></p>
</li>
<li>
<p><code>elasticloadbalancing:CreateLoadBalancerListeners</code></p>
</li>
<li>
<p><code>elasticloadbalancing:CreateTargetGroup</code></p>
</li>
<li>
<p><code>elasticloadbalancing:ConfigureHealthCheck</code></p>
</li>
<li>
<p><code>elasticloadbalancing:DeregisterInstancesFromLoadBalancer</code></p>
</li>
<li>
<p><code>elasticloadbalancing:DeregisterTargets</code></p>
</li>
<li>
<p><code>elasticloadbalancing:DescribeInstanceHealth</code></p>
</li>
<li>
<p><code>elasticloadbalancing:DescribeListeners</code></p>
</li>
<li>
<p><code>elasticloadbalancing:DescribeLoadBalancers</code></p>
</li>
<li>
<p><code>elasticloadbalancing:DescribeLoadBalancerAttributes</code></p>
</li>
<li>
<p><code>elasticloadbalancing:DescribeTags</code></p>
</li>
<li>
<p><code>elasticloadbalancing:DescribeTargetGroupAttributes</code></p>
</li>
<li>
<p><code>elasticloadbalancing:DescribeTargetHealth</code></p>
</li>
<li>
<p><code>elasticloadbalancing:ModifyLoadBalancerAttributes</code></p>
</li>
<li>
<p><code>elasticloadbalancing:ModifyTargetGroup</code></p>
</li>
<li>
<p><code>elasticloadbalancing:ModifyTargetGroupAttributes</code></p>
</li>
<li>
<p><code>elasticloadbalancing:RegisterTargets</code></p>
</li>
<li>
<p><code>elasticloadbalancing:RegisterInstancesWithLoadBalancer</code></p>
</li>
<li>
<p><code>elasticloadbalancing:SetLoadBalancerPoliciesOfListener</code></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Required IAM permissions for installation</div>
<ul>
<li>
<p><code>iam:AddRoleToInstanceProfile</code></p>
</li>
<li>
<p><code>iam:CreateInstanceProfile</code></p>
</li>
<li>
<p><code>iam:CreateRole</code></p>
</li>
<li>
<p><code>iam:DeleteInstanceProfile</code></p>
</li>
<li>
<p><code>iam:DeleteRole</code></p>
</li>
<li>
<p><code>iam:DeleteRolePolicy</code></p>
</li>
<li>
<p><code>iam:GetInstanceProfile</code></p>
</li>
<li>
<p><code>iam:GetRole</code></p>
</li>
<li>
<p><code>iam:GetRolePolicy</code></p>
</li>
<li>
<p><code>iam:GetUser</code></p>
</li>
<li>
<p><code>iam:ListInstanceProfilesForRole</code></p>
</li>
<li>
<p><code>iam:ListRoles</code></p>
</li>
<li>
<p><code>iam:ListUsers</code></p>
</li>
<li>
<p><code>iam:PassRole</code></p>
</li>
<li>
<p><code>iam:PutRolePolicy</code></p>
</li>
<li>
<p><code>iam:RemoveRoleFromInstanceProfile</code></p>
</li>
<li>
<p><code>iam:SimulatePrincipalPolicy</code></p>
</li>
<li>
<p><code>iam:TagRole</code></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Required Route53 permissions for installation</div>
<ul>
<li>
<p><code>route53:ChangeResourceRecordSets</code></p>
</li>
<li>
<p><code>route53:ChangeTagsForResource</code></p>
</li>
<li>
<p><code>route53:GetChange</code></p>
</li>
<li>
<p><code>route53:GetHostedZone</code></p>
</li>
<li>
<p><code>route53:CreateHostedZone</code></p>
</li>
<li>
<p><code>route53:ListHostedZones</code></p>
</li>
<li>
<p><code>route53:ListHostedZonesByName</code></p>
</li>
<li>
<p><code>route53:ListResourceRecordSets</code></p>
</li>
<li>
<p><code>route53:ListTagsForResource</code></p>
</li>
<li>
<p><code>route53:UpdateHostedZoneComment</code></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Required S3 permissions for installation</div>
<ul>
<li>
<p><code>s3:CreateBucket</code></p>
</li>
<li>
<p><code>s3:DeleteBucket</code></p>
</li>
<li>
<p><code>s3:GetAccelerateConfiguration</code></p>
</li>
<li>
<p><code>s3:GetBucketCors</code></p>
</li>
<li>
<p><code>s3:GetBucketLocation</code></p>
</li>
<li>
<p><code>s3:GetBucketLogging</code></p>
</li>
<li>
<p><code>s3:GetBucketObjectLockConfiguration</code></p>
</li>
<li>
<p><code>s3:GetBucketReplication</code></p>
</li>
<li>
<p><code>s3:GetBucketRequestPayment</code></p>
</li>
<li>
<p><code>s3:GetBucketTagging</code></p>
</li>
<li>
<p><code>s3:GetBucketVersioning</code></p>
</li>
<li>
<p><code>s3:GetBucketWebsite</code></p>
</li>
<li>
<p><code>s3:GetEncryptionConfiguration</code></p>
</li>
<li>
<p><code>s3:GetLifecycleConfiguration</code></p>
</li>
<li>
<p><code>s3:GetReplicationConfiguration</code></p>
</li>
<li>
<p><code>s3:ListBucket</code></p>
</li>
<li>
<p><code>s3:PutBucketAcl</code></p>
</li>
<li>
<p><code>s3:PutBucketTagging</code></p>
</li>
<li>
<p><code>s3:PutEncryptionConfiguration</code></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">S3 permissions that cluster Operators require</div>
<ul>
<li>
<p><code>s3:PutObject</code></p>
</li>
<li>
<p><code>s3:PutObjectAcl</code></p>
</li>
<li>
<p><code>s3:PutObjectTagging</code></p>
</li>
<li>
<p><code>s3:GetObject</code></p>
</li>
<li>
<p><code>s3:GetObjectAcl</code></p>
</li>
<li>
<p><code>s3:GetObjectTagging</code></p>
</li>
<li>
<p><code>s3:GetObjectVersion</code></p>
</li>
<li>
<p><code>s3:DeleteObject</code></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">All additional permissions that are required to uninstall a cluster</div>
<ul>
<li>
<p><code>autoscaling:DescribeAutoScalingGroups</code></p>
</li>
<li>
<p><code>ec2:DeleteDhcpOptions</code></p>
</li>
<li>
<p><code>ec2:DeleteInternetGateway</code></p>
</li>
<li>
<p><code>ec2:DeleteNatGateway</code></p>
</li>
<li>
<p><code>ec2:DeleteNetworkInterface</code></p>
</li>
<li>
<p><code>ec2:DeleteRoute</code></p>
</li>
<li>
<p><code>ec2:DeleteRouteTable</code></p>
</li>
<li>
<p><code>ec2:DeleteSnapshot</code></p>
</li>
<li>
<p><code>ec2:DeleteSecurityGroup</code></p>
</li>
<li>
<p><code>ec2:DeleteSubnet</code></p>
</li>
<li>
<p><code>ec2:DeleteVolume</code></p>
</li>
<li>
<p><code>ec2:DeleteVpc</code></p>
</li>
<li>
<p><code>ec2:DeleteVpcEndpoints</code></p>
</li>
<li>
<p><code>ec2:DeregisterImage</code></p>
</li>
<li>
<p><code>ec2:DetachInternetGateway</code></p>
</li>
<li>
<p><code>ec2:DisassociateRouteTable</code></p>
</li>
<li>
<p><code>ec2:ReleaseAddress</code></p>
</li>
<li>
<p><code>elasticloadbalancing:DescribeTargetGroups</code></p>
</li>
<li>
<p><code>elasticloadbalancing:DeleteTargetGroup</code></p>
</li>
<li>
<p><code>elasticloadbalancing:DeleteLoadBalancer</code></p>
</li>
<li>
<p><code>iam:ListInstanceProfiles</code></p>
</li>
<li>
<p><code>iam:ListRolePolicies</code></p>
</li>
<li>
<p><code>iam:ListUserPolicies</code></p>
</li>
<li>
<p><code>route53:DeleteHostedZone</code></p>
</li>
<li>
<p><code>tag:GetResources</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-obtaining-installer_installing-aws-user-infra"><a class="anchor" href="#installation-obtaining-installer_installing-aws-user-infra"></a>Obtaining the installation program</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you install OpenShift Container Platform, download the installation file on a local
computer.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You must install the cluster from a computer that uses Linux or macOS.</p>
</li>
<li>
<p>You need 300 MB of local disk space to download the installation program.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Access the <a href="https://cloud.redhat.com/openshift/install">Infrastructure Provider</a>
page on the Red Hat OpenShift Cluster Manager site. If you have a Red Hat account, log in with your credentials. If you do not, create an account.</p>
</li>
<li>
<p>Navigate to the page for your installation type, download the installation program for your operating system, and place the file in the directory where you will store the installation configuration files.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The installation program creates several files on the computer that you use to
install your cluster. You must keep both the installation program and the files
that the installation program creates after you finish installing the cluster.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Extract the installation program. For example, on a computer that uses a Linux
operating system, run the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ tar xvf &lt;installation_program&gt;.tar.gz</pre>
</div>
</div>
</li>
<li>
<p>From the
<a href="https://cloud.redhat.com/openshift/install/pull-secret">Pull Secret</a> page on the Red Hat OpenShift Cluster Manager site, download your installation pull secret as a <code>.txt</code> file or copy it to your
clipboard. This pull secret allows you to authenticate with the services that
are provided by the included authorities, including Quay.io, which serves the
container images for OpenShift Container Platform components.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ssh-agent-using_installing-aws-user-infra"><a class="anchor" href="#ssh-agent-using_installing-aws-user-infra"></a>Generating an SSH private key and adding it to the agent</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For production OpenShift Container Platform clusters on which you want to perform installation
debugging or disaster recovery, you must provide an SSH key that your <code>ssh-agent</code>
process uses to the installer.</p>
</div>
<div class="paragraph">
<p>You can use this key to SSH into the master nodes as the user <code>core</code>. When you
deploy the cluster, the key is added to the <code>core</code> user&#8217;s
<code>~/.ssh/authorized_keys</code> list.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must use a local key, not one that you configured with platform-specific
approaches such as
<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html">AWS key pairs</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>If you do not have an SSH key that is configured for password-less authentication
on your computer, create one.
For example, on a computer that uses a Linux operating system, run the
following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ ssh-keygen -t rsa -b 4096 -N '' \
    -f &lt;path&gt;/&lt;file_name&gt; <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Specify the path and file name, such as <code>~/.ssh/id_rsa</code>, of the SSH key.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Running this command generates an SSH key that does not require a password in
the location that you specified.</p>
</div>
</li>
<li>
<p>Start the <code>ssh-agent</code> process as a background task:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ eval "$(ssh-agent -s)"

Agent pid 31874</pre>
</div>
</div>
</li>
<li>
<p>Add your SSH private key to the <code>ssh-agent</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ ssh-add &lt;path&gt;/&lt;file_name&gt; <i class="conum" data-value="1"></i><b>(1)</b>

Identity added: /home/&lt;you&gt;/&lt;path&gt;/&lt;file_name&gt; (&lt;computer_name&gt;)</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Specify the path and file name for your SSH private key, such as <code>~/.ssh/id_rsa</code></td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Next steps</div>
<p>When you install OpenShift Container Platform, provide the SSH public key to the installer.
If you install a cluster on infrastructure that you provision, you must provide
this key to your cluster&#8217;s machines.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-generate-aws-user-infra_installing-aws-user-infra"><a class="anchor" href="#installation-generate-aws-user-infra_installing-aws-user-infra"></a>Creating the installation files for AWS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To install OpenShift Container Platform on Amazon Web Services (AWS) using user-provisioned
infrastructure, you must generate the files that the installation
program needs to deploy your cluster and modify them so that the cluster creates
only the machines that it will use. You generate and customize the
<code>install_config.yaml</code> file, Kubernetes manifests, and Ignition config files.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Ignition config files that the installation program generates contain
certificates that expire after 24 hours. You must complete your cluster
installation and keep the cluster running for 24 hours in a non-degraded state
to ensure that the first certificate rotation has finished.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Obtain the OpenShift Container Platform installation program and the pull secret for your cluster.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Obtain the <code>install-config.yaml</code> file.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ ./openshift-install create install-config --dir=&lt;installation_directory&gt; <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For <code>&lt;installation_directory&gt;</code>, specify the directory name to store the
files that the installation program creates.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Specify an empty directory. Some installation assets, like bootstrap X.509
certificates have short expiration intervals, so you must not reuse an
installation directory. If you want to reuse individual files from another
cluster installation, you can copy them into your directory. However, the file
names for the installation assets might change between releases. Use caution
when copying installation files from an earlier OpenShift Container Platform version.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>At the prompts, provide the configuration details for your cloud:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Optional: Select an SSH key to use to access your cluster machines.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For production OpenShift Container Platform clusters on which you want to perform installation
debugging or disaster recovery, you must provide an SSH key that your <code>ssh-agent</code>
process uses to the installation program.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Select AWS as the platform to target.</p>
</li>
<li>
<p>If you do not have an AWS profile stored on your computer, enter the AWS
access key ID and secret access key for the user that you configured to run the
installation program.</p>
</li>
<li>
<p>Select the AWS region to deploy the cluster to.</p>
</li>
<li>
<p>Select the base domain for the Route53 service that you configured for your cluster.</p>
</li>
<li>
<p>Enter a descriptive name for your cluster.</p>
</li>
<li>
<p>Paste the pull secret that you obtained from the
<a href="https://cloud.redhat.com/openshift/install/pull-secret">Pull Secret</a> page on the Red Hat OpenShift Cluster Manager site.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Edit the <code>install-config.yaml</code> file to set the number of compute, or worker,
replicas to <code>0</code>, as shown in the following <code>compute</code> stanza:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">compute</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">hyperthreading</span><span class="pi">:</span> <span class="s">Enabled</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">worker</span>
  <span class="na">platform</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="s">0</span></code></pre>
</div>
</div>
</li>
<li>
<p>Optional: Back up the <code>install-config.yaml</code> file.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>install-config.yaml</code> file is consumed during the next step. If you want to
reuse the file, back it up now.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Remove the Kubernetes manifest files for the control plane machines. By
removing these files, you prevent the cluster from automatically generating
control plane machines.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Generate the Kubernetes manifests for the cluster:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ ./openshift-install create manifests --dir=&lt;installation_directory&gt; <i class="conum" data-value="1"></i><b>(1)</b>

WARNING There are no compute nodes specified. The cluster will not fully initialize without compute nodes.
INFO Consuming "Install Config" from target directory</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For <code>&lt;installation_directory&gt;</code>, specify the same installation directory.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Because you create your own compute machines later in the installation process,
you can safely ignore this warning.</p>
</div>
</li>
<li>
<p>Remove the files that define the control plane machines:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ rm -f openshift/99_openshift-cluster-api_master-machines-*.yaml</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Remove the Kubernetes manifest files that define the worker machines:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ rm -f openshift/99_openshift-cluster-api_worker-machineset-*</pre>
</div>
</div>
<div class="paragraph">
<p>Because you create and manage the worker machines yourself, you do not need
to initialize these machines.</p>
</div>
</li>
<li>
<p>Obtain the Ignition config files:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ ./openshift-install create ignition-configs --dir=&lt;installation_directory&gt; <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For <code>&lt;installation_directory&gt;</code>, specify the same installation directory.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following files are generated in the directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">.
├── auth
│   ├── kubeadmin-password
│   └── kubeconfig
├── bootstrap.ign
├── master.ign
├── metadata.json
└── worker.ign</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-extracting-infraid_installing-aws-user-infra"><a class="anchor" href="#installation-extracting-infraid_installing-aws-user-infra"></a>Extracting the infrastructure name</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Ignition configs contain a unique cluster identifier that you can use to
uniquely identify your cluster in Amazon Web Services (AWS) tags. The provided
CloudFormation templates contain references to this tag, so you must extract
it.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Obtain the OpenShift Container Platform installation program and the pull secret for your cluster.</p>
</li>
<li>
<p>Generate the Ignition config files for your cluster.</p>
</li>
<li>
<p>Install the <code>jq</code> package.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>To extract the infrastructure name from the Ignition config file metadata, run
the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ jq -r .infraID /&lt;installation_directory&gt;/metadata.json <i class="conum" data-value="1"></i><b>(1)</b>
openshift-vw9j6 <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For <code>&lt;installation_directory&gt;</code>, specify the path to the directory that you stored the
installation files in.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The output of this command is your cluster name and a random string.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You need the output of this command to configure the provided CloudFormation
templates and can use it in other AWS tags.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-creating-aws-vpc_installing-aws-user-infra"><a class="anchor" href="#installation-creating-aws-vpc_installing-aws-user-infra"></a>Creating a VPC in AWS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You must create a VPC in Amazon Web Services (AWS) for your OpenShift Container Platform
cluster to use. You can customize the VPC to meet your requirements, including
VPN and route tables. The easiest way to create the VPC is to modify the
provided CloudFormation template.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not use the provided CloudFormation template to create your AWS
infrastructure, you must review the provided information and manually create
the infrastructure. If your cluster does not initialize correctly, you might
have to contact Red Hat support with your installation logs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Configure an AWS account.</p>
</li>
<li>
<p>Generate the Ignition config files for your cluster.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a JSON file that contains the parameter values that the template
requires:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="json"><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VpcCidr"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="1"></i><b>(1)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.0.0.0/16"</span><span class="w"> <i class="conum" data-value="2"></i><b>(2)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AvailabilityZoneCount"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="3"></i><b>(3)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w"> <i class="conum" data-value="4"></i><b>(4)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SubnetBits"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="5"></i><b>(5)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12"</span><span class="w"> <i class="conum" data-value="6"></i><b>(6)</b>
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The CIDR block for the VPC.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Specify a CIDR block in the format <code>x.x.x.x/16-24</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The number of availability zones to deploy the VPC in.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Specify an integer between <code>1</code> and <code>3</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The size of each subnet in each availability zone.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Specify an integer between  <code>5</code> and <code>13</code>, where <code>5</code> is <code>/27</code> and <code>13</code> is <code>/19</code>.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Copy the template from the <strong>CloudFormation template for the VPC</strong>
section of this topic and save it as a YAML file on your computer. This template
describes the VPC that your cluster requires.</p>
</li>
<li>
<p>Launch the template:</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must enter the command on a single line.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws cloudformation create-stack --stack-name &lt;name&gt; <i class="conum" data-value="1"></i><b>(1)</b>
     --template-body file://&lt;template&gt;.yaml <i class="conum" data-value="2"></i><b>(2)</b>
     --parameters file://&lt;parameters&gt;.json <i class="conum" data-value="3"></i><b>(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>&lt;name&gt;</code> is the name for the CloudFormation stack, such as <code>cluster-vpc</code>.
You need the name of this stack if you remove the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>&lt;template&gt;</code> is the relative path to and name of the CloudFormation template
YAML file that you saved.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>&lt;parameters&gt;</code> is the relative path to and name of the CloudFormation
parameters JSON file.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Confirm that the template components exist:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws cloudformation describe-stacks --stack-name &lt;name&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>After the <code>StackStatus</code> displays <code>CREATE_COMPLETE</code>, the output displays values
for the following parameters. You must provide these parameter values to
the other CloudFormation templates that you run to create your cluster:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>VpcId</code>
</td>
<td class="hdlist2">
<p>The ID of your VPC.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>PublicSubnetIds</code>
</td>
<td class="hdlist2">
<p>The IDs of the new public subnets.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>PrivateSubnetIds</code>
</td>
<td class="hdlist2">
<p>The IDs of the new private subnets.</p>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="installation-cloudformation-vpc_installing-aws-user-infra"><a class="anchor" href="#installation-cloudformation-vpc_installing-aws-user-infra"></a>CloudFormation template for the VPC</h3>
<div class="paragraph">
<p>You can use the following CloudFormation template to deploy the VPC that
you need for your OpenShift Container Platform cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">AWSTemplateFormatVersion</span><span class="pi">:</span> <span class="s">2010-09-09</span>
<span class="na">Description</span><span class="pi">:</span> <span class="s">Template for Best Practice VPC with 1-3 AZs</span>

<span class="na">Parameters</span><span class="pi">:</span>
  <span class="na">VpcCidr</span><span class="pi">:</span>
    <span class="na">AllowedPattern</span><span class="pi">:</span> <span class="s">^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/(1[6-9]|2[0-4]))$</span>
    <span class="na">ConstraintDescription</span><span class="pi">:</span> <span class="s">CIDR block parameter must be in the form x.x.x.x/16-24.</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s">10.0.0.0/16</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">CIDR block for VPC.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">AvailabilityZoneCount</span><span class="pi">:</span>
    <span class="na">ConstraintDescription</span><span class="pi">:</span> <span class="s2">"</span><span class="s">The</span><span class="nv"> </span><span class="s">number</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">availability</span><span class="nv"> </span><span class="s">zones.</span><span class="nv"> </span><span class="s">(Min:</span><span class="nv"> </span><span class="s">1,</span><span class="nv"> </span><span class="s">Max:</span><span class="nv"> </span><span class="s">3)"</span>
    <span class="na">MinValue</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">MaxValue</span><span class="pi">:</span> <span class="m">3</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">How</span><span class="nv"> </span><span class="s">many</span><span class="nv"> </span><span class="s">AZs</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">create</span><span class="nv"> </span><span class="s">VPC</span><span class="nv"> </span><span class="s">subnets</span><span class="nv"> </span><span class="s">for.</span><span class="nv"> </span><span class="s">(Min:</span><span class="nv"> </span><span class="s">1,</span><span class="nv"> </span><span class="s">Max:</span><span class="nv"> </span><span class="s">3)"</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Number</span>
  <span class="na">SubnetBits</span><span class="pi">:</span>
    <span class="na">ConstraintDescription</span><span class="pi">:</span> <span class="s">CIDR block parameter must be in the form x.x.x.x/19-27.</span>
    <span class="na">MinValue</span><span class="pi">:</span> <span class="m">5</span>
    <span class="na">MaxValue</span><span class="pi">:</span> <span class="m">13</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="m">12</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Size</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">each</span><span class="nv"> </span><span class="s">subnet</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">create</span><span class="nv"> </span><span class="s">within</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">availability</span><span class="nv"> </span><span class="s">zones.</span><span class="nv"> </span><span class="s">(Min:</span><span class="nv"> </span><span class="s">5</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">/27,</span><span class="nv"> </span><span class="s">Max:</span><span class="nv"> </span><span class="s">13</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">/19)"</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Number</span>

<span class="na">Metadata</span><span class="pi">:</span>
  <span class="s">AWS::CloudFormation::Interface:</span>
    <span class="s">ParameterGroups</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Network</span><span class="nv"> </span><span class="s">Configuration"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">VpcCidr</span>
      <span class="pi">-</span> <span class="s">SubnetBits</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Availability</span><span class="nv"> </span><span class="s">Zones"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">AvailabilityZoneCount</span>
    <span class="na">ParameterLabels</span><span class="pi">:</span>
      <span class="na">AvailabilityZoneCount</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Availability</span><span class="nv"> </span><span class="s">Zone</span><span class="nv"> </span><span class="s">Count"</span>
      <span class="na">VpcCidr</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">VPC</span><span class="nv"> </span><span class="s">CIDR"</span>
      <span class="na">SubnetBits</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Bits</span><span class="nv"> </span><span class="s">Per</span><span class="nv"> </span><span class="s">Subnet"</span>

<span class="na">Conditions</span><span class="pi">:</span>
  <span class="na">DoAz3</span><span class="pi">:</span> <span class="kt">!Equals</span> <span class="pi">[</span><span class="nv">3</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">AvailabilityZoneCount</span><span class="pi">]</span>
  <span class="na">DoAz2</span><span class="pi">:</span> <span class="kt">!Or</span> <span class="pi">[</span><span class="kt">!Equals</span> <span class="pi">[</span><span class="nv">2</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">AvailabilityZoneCount</span><span class="pi">],</span> <span class="nv">Condition</span><span class="pi">:</span> <span class="nv">DoAz3</span><span class="pi">]</span>

<span class="na">Resources</span><span class="pi">:</span>
  <span class="na">VPC</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::VPC"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">EnableDnsSupport</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
      <span class="na">EnableDnsHostnames</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
      <span class="na">CidrBlock</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VpcCidr</span>
  <span class="na">PublicSubnet</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::Subnet"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>
      <span class="na">CidrBlock</span><span class="pi">:</span> <span class="kt">!Select</span> <span class="pi">[</span><span class="nv">0</span><span class="pi">,</span> <span class="kt">!Cidr</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">VpcCidr</span><span class="pi">,</span> <span class="nv">6</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">SubnetBits</span><span class="pi">]]</span>
      <span class="na">AvailabilityZone</span><span class="pi">:</span> <span class="kt">!Select</span>
      <span class="pi">-</span> <span class="m">0</span>
      <span class="pi">-</span> <span class="s">Fn::GetAZs: !Ref "AWS::Region"</span>
  <span class="na">PublicSubnet2</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::Subnet"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz2</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>
      <span class="na">CidrBlock</span><span class="pi">:</span> <span class="kt">!Select</span> <span class="pi">[</span><span class="nv">1</span><span class="pi">,</span> <span class="kt">!Cidr</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">VpcCidr</span><span class="pi">,</span> <span class="nv">6</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">SubnetBits</span><span class="pi">]]</span>
      <span class="na">AvailabilityZone</span><span class="pi">:</span> <span class="kt">!Select</span>
      <span class="pi">-</span> <span class="m">1</span>
      <span class="pi">-</span> <span class="s">Fn::GetAZs: !Ref "AWS::Region"</span>
  <span class="na">PublicSubnet3</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::Subnet"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz3</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>
      <span class="na">CidrBlock</span><span class="pi">:</span> <span class="kt">!Select</span> <span class="pi">[</span><span class="nv">2</span><span class="pi">,</span> <span class="kt">!Cidr</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">VpcCidr</span><span class="pi">,</span> <span class="nv">6</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">SubnetBits</span><span class="pi">]]</span>
      <span class="na">AvailabilityZone</span><span class="pi">:</span> <span class="kt">!Select</span>
      <span class="pi">-</span> <span class="m">2</span>
      <span class="pi">-</span> <span class="s">Fn::GetAZs: !Ref "AWS::Region"</span>
  <span class="na">InternetGateway</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::InternetGateway"</span>
  <span class="na">GatewayToInternet</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::VPCGatewayAttachment"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>
      <span class="na">InternetGatewayId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternetGateway</span>
  <span class="na">PublicRouteTable</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::RouteTable"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>
  <span class="na">PublicRoute</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::Route"</span>
    <span class="na">DependsOn</span><span class="pi">:</span> <span class="s">GatewayToInternet</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">RouteTableId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PublicRouteTable</span>
      <span class="na">DestinationCidrBlock</span><span class="pi">:</span> <span class="s">0.0.0.0/0</span>
      <span class="na">GatewayId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternetGateway</span>
  <span class="na">PublicSubnetRouteTableAssociation</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::SubnetRouteTableAssociation"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PublicSubnet</span>
      <span class="na">RouteTableId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PublicRouteTable</span>
  <span class="na">PublicSubnetRouteTableAssociation2</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::SubnetRouteTableAssociation"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz2</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PublicSubnet2</span>
      <span class="na">RouteTableId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PublicRouteTable</span>
  <span class="na">PublicSubnetRouteTableAssociation3</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz3</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::SubnetRouteTableAssociation"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PublicSubnet3</span>
      <span class="na">RouteTableId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PublicRouteTable</span>
  <span class="na">PrivateSubnet</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::Subnet"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>
      <span class="na">CidrBlock</span><span class="pi">:</span> <span class="kt">!Select</span> <span class="pi">[</span><span class="nv">3</span><span class="pi">,</span> <span class="kt">!Cidr</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">VpcCidr</span><span class="pi">,</span> <span class="nv">6</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">SubnetBits</span><span class="pi">]]</span>
      <span class="na">AvailabilityZone</span><span class="pi">:</span> <span class="kt">!Select</span>
      <span class="pi">-</span> <span class="m">0</span>
      <span class="pi">-</span> <span class="s">Fn::GetAZs: !Ref "AWS::Region"</span>
  <span class="na">PrivateRouteTable</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::RouteTable"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>
  <span class="na">PrivateSubnetRouteTableAssociation</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::SubnetRouteTableAssociation"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PrivateSubnet</span>
      <span class="na">RouteTableId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PrivateRouteTable</span>
  <span class="na">NAT</span><span class="pi">:</span>
    <span class="na">DependsOn</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">GatewayToInternet</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::NatGateway"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">AllocationId</span><span class="pi">:</span>
        <span class="s2">"</span><span class="s">Fn::GetAtt"</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">EIP</span>
        <span class="pi">-</span> <span class="s">AllocationId</span>
      <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PublicSubnet</span>
  <span class="na">EIP</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::EIP"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Domain</span><span class="pi">:</span> <span class="s">vpc</span>
  <span class="na">Route</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::Route"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">RouteTableId</span><span class="pi">:</span>
        <span class="na">Ref</span><span class="pi">:</span> <span class="s">PrivateRouteTable</span>
      <span class="na">DestinationCidrBlock</span><span class="pi">:</span> <span class="s">0.0.0.0/0</span>
      <span class="na">NatGatewayId</span><span class="pi">:</span>
        <span class="na">Ref</span><span class="pi">:</span> <span class="s">NAT</span>
  <span class="na">PrivateSubnet2</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::Subnet"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz2</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>
      <span class="na">CidrBlock</span><span class="pi">:</span> <span class="kt">!Select</span> <span class="pi">[</span><span class="nv">4</span><span class="pi">,</span> <span class="kt">!Cidr</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">VpcCidr</span><span class="pi">,</span> <span class="nv">6</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">SubnetBits</span><span class="pi">]]</span>
      <span class="na">AvailabilityZone</span><span class="pi">:</span> <span class="kt">!Select</span>
      <span class="pi">-</span> <span class="m">1</span>
      <span class="pi">-</span> <span class="s">Fn::GetAZs: !Ref "AWS::Region"</span>
  <span class="na">PrivateRouteTable2</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::RouteTable"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz2</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>
  <span class="na">PrivateSubnetRouteTableAssociation2</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::SubnetRouteTableAssociation"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz2</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PrivateSubnet2</span>
      <span class="na">RouteTableId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PrivateRouteTable2</span>
  <span class="na">NAT2</span><span class="pi">:</span>
    <span class="na">DependsOn</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">GatewayToInternet</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::NatGateway"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz2</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">AllocationId</span><span class="pi">:</span>
        <span class="s2">"</span><span class="s">Fn::GetAtt"</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">EIP2</span>
        <span class="pi">-</span> <span class="s">AllocationId</span>
      <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PublicSubnet2</span>
  <span class="na">EIP2</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::EIP"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz2</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Domain</span><span class="pi">:</span> <span class="s">vpc</span>
  <span class="na">Route2</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::Route"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz2</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">RouteTableId</span><span class="pi">:</span>
        <span class="na">Ref</span><span class="pi">:</span> <span class="s">PrivateRouteTable2</span>
      <span class="na">DestinationCidrBlock</span><span class="pi">:</span> <span class="s">0.0.0.0/0</span>
      <span class="na">NatGatewayId</span><span class="pi">:</span>
        <span class="na">Ref</span><span class="pi">:</span> <span class="s">NAT2</span>
  <span class="na">PrivateSubnet3</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::Subnet"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz3</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>
      <span class="na">CidrBlock</span><span class="pi">:</span> <span class="kt">!Select</span> <span class="pi">[</span><span class="nv">5</span><span class="pi">,</span> <span class="kt">!Cidr</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">VpcCidr</span><span class="pi">,</span> <span class="nv">6</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">SubnetBits</span><span class="pi">]]</span>
      <span class="na">AvailabilityZone</span><span class="pi">:</span> <span class="kt">!Select</span>
      <span class="pi">-</span> <span class="m">2</span>
      <span class="pi">-</span> <span class="s">Fn::GetAZs: !Ref "AWS::Region"</span>
  <span class="na">PrivateRouteTable3</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::RouteTable"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz3</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>
  <span class="na">PrivateSubnetRouteTableAssociation3</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::SubnetRouteTableAssociation"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz3</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PrivateSubnet3</span>
      <span class="na">RouteTableId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PrivateRouteTable3</span>
  <span class="na">NAT3</span><span class="pi">:</span>
    <span class="na">DependsOn</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">GatewayToInternet</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::NatGateway"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz3</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">AllocationId</span><span class="pi">:</span>
        <span class="s2">"</span><span class="s">Fn::GetAtt"</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">EIP3</span>
        <span class="pi">-</span> <span class="s">AllocationId</span>
      <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PublicSubnet3</span>
  <span class="na">EIP3</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::EIP"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz3</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Domain</span><span class="pi">:</span> <span class="s">vpc</span>
  <span class="na">Route3</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::EC2::Route"</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoAz3</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">RouteTableId</span><span class="pi">:</span>
        <span class="na">Ref</span><span class="pi">:</span> <span class="s">PrivateRouteTable3</span>
      <span class="na">DestinationCidrBlock</span><span class="pi">:</span> <span class="s">0.0.0.0/0</span>
      <span class="na">NatGatewayId</span><span class="pi">:</span>
        <span class="na">Ref</span><span class="pi">:</span> <span class="s">NAT3</span>
  <span class="na">S3Endpoint</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::VPCEndpoint</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">PolicyDocument</span><span class="pi">:</span>
        <span class="na">Version</span><span class="pi">:</span> <span class="s">2012-10-17</span>
        <span class="na">Statement</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s">Allow</span>
          <span class="na">Principal</span><span class="pi">:</span> <span class="s1">'</span><span class="s">*'</span>
          <span class="na">Action</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s1">'</span><span class="s">*'</span>
          <span class="na">Resource</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s1">'</span><span class="s">*'</span>
      <span class="na">RouteTableIds</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s">PublicRouteTable</span>
      <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s">PrivateRouteTable</span>
      <span class="pi">-</span> <span class="kt">!If</span> <span class="pi">[</span><span class="nv">DoAz2</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">PrivateRouteTable2</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">AWS::NoValue"</span><span class="pi">]</span>
      <span class="pi">-</span> <span class="kt">!If</span> <span class="pi">[</span><span class="nv">DoAz3</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">PrivateRouteTable3</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">AWS::NoValue"</span><span class="pi">]</span>
      <span class="na">ServiceName</span><span class="pi">:</span> <span class="kt">!Join</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">'</span>
      <span class="pi">-</span> <span class="pi">-</span> <span class="s">com.amazonaws.</span>
        <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s1">'</span><span class="s">AWS::Region'</span>
        <span class="pi">-</span> <span class="s">.s3</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>

<span class="na">Outputs</span><span class="pi">:</span>
  <span class="na">VpcId</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">ID of the new VPC.</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VPC</span>
  <span class="na">PublicSubnetIds</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Subnet IDs of the public subnets.</span>
    <span class="na">Value</span><span class="pi">:</span>
      <span class="kt">!Join</span> <span class="pi">[</span>
        <span class="s2">"</span><span class="s">,"</span><span class="pi">,</span>
        <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">PublicSubnet</span><span class="pi">,</span> <span class="kt">!If</span> <span class="pi">[</span><span class="nv">DoAz2</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">PublicSubnet2</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">AWS::NoValue"</span><span class="pi">],</span> <span class="kt">!If</span> <span class="pi">[</span><span class="nv">DoAz3</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">PublicSubnet3</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">AWS::NoValue"</span><span class="pi">]]</span>
      <span class="pi">]</span>
  <span class="na">PrivateSubnetIds</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Subnet IDs of the private subnets.</span>
    <span class="na">Value</span><span class="pi">:</span>
      <span class="kt">!Join</span> <span class="pi">[</span>
        <span class="s2">"</span><span class="s">,"</span><span class="pi">,</span>
        <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">PrivateSubnet</span><span class="pi">,</span> <span class="kt">!If</span> <span class="pi">[</span><span class="nv">DoAz2</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">PrivateSubnet2</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">AWS::NoValue"</span><span class="pi">],</span> <span class="kt">!If</span> <span class="pi">[</span><span class="nv">DoAz3</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">PrivateSubnet3</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">AWS::NoValue"</span><span class="pi">]]</span>
      <span class="pi">]</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-creating-aws-dns_installing-aws-user-infra"><a class="anchor" href="#installation-creating-aws-dns_installing-aws-user-infra"></a>Creating networking and load balancing components in AWS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You must configure networking and load balancing (classic or network) in Amazon Web Services (AWS) for your
OpenShift Container Platform cluster to use. The easiest way to create these components is
to modify the provided CloudFormation template, which also creates a hosted zone
and subnet tags.</p>
</div>
<div class="paragraph">
<p>You can run the template multiple times within a single VPC.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not use the provided CloudFormation template to create your AWS
infrastructure, you must review the provided information and manually create
the infrastructure. If your cluster does not initialize correctly, you might
have to contact Red Hat support with your installation logs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Configure an AWS account.</p>
</li>
<li>
<p>Generate the Ignition config files for your cluster.</p>
</li>
<li>
<p>Create and configure a VPC and associated subnets in AWS.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Obtain the Hosted Zone ID for the Route53 zone that you specified in the
<code>install-config.yaml</code> file for your cluster. You can obtain this ID from the
AWS console or by running the following command:</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must enter the command on a single line.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws route53 list-hosted-zones-by-name |
     jq --arg name "&lt;route53_domain&gt;." \ <i class="conum" data-value="1"></i><b>(1)</b>
     -r '.HostedZones | .[] | select(.Name=="\($name)") | .Id'</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For the <code>&lt;route53_domain&gt;</code>, specify the Route53 base domain that you used
when you generated the <code>install-config.yaml</code> file for the cluster.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Create a JSON file that contains the parameter values that the template
requires:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="json"><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ClusterName"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="1"></i><b>(1)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mycluster"</span><span class="w"> <i class="conum" data-value="2"></i><b>(2)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"InfrastructureName"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="3"></i><b>(3)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mycluster-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="4"></i><b>(4)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HostedZoneId"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="5"></i><b>(5)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="6"></i><b>(6)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HostedZoneName"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="7"></i><b>(7)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example.com"</span><span class="w"> <i class="conum" data-value="8"></i><b>(8)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PublicSubnets"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="9"></i><b>(9)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subnet-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="10"></i><b>(10)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PrivateSubnets"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="11"></i><b>(11)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subnet-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="12"></i><b>(12)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VpcId"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="13"></i><b>(13)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vpc-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="14"></i><b>(14)</b>
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A short, representative cluster name to use for host names, etc.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Specify the cluster name that you used when you generated the
<code>install-config.yaml</code> file for the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The name for your cluster infrastructure that is encoded in your Ignition
config files for the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Specify the infrastructure name that you extracted from the Ignition config
file metadata, which has the format <code>&lt;cluster-name&gt;-&lt;random-string&gt;</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The Route53 public zone ID to register the targets with.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Specify the Route53 public zone ID, which as a format similar to
<code>Z21IXYZABCZ2A4</code>. You can obtain this value from the AWS console.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The Route53 zone to register the targets with.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Specify the Route53 base domain that you used when you generated the
<code>install-config.yaml</code> file for the cluster. Do not include the trailing period
(.) that is displayed in the AWS console.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>The public subnets that you created for your VPC.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Specify the <code>PublicSubnetIds</code> value from the output of the CloudFormation
template for the VPC.</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>The private subnets that you created for your VPC.</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>Specify the <code>PrivateSubnetIds</code> value from the output of the CloudFormation
template for the VPC.</td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>The VPC that you created for the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="14"></i><b>14</b></td>
<td>Specify the <code>VpcId</code> value from the output of the CloudFormation template
for the VPC.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Copy the template from the <strong>CloudFormation template for the network and load balancers</strong>
section of this topic and save it as a YAML file on your computer. This template
describes the networking and load balancing objects that your cluster requires.</p>
</li>
<li>
<p>Launch the template:</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must enter the command on a single line.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws cloudformation create-stack --stack-name &lt;name&gt; <i class="conum" data-value="1"></i><b>(1)</b>
     --template-body file://&lt;template&gt;.yaml <i class="conum" data-value="2"></i><b>(2)</b>
     --parameters file://&lt;parameters&gt;.json <i class="conum" data-value="3"></i><b>(3)</b>
     --capabilities CAPABILITY_NAMED_IAM</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>&lt;name&gt;</code> is the name for the CloudFormation stack, such as <code>cluster-dns</code>.
You need the name of this stack if you remove the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>&lt;template&gt;</code> is the relative path to and name of the CloudFormation template
YAML file that you saved.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>&lt;parameters&gt;</code> is the relative path to and name of the CloudFormation
parameters JSON file.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Confirm that the template components exist:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws cloudformation describe-stacks --stack-name &lt;name&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>After the <code>StackStatus</code> displays <code>CREATE_COMPLETE</code>, the output displays values
for the following parameters. You must provide these parameter values to
the other CloudFormation templates that you run to create your cluster:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>PrivateHostedZoneId</code>
</td>
<td class="hdlist2">
<p>Hosted zone ID for the private DNS.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ExternalApiLoadBalancerName</code>
</td>
<td class="hdlist2">
<p>Full name of the external API load balancer.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>InternalApiLoadBalancerName</code>
</td>
<td class="hdlist2">
<p>Full name of the internal API load balancer.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ApiServerDnsName</code>
</td>
<td class="hdlist2">
<p>Full host name of the API server.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>RegisterNlbIpTargetsLambda</code>
</td>
<td class="hdlist2">
<p>Lambda ARN useful to help register/deregister IP
targets for these load balancers.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ExternalApiTargetGroupArn</code>
</td>
<td class="hdlist2">
<p>ARN of external API target group.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>InternalApiTargetGroupArn</code>
</td>
<td class="hdlist2">
<p>ARN of internal API target group.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>InternalServiceTargetGroupArn</code>
</td>
<td class="hdlist2">
<p>ARN of internal service target group.</p>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="installation-cloudformation-dns_installing-aws-user-infra"><a class="anchor" href="#installation-cloudformation-dns_installing-aws-user-infra"></a>CloudFormation template for the network and load balancers</h3>
<div class="paragraph">
<p>You can use the following CloudFormation template to deploy the networking
objects and load balancers that you need for your OpenShift Container Platform cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">AWSTemplateFormatVersion</span><span class="pi">:</span> <span class="s">2010-09-09</span>
<span class="na">Description</span><span class="pi">:</span> <span class="s">Template for OpenShift Cluster Network Elements (Route53 &amp; LBs)</span>

<span class="na">Parameters</span><span class="pi">:</span>
  <span class="na">ClusterName</span><span class="pi">:</span>
    <span class="na">AllowedPattern</span><span class="pi">:</span> <span class="s">^([a-zA-Z][a-zA-Z0-9\-]{0,26})$</span>
    <span class="na">MaxLength</span><span class="pi">:</span> <span class="m">27</span>
    <span class="na">MinLength</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">ConstraintDescription</span><span class="pi">:</span> <span class="s">Cluster name must be alphanumeric, start with a letter, and have a maximum of 27 characters.</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">A short, representative cluster name to use for host names and other identifying names.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">InfrastructureName</span><span class="pi">:</span>
    <span class="na">AllowedPattern</span><span class="pi">:</span> <span class="s">^([a-zA-Z][a-zA-Z0-9\-]{0,26})$</span>
    <span class="na">MaxLength</span><span class="pi">:</span> <span class="m">27</span>
    <span class="na">MinLength</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">ConstraintDescription</span><span class="pi">:</span> <span class="s">Infrastructure name must be alphanumeric, start with a letter, and have a maximum of 27 characters.</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">A short, unique cluster ID used to tag cloud resources and identify items owned or used by the cluster.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">HostedZoneId</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The Route53 public zone ID to register the targets with, such as Z21IXYZABCZ2A4.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">HostedZoneName</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The Route53 zone to register the targets with, such as example.com. Omit the trailing period.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">example.com"</span>
  <span class="na">PublicSubnets</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The internet-facing subnets.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">List&lt;AWS::EC2::Subnet::Id&gt;</span>
  <span class="na">PrivateSubnets</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The internal subnets.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">List&lt;AWS::EC2::Subnet::Id&gt;</span>
  <span class="na">VpcId</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The VPC-scoped resources will belong to this VPC.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::VPC::Id</span>

<span class="na">Metadata</span><span class="pi">:</span>
  <span class="s">AWS::CloudFormation::Interface:</span>
    <span class="s">ParameterGroups</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Cluster</span><span class="nv"> </span><span class="s">Information"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">ClusterName</span>
      <span class="pi">-</span> <span class="s">InfrastructureName</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Network</span><span class="nv"> </span><span class="s">Configuration"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">VpcId</span>
      <span class="pi">-</span> <span class="s">PublicSubnets</span>
      <span class="pi">-</span> <span class="s">PrivateSubnets</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">DNS"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">HostedZoneName</span>
      <span class="pi">-</span> <span class="s">HostedZoneId</span>
    <span class="na">ParameterLabels</span><span class="pi">:</span>
      <span class="na">ClusterName</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Cluster</span><span class="nv"> </span><span class="s">Name"</span>
      <span class="na">InfrastructureName</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Infrastructure</span><span class="nv"> </span><span class="s">Name"</span>
      <span class="na">VpcId</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">VPC</span><span class="nv"> </span><span class="s">ID"</span>
      <span class="na">PublicSubnets</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Public</span><span class="nv"> </span><span class="s">Subnets"</span>
      <span class="na">PrivateSubnets</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Private</span><span class="nv"> </span><span class="s">Subnets"</span>
      <span class="na">HostedZoneName</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Public</span><span class="nv"> </span><span class="s">Hosted</span><span class="nv"> </span><span class="s">Zone</span><span class="nv"> </span><span class="s">Name"</span>
      <span class="na">HostedZoneId</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Public</span><span class="nv"> </span><span class="s">Hosted</span><span class="nv"> </span><span class="s">Zone</span><span class="nv"> </span><span class="s">ID"</span>

<span class="na">Resources</span><span class="pi">:</span>
  <span class="na">ExtApiElb</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::ElasticLoadBalancingV2::LoadBalancer</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Name</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-"</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">,</span> <span class="s2">"</span><span class="s">ext"</span><span class="pi">]]</span>
      <span class="na">IpAddressType</span><span class="pi">:</span> <span class="s">ipv4</span>
      <span class="na">Subnets</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PublicSubnets</span>
      <span class="na">Type</span><span class="pi">:</span> <span class="s">network</span>

  <span class="na">IntApiElb</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::ElasticLoadBalancingV2::LoadBalancer</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Name</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-"</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">,</span> <span class="s2">"</span><span class="s">int"</span><span class="pi">]]</span>
      <span class="na">Scheme</span><span class="pi">:</span> <span class="s">internal</span>
      <span class="na">IpAddressType</span><span class="pi">:</span> <span class="s">ipv4</span>
      <span class="na">Subnets</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PrivateSubnets</span>
      <span class="na">Type</span><span class="pi">:</span> <span class="s">network</span>

  <span class="na">IntDns</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::Route53::HostedZone"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">HostedZoneConfig</span><span class="pi">:</span>
        <span class="na">Comment</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Managed</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">CloudFormation"</span>
      <span class="na">Name</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">."</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">ClusterName</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">HostedZoneName</span><span class="pi">]]</span>
      <span class="na">HostedZoneTags</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Key</span><span class="pi">:</span> <span class="s">Name</span>
        <span class="na">Value</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-"</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">,</span> <span class="s2">"</span><span class="s">int"</span><span class="pi">]]</span>
      <span class="pi">-</span> <span class="na">Key</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">,</span> <span class="pi">[</span><span class="s2">"</span><span class="s">kubernetes.io/cluster/"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">]]</span>
        <span class="na">Value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">owned"</span>
      <span class="na">VPCs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">VPCId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VpcId</span>
        <span class="na">VPCRegion</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">AWS::Region"</span>

  <span class="na">ExternalApiServerRecord</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::Route53::RecordSetGroup</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Comment</span><span class="pi">:</span> <span class="s">Alias record for the API server</span>
      <span class="na">HostedZoneId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">HostedZoneId</span>
      <span class="na">RecordSets</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Name</span><span class="pi">:</span>
          <span class="kt">!Join</span> <span class="pi">[</span>
            <span class="s2">"</span><span class="s">."</span><span class="pi">,</span>
            <span class="pi">[</span><span class="s2">"</span><span class="s">api"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">ClusterName</span><span class="pi">,</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">HostedZoneName</span><span class="pi">,</span> <span class="s2">"</span><span class="s">."</span><span class="pi">]]],</span>
          <span class="pi">]</span>
        <span class="na">Type</span><span class="pi">:</span> <span class="s">A</span>
        <span class="na">AliasTarget</span><span class="pi">:</span>
          <span class="na">HostedZoneId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">ExtApiElb.CanonicalHostedZoneID</span>
          <span class="na">DNSName</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">ExtApiElb.DNSName</span>

  <span class="na">InternalApiServerRecord</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::Route53::RecordSetGroup</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Comment</span><span class="pi">:</span> <span class="s">Alias record for the API server</span>
      <span class="na">HostedZoneId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">IntDns</span>
      <span class="na">RecordSets</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Name</span><span class="pi">:</span>
          <span class="kt">!Join</span> <span class="pi">[</span>
            <span class="s2">"</span><span class="s">."</span><span class="pi">,</span>
            <span class="pi">[</span><span class="s2">"</span><span class="s">api"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">ClusterName</span><span class="pi">,</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">HostedZoneName</span><span class="pi">,</span> <span class="s2">"</span><span class="s">."</span><span class="pi">]]],</span>
          <span class="pi">]</span>
        <span class="na">Type</span><span class="pi">:</span> <span class="s">A</span>
        <span class="na">AliasTarget</span><span class="pi">:</span>
          <span class="na">HostedZoneId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">IntApiElb.CanonicalHostedZoneID</span>
          <span class="na">DNSName</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">IntApiElb.DNSName</span>
      <span class="pi">-</span> <span class="na">Name</span><span class="pi">:</span>
          <span class="kt">!Join</span> <span class="pi">[</span>
            <span class="s2">"</span><span class="s">."</span><span class="pi">,</span>
            <span class="pi">[</span><span class="s2">"</span><span class="s">api-int"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">ClusterName</span><span class="pi">,</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">HostedZoneName</span><span class="pi">,</span> <span class="s2">"</span><span class="s">."</span><span class="pi">]]],</span>
          <span class="pi">]</span>
        <span class="na">Type</span><span class="pi">:</span> <span class="s">A</span>
        <span class="na">AliasTarget</span><span class="pi">:</span>
          <span class="na">HostedZoneId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">IntApiElb.CanonicalHostedZoneID</span>
          <span class="na">DNSName</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">IntApiElb.DNSName</span>

  <span class="na">ExternalApiListener</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::ElasticLoadBalancingV2::Listener</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">DefaultActions</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Type</span><span class="pi">:</span> <span class="s">forward</span>
        <span class="na">TargetGroupArn</span><span class="pi">:</span>
          <span class="na">Ref</span><span class="pi">:</span> <span class="s">ExternalApiTargetGroup</span>
      <span class="na">LoadBalancerArn</span><span class="pi">:</span>
        <span class="na">Ref</span><span class="pi">:</span> <span class="s">ExtApiElb</span>
      <span class="na">Port</span><span class="pi">:</span> <span class="m">6443</span>
      <span class="na">Protocol</span><span class="pi">:</span> <span class="s">TCP</span>

  <span class="na">ExternalApiTargetGroup</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::ElasticLoadBalancingV2::TargetGroup</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Port</span><span class="pi">:</span> <span class="m">6443</span>
      <span class="na">Protocol</span><span class="pi">:</span> <span class="s">TCP</span>
      <span class="na">TargetType</span><span class="pi">:</span> <span class="s">ip</span>
      <span class="na">VpcId</span><span class="pi">:</span>
        <span class="na">Ref</span><span class="pi">:</span> <span class="s">VpcId</span>
      <span class="na">TargetGroupAttributes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Key</span><span class="pi">:</span> <span class="s">deregistration_delay.timeout_seconds</span>
        <span class="na">Value</span><span class="pi">:</span> <span class="m">60</span>

  <span class="na">InternalApiListener</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::ElasticLoadBalancingV2::Listener</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">DefaultActions</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Type</span><span class="pi">:</span> <span class="s">forward</span>
        <span class="na">TargetGroupArn</span><span class="pi">:</span>
          <span class="na">Ref</span><span class="pi">:</span> <span class="s">InternalApiTargetGroup</span>
      <span class="na">LoadBalancerArn</span><span class="pi">:</span>
        <span class="na">Ref</span><span class="pi">:</span> <span class="s">IntApiElb</span>
      <span class="na">Port</span><span class="pi">:</span> <span class="m">6443</span>
      <span class="na">Protocol</span><span class="pi">:</span> <span class="s">TCP</span>

  <span class="na">InternalApiTargetGroup</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::ElasticLoadBalancingV2::TargetGroup</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Port</span><span class="pi">:</span> <span class="m">6443</span>
      <span class="na">Protocol</span><span class="pi">:</span> <span class="s">TCP</span>
      <span class="na">TargetType</span><span class="pi">:</span> <span class="s">ip</span>
      <span class="na">VpcId</span><span class="pi">:</span>
        <span class="na">Ref</span><span class="pi">:</span> <span class="s">VpcId</span>
      <span class="na">TargetGroupAttributes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Key</span><span class="pi">:</span> <span class="s">deregistration_delay.timeout_seconds</span>
        <span class="na">Value</span><span class="pi">:</span> <span class="m">60</span>

  <span class="na">InternalServiceInternalListener</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::ElasticLoadBalancingV2::Listener</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">DefaultActions</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Type</span><span class="pi">:</span> <span class="s">forward</span>
        <span class="na">TargetGroupArn</span><span class="pi">:</span>
          <span class="na">Ref</span><span class="pi">:</span> <span class="s">InternalServiceTargetGroup</span>
      <span class="na">LoadBalancerArn</span><span class="pi">:</span>
        <span class="na">Ref</span><span class="pi">:</span> <span class="s">IntApiElb</span>
      <span class="na">Port</span><span class="pi">:</span> <span class="m">22623</span>
      <span class="na">Protocol</span><span class="pi">:</span> <span class="s">TCP</span>

  <span class="na">InternalServiceTargetGroup</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::ElasticLoadBalancingV2::TargetGroup</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Port</span><span class="pi">:</span> <span class="m">22623</span>
      <span class="na">Protocol</span><span class="pi">:</span> <span class="s">TCP</span>
      <span class="na">TargetType</span><span class="pi">:</span> <span class="s">ip</span>
      <span class="na">VpcId</span><span class="pi">:</span>
        <span class="na">Ref</span><span class="pi">:</span> <span class="s">VpcId</span>
      <span class="na">TargetGroupAttributes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Key</span><span class="pi">:</span> <span class="s">deregistration_delay.timeout_seconds</span>
        <span class="na">Value</span><span class="pi">:</span> <span class="m">60</span>

  <span class="na">RegisterTargetLambdaIamRole</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::IAM::Role</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">RoleName</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-"</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">,</span> <span class="s2">"</span><span class="s">nlb"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">lambda"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">role"</span><span class="pi">]]</span>
      <span class="na">AssumeRolePolicyDocument</span><span class="pi">:</span>
        <span class="na">Version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2012-10-17"</span>
        <span class="na">Statement</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
          <span class="na">Principal</span><span class="pi">:</span>
            <span class="na">Service</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s2">"</span><span class="s">lambda.amazonaws.com"</span>
          <span class="na">Action</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s2">"</span><span class="s">sts:AssumeRole"</span>
      <span class="na">Path</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/"</span>
      <span class="na">Policies</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">PolicyName</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-"</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">,</span> <span class="s2">"</span><span class="s">master"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">policy"</span><span class="pi">]]</span>
        <span class="na">PolicyDocument</span><span class="pi">:</span>
          <span class="na">Version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2012-10-17"</span>
          <span class="na">Statement</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span>
              <span class="pi">[</span>
                <span class="s2">"</span><span class="s">elasticloadbalancing:RegisterTargets"</span><span class="pi">,</span>
                <span class="s2">"</span><span class="s">elasticloadbalancing:DeregisterTargets"</span><span class="pi">,</span>
              <span class="pi">]</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternalApiTargetGroup</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span>
              <span class="pi">[</span>
                <span class="s2">"</span><span class="s">elasticloadbalancing:RegisterTargets"</span><span class="pi">,</span>
                <span class="s2">"</span><span class="s">elasticloadbalancing:DeregisterTargets"</span><span class="pi">,</span>
              <span class="pi">]</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternalServiceTargetGroup</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span>
              <span class="pi">[</span>
                <span class="s2">"</span><span class="s">elasticloadbalancing:RegisterTargets"</span><span class="pi">,</span>
                <span class="s2">"</span><span class="s">elasticloadbalancing:DeregisterTargets"</span><span class="pi">,</span>
              <span class="pi">]</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">ExternalApiTargetGroup</span>

  <span class="na">RegisterNlbIpTargets</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::Lambda::Function"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Handler</span><span class="pi">:</span> <span class="s2">"</span><span class="s">index.handler"</span>
      <span class="na">Role</span><span class="pi">:</span>
        <span class="s">Fn::GetAtt:</span>
        <span class="s">- "RegisterTargetLambdaIamRole"</span>
        <span class="s">- "Arn"</span>
      <span class="na">Code</span><span class="pi">:</span>
        <span class="na">ZipFile</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">import json</span>
          <span class="s">import boto3</span>
          <span class="s">import cfnresponse</span>
          <span class="s">def handler(event, context):</span>
            <span class="s">elb = boto3.client('elbv2')</span>
            <span class="s">if event['RequestType'] == 'Delete':</span>
              <span class="s">elb.deregister_targets(TargetGroupArn=event['ResourceProperties']['TargetArn'],Targets=[{'Id': event['ResourceProperties']['TargetIp']}])</span>
            <span class="s">elif event['RequestType'] == 'Create':</span>
              <span class="s">elb.register_targets(TargetGroupArn=event['ResourceProperties']['TargetArn'],Targets=[{'Id': event['ResourceProperties']['TargetIp']}])</span>
            <span class="s">responseData = {}</span>
            <span class="s">cfnresponse.send(event, context, cfnresponse.SUCCESS, responseData, event['ResourceProperties']['TargetArn']+event['ResourceProperties']['TargetIp'])</span>
      <span class="na">Runtime</span><span class="pi">:</span> <span class="s2">"</span><span class="s">python3.7"</span>
      <span class="na">Timeout</span><span class="pi">:</span> <span class="m">120</span>

  <span class="na">RegisterSubnetTagsLambdaIamRole</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::IAM::Role</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">RoleName</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-"</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">,</span> <span class="s2">"</span><span class="s">subnet-tags-lambda-role"</span><span class="pi">]]</span>
      <span class="na">AssumeRolePolicyDocument</span><span class="pi">:</span>
        <span class="na">Version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2012-10-17"</span>
        <span class="na">Statement</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
          <span class="na">Principal</span><span class="pi">:</span>
            <span class="na">Service</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s2">"</span><span class="s">lambda.amazonaws.com"</span>
          <span class="na">Action</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s2">"</span><span class="s">sts:AssumeRole"</span>
      <span class="na">Path</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/"</span>
      <span class="na">Policies</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">PolicyName</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-"</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">,</span> <span class="s2">"</span><span class="s">subnet-tagging-policy"</span><span class="pi">]]</span>
        <span class="na">PolicyDocument</span><span class="pi">:</span>
          <span class="na">Version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2012-10-17"</span>
          <span class="na">Statement</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span>
              <span class="pi">[</span>
                <span class="s2">"</span><span class="s">ec2:DeleteTags"</span><span class="pi">,</span>
                <span class="s2">"</span><span class="s">ec2:CreateTags"</span>
              <span class="pi">]</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="s2">"</span><span class="s">arn:aws:ec2:*:*:subnet/*"</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span>
              <span class="pi">[</span>
                <span class="s2">"</span><span class="s">ec2:DescribeSubnets"</span><span class="pi">,</span>
                <span class="s2">"</span><span class="s">ec2:DescribeTags"</span>
              <span class="pi">]</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="s2">"</span><span class="s">*"</span>

  <span class="na">RegisterSubnetTags</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::Lambda::Function"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Handler</span><span class="pi">:</span> <span class="s2">"</span><span class="s">index.handler"</span>
      <span class="na">Role</span><span class="pi">:</span>
        <span class="s">Fn::GetAtt:</span>
        <span class="s">- "RegisterSubnetTagsLambdaIamRole"</span>
        <span class="s">- "Arn"</span>
      <span class="na">Code</span><span class="pi">:</span>
        <span class="na">ZipFile</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">import json</span>
          <span class="s">import boto3</span>
          <span class="s">import cfnresponse</span>
          <span class="s">def handler(event, context):</span>
            <span class="s">ec2_client = boto3.client('ec2')</span>
            <span class="s">if event['RequestType'] == 'Delete':</span>
              <span class="s">for subnet_id in event['ResourceProperties']['Subnets']:</span>
                <span class="s">ec2_client.delete_tags(Resources=[subnet_id], Tags=[{'Key': 'kubernetes.io/cluster/' + event['ResourceProperties']['InfrastructureName']}]);</span>
            <span class="s">elif event['RequestType'] == 'Create':</span>
              <span class="s">for subnet_id in event['ResourceProperties']['Subnets']:</span>
                <span class="s">ec2_client.create_tags(Resources=[subnet_id], Tags=[{'Key': 'kubernetes.io/cluster/' + event['ResourceProperties']['InfrastructureName'], 'Value': 'shared'}]);</span>
            <span class="s">responseData = {}</span>
            <span class="s">cfnresponse.send(event, context, cfnresponse.SUCCESS, responseData, event['ResourceProperties']['InfrastructureName']+event['ResourceProperties']['Subnets'][0])</span>
      <span class="na">Runtime</span><span class="pi">:</span> <span class="s2">"</span><span class="s">python3.7"</span>
      <span class="na">Timeout</span><span class="pi">:</span> <span class="m">120</span>

  <span class="na">RegisterPublicSubnetTags</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::SubnetRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">RegisterSubnetTags.Arn</span>
      <span class="na">InfrastructureName</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InfrastructureName</span>
      <span class="na">Subnets</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PublicSubnets</span>

  <span class="na">RegisterPrivateSubnetTags</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::SubnetRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">RegisterSubnetTags.Arn</span>
      <span class="na">InfrastructureName</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InfrastructureName</span>
      <span class="na">Subnets</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PrivateSubnets</span>

<span class="na">Outputs</span><span class="pi">:</span>
  <span class="na">PrivateHostedZoneId</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Hosted zone ID for the private DNS, which is required for private records.</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">IntDns</span>
  <span class="na">ExternalApiLoadBalancerName</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Full name of the External API load balancer created.</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">ExtApiElb.LoadBalancerFullName</span>
  <span class="na">InternalApiLoadBalancerName</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Full name of the Internal API load balancer created.</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">IntApiElb.LoadBalancerFullName</span>
  <span class="na">ApiServerDnsName</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Full hostname of the API server, which is required for the Ignition config files.</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">."</span><span class="pi">,</span> <span class="pi">[</span><span class="s2">"</span><span class="s">api-int"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">ClusterName</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">HostedZoneName</span><span class="pi">]]</span>
  <span class="na">RegisterNlbIpTargetsLambda</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Lambda ARN useful to help register or deregister IP targets for these load balancers.</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">RegisterNlbIpTargets.Arn</span>
  <span class="na">ExternalApiTargetGroupArn</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">ARN of External API target group.</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">ExternalApiTargetGroup</span>
  <span class="na">InternalApiTargetGroupArn</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">ARN of Internal API target group.</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternalApiTargetGroup</span>
  <span class="na">InternalServiceTargetGroupArn</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">ARN of internal service target group.</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternalServiceTargetGroup</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-creating-aws-security_installing-aws-user-infra"><a class="anchor" href="#installation-creating-aws-security_installing-aws-user-infra"></a>Creating security group and roles in AWS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You must create security groups and roles in Amazon Web Services (AWS) for your
OpenShift Container Platform cluster to use. The easiest way to create these components is
to modify the provided CloudFormation template.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not use the provided CloudFormation template to create your AWS
infrastructure, you must review the provided information and manually create
the infrastructure. If your cluster does not initialize correctly, you might
have to contact Red Hat support with your installation logs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Configure an AWS account.</p>
</li>
<li>
<p>Generate the Ignition config files for your cluster.</p>
</li>
<li>
<p>Create and configure a VPC and associated subnets in AWS.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a JSON file that contains the parameter values that the template
requires:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="json"><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"InfrastructureName"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="1"></i><b>(1)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mycluster-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="2"></i><b>(2)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VpcCidr"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="3"></i><b>(3)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.0.0.0/16"</span><span class="w"> <i class="conum" data-value="4"></i><b>(4)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PrivateSubnets"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="5"></i><b>(5)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subnet-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="6"></i><b>(6)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VpcId"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="7"></i><b>(7)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vpc-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="8"></i><b>(8)</b>
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The name for your cluster infrastructure that is encoded in your Ignition
config files for the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Specify the infrastructure name that you extracted from the Ignition config
file metadata, which has the format <code>&lt;cluster-name&gt;-&lt;random-string&gt;</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The CIDR block for the VPC.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Specify the CIDR block parameter that you used for the VPC that you defined
in the form <code>x.x.x.x/16-24</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The private subnets that you created for your VPC.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Specify the <code>PrivateSubnetIds</code> value from the output of the CloudFormation
template for the VPC.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The VPC that you created for the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Specify the <code>VpcId</code> value from the output of the CloudFormation template for
the VPC.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Copy the template from the <strong>CloudFormation template for security objects</strong>
section of this topic and save it as a YAML file on your computer. This template
describes the security groups and roles that your cluster requires.</p>
</li>
<li>
<p>Launch the template:</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must enter the command on a single line.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws cloudformation create-stack --stack-name &lt;name&gt; <i class="conum" data-value="1"></i><b>(1)</b>
     --template-body file://&lt;template&gt;.yaml <i class="conum" data-value="2"></i><b>(2)</b>
     --parameters file://&lt;parameters&gt;.json <i class="conum" data-value="3"></i><b>(3)</b>
     --capabilities CAPABILITY_NAMED_IAM</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>&lt;name&gt;</code> is the name for the CloudFormation stack, such as <code>cluster-sec</code>.
You need the name of this stack if you remove the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>&lt;template&gt;</code> is the relative path to and name of the CloudFormation template
YAML file that you saved.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>&lt;parameters&gt;</code> is the relative path to and name of the CloudFormation
parameters JSON file.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Confirm that the template components exist:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws cloudformation describe-stacks --stack-name &lt;name&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>After the <code>StackStatus</code> displays <code>CREATE_COMPLETE</code>, the output displays values
for the following parameters. You must provide these parameter values to
the other CloudFormation templates that you run to create your cluster:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>MasterSecurityGroupId</code>
</td>
<td class="hdlist2">
<p>Master Security Group ID</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>WorkerSecurityGroupId</code>
</td>
<td class="hdlist2">
<p>Worker Security Group ID</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MasterInstanceProfile</code>
</td>
<td class="hdlist2">
<p>Master IAM Instance Profile</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>WorkerInstanceProfile</code>
</td>
<td class="hdlist2">
<p>Worker IAM Instance Profile</p>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="installation-cloudformation-security_installing-aws-user-infra"><a class="anchor" href="#installation-cloudformation-security_installing-aws-user-infra"></a>CloudFormation template for security objects</h3>
<div class="paragraph">
<p>You can use the following CloudFormation template to deploy the security objects
that you need for your OpenShift Container Platform cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">AWSTemplateFormatVersion</span><span class="pi">:</span> <span class="s">2010-09-09</span>
<span class="na">Description</span><span class="pi">:</span> <span class="s">Template for OpenShift Cluster Security Elements (Security Groups &amp; IAM)</span>

<span class="na">Parameters</span><span class="pi">:</span>
  <span class="na">InfrastructureName</span><span class="pi">:</span>
    <span class="na">AllowedPattern</span><span class="pi">:</span> <span class="s">^([a-zA-Z][a-zA-Z0-9\-]{0,26})$</span>
    <span class="na">MaxLength</span><span class="pi">:</span> <span class="m">27</span>
    <span class="na">MinLength</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">ConstraintDescription</span><span class="pi">:</span> <span class="s">Infrastructure name must be alphanumeric, start with a letter, and have a maximum of 27 characters.</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">A short, unique cluster ID used to tag cloud resources and identify items owned or used by the cluster.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">VpcCidr</span><span class="pi">:</span>
    <span class="na">AllowedPattern</span><span class="pi">:</span> <span class="s">^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/(1[6-9]|2[0-4]))$</span>
    <span class="na">ConstraintDescription</span><span class="pi">:</span> <span class="s">CIDR block parameter must be in the form x.x.x.x/16-24.</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s">10.0.0.0/16</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">CIDR block for VPC.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">VpcId</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The VPC-scoped resources will belong to this VPC.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::VPC::Id</span>
  <span class="na">PrivateSubnets</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The internal subnets.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">List&lt;AWS::EC2::Subnet::Id&gt;</span>

<span class="na">Metadata</span><span class="pi">:</span>
  <span class="s">AWS::CloudFormation::Interface:</span>
    <span class="s">ParameterGroups</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Cluster</span><span class="nv"> </span><span class="s">Information"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">InfrastructureName</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Network</span><span class="nv"> </span><span class="s">Configuration"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">VpcId</span>
      <span class="pi">-</span> <span class="s">VpcCidr</span>
      <span class="pi">-</span> <span class="s">PrivateSubnets</span>
    <span class="na">ParameterLabels</span><span class="pi">:</span>
      <span class="na">InfrastructureName</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Infrastructure</span><span class="nv"> </span><span class="s">Name"</span>
      <span class="na">VpcId</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">VPC</span><span class="nv"> </span><span class="s">ID"</span>
      <span class="na">VpcCidr</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">VPC</span><span class="nv"> </span><span class="s">CIDR"</span>
      <span class="na">PrivateSubnets</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Private</span><span class="nv"> </span><span class="s">Subnets"</span>

<span class="na">Resources</span><span class="pi">:</span>
  <span class="na">MasterSecurityGroup</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroup</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupDescription</span><span class="pi">:</span> <span class="s">Cluster Master Security Group</span>
      <span class="na">SecurityGroupIngress</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">icmp</span>
        <span class="na">FromPort</span><span class="pi">:</span> <span class="m">0</span>
        <span class="na">ToPort</span><span class="pi">:</span> <span class="m">0</span>
        <span class="na">CidrIp</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VpcCidr</span>
      <span class="pi">-</span> <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>
        <span class="na">FromPort</span><span class="pi">:</span> <span class="m">22</span>
        <span class="na">ToPort</span><span class="pi">:</span> <span class="m">22</span>
        <span class="na">CidrIp</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VpcCidr</span>
      <span class="pi">-</span> <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>
        <span class="na">ToPort</span><span class="pi">:</span> <span class="m">6443</span>
        <span class="na">FromPort</span><span class="pi">:</span> <span class="m">6443</span>
        <span class="na">CidrIp</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VpcCidr</span>
      <span class="pi">-</span> <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>
        <span class="na">FromPort</span><span class="pi">:</span> <span class="m">22623</span>
        <span class="na">ToPort</span><span class="pi">:</span> <span class="m">22623</span>
        <span class="na">CidrIp</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VpcCidr</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VpcId</span>

  <span class="na">WorkerSecurityGroup</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroup</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupDescription</span><span class="pi">:</span> <span class="s">Cluster Worker Security Group</span>
      <span class="na">SecurityGroupIngress</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">icmp</span>
        <span class="na">FromPort</span><span class="pi">:</span> <span class="m">0</span>
        <span class="na">ToPort</span><span class="pi">:</span> <span class="m">0</span>
        <span class="na">CidrIp</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VpcCidr</span>
      <span class="pi">-</span> <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>
        <span class="na">FromPort</span><span class="pi">:</span> <span class="m">22</span>
        <span class="na">ToPort</span><span class="pi">:</span> <span class="m">22</span>
        <span class="na">CidrIp</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VpcCidr</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VpcId</span>

  <span class="na">MasterIngressEtcd</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">etcd</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">2379</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">2380</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>

  <span class="na">MasterIngressVxlan</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Vxlan packets</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">4789</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">4789</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">udp</span>

  <span class="na">MasterIngressWorkerVxlan</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Vxlan packets</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">4789</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">4789</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">udp</span>

  <span class="na">MasterIngressInternal</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Internal cluster communication</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">9000</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">9999</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>

  <span class="na">MasterIngressWorkerInternal</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Internal cluster communication</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">9000</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">9999</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>

  <span class="na">MasterIngressKube</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Kubernetes kubelet, scheduler and controller manager</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">10250</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">10259</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>

  <span class="na">MasterIngressWorkerKube</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Kubernetes kubelet, scheduler and controller manager</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">10250</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">10259</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>

  <span class="na">MasterIngressIngressServices</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Kubernetes ingress services</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">30000</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">32767</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>

  <span class="na">MasterIngressWorkerIngressServices</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Kubernetes ingress services</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">30000</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">32767</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>

  <span class="na">WorkerIngressVxlan</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Vxlan packets</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">4789</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">4789</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">udp</span>

  <span class="na">WorkerIngressWorkerVxlan</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Vxlan packets</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">4789</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">4789</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">udp</span>

  <span class="na">WorkerIngressInternal</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Internal cluster communication</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">9000</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">9999</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>

  <span class="na">WorkerIngressWorkerInternal</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Internal cluster communication</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">9000</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">9999</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>

  <span class="na">WorkerIngressKube</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Kubernetes secure kubelet port</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">10250</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">10250</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>

  <span class="na">WorkerIngressWorkerKube</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Internal Kubernetes communication</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">10250</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">10250</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>

  <span class="na">WorkerIngressIngressServices</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Kubernetes ingress services</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">30000</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">32767</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>

  <span class="na">WorkerIngressWorkerIngressServices</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroupIngress</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>
      <span class="na">SourceSecurityGroupId</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s">Kubernetes ingress services</span>
      <span class="na">FromPort</span><span class="pi">:</span> <span class="m">30000</span>
      <span class="na">ToPort</span><span class="pi">:</span> <span class="m">32767</span>
      <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>

  <span class="na">MasterIamRole</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::IAM::Role</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">AssumeRolePolicyDocument</span><span class="pi">:</span>
        <span class="na">Version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2012-10-17"</span>
        <span class="na">Statement</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
          <span class="na">Principal</span><span class="pi">:</span>
            <span class="na">Service</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s2">"</span><span class="s">ec2.amazonaws.com"</span>
          <span class="na">Action</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s2">"</span><span class="s">sts:AssumeRole"</span>
      <span class="na">Policies</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">PolicyName</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-"</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">,</span> <span class="s2">"</span><span class="s">master"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">policy"</span><span class="pi">]]</span>
        <span class="na">PolicyDocument</span><span class="pi">:</span>
          <span class="na">Version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2012-10-17"</span>
          <span class="na">Statement</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span> <span class="s2">"</span><span class="s">ec2:*"</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="s2">"</span><span class="s">*"</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span> <span class="s2">"</span><span class="s">elasticloadbalancing:*"</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="s2">"</span><span class="s">*"</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span> <span class="s2">"</span><span class="s">iam:PassRole"</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="s2">"</span><span class="s">*"</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span> <span class="s2">"</span><span class="s">s3:GetObject"</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="s2">"</span><span class="s">*"</span>

  <span class="na">MasterInstanceProfile</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::IAM::InstanceProfile"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Roles</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Ref</span><span class="pi">:</span> <span class="s2">"</span><span class="s">MasterIamRole"</span>

  <span class="na">WorkerIamRole</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::IAM::Role</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">AssumeRolePolicyDocument</span><span class="pi">:</span>
        <span class="na">Version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2012-10-17"</span>
        <span class="na">Statement</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
          <span class="na">Principal</span><span class="pi">:</span>
            <span class="na">Service</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s2">"</span><span class="s">ec2.amazonaws.com"</span>
          <span class="na">Action</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s2">"</span><span class="s">sts:AssumeRole"</span>
      <span class="na">Policies</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">PolicyName</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-"</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">,</span> <span class="s2">"</span><span class="s">worker"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">policy"</span><span class="pi">]]</span>
        <span class="na">PolicyDocument</span><span class="pi">:</span>
          <span class="na">Version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2012-10-17"</span>
          <span class="na">Statement</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span> <span class="s2">"</span><span class="s">ec2:Describe*"</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="s2">"</span><span class="s">*"</span>

  <span class="na">WorkerInstanceProfile</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::IAM::InstanceProfile"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Roles</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Ref</span><span class="pi">:</span> <span class="s2">"</span><span class="s">WorkerIamRole"</span>

<span class="na">Outputs</span><span class="pi">:</span>
  <span class="na">MasterSecurityGroupId</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Master Security Group ID</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">MasterSecurityGroup.GroupId</span>

  <span class="na">WorkerSecurityGroupId</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Worker Security Group ID</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WorkerSecurityGroup.GroupId</span>

  <span class="na">MasterInstanceProfile</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Master IAM Instance Profile</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">MasterInstanceProfile</span>

  <span class="na">WorkerInstanceProfile</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Worker IAM Instance Profile</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">WorkerInstanceProfile</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-aws-user-infra-rhcos-ami_installing-aws-user-infra"><a class="anchor" href="#installation-aws-user-infra-rhcos-ami_installing-aws-user-infra"></a>RHCOS AMIs for the AWS infrastructure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You must use a valid Red Hat Enterprise Linux CoreOS (RHCOS) AMI for your Amazon Web Services
(AWS) zone for your OpenShift Container Platform nodes.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. RHCOS AMIs</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">AWS zone</th>
<th class="tableblock halign-left valign-top">AWS AMI</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ap-northeast-1</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-0c63b39219b8123e5</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ap-northeast-2</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-073cba0913d2250a4</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ap-south-1</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-0270be11430101040</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ap-southeast-1</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-06eb9d35ede4f08a3</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ap-southeast-2</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-0d980796ce258b5d5</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ca-central-1</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-0f907257d1686e3f7</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>eu-central-1</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-02fdd627029c0055b</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>eu-west-1</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-0d4839574724ed3fa</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>eu-west-2</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-053073b95aa285347</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>eu-west-3</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-09deb5deb6567bcd5</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>sa-east-1</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-068a2000546e1889d</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>us-east-1</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-046fe691f52a953f9</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>us-east-2</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-0649fd5d42859bdfc</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>us-west-1</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-0c1d2b5606111ac8c</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>us-west-2</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ami-00745fcbb14a863ed</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="installation-creating-aws-bootstrap_installing-aws-user-infra"><a class="anchor" href="#installation-creating-aws-bootstrap_installing-aws-user-infra"></a>Creating the bootstrap node in AWS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You must create the bootstrap node in Amazon Web Services (AWS) to use during
OpenShift Container Platform cluster initialization. The easiest way to create this node is
to modify the provided CloudFormation template.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not use the provided CloudFormation template to create your bootstrap
node, you must review the provided information and manually create
the infrastructure. If your cluster does not initialize correctly, you might
have to contact Red Hat support with your installation logs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Configure an AWS account.</p>
</li>
<li>
<p>Generate the Ignition config files for your cluster.</p>
</li>
<li>
<p>Create and configure a VPC and assocated subnets in AWS.</p>
</li>
<li>
<p>Create and configure DNS, load balancers, and listeners in AWS.</p>
</li>
<li>
<p>Create control plane and compute roles.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Provide a location to serve the <code>bootstrap.ign</code> Ignition config file to your
cluster. This file is located in your installation directory. One way to do this
is to create an S3 bucket in your cluster&#8217;s region and upload the Ignition
config file to it.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The provided CloudFormation Template assumes that the
Ignition config files for your cluster are served from an S3 bucket. If you
choose to serve the files from another location, you must modify the templates.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The bootstrap Ignition config file does contain secrets, like X.509 keys. The
following steps provide basic security for the S3 bucket. To provide additional
security, you can enable an S3 bucket policy to allow only certain users, such
as the OpenShift IAM user, to access objects that the bucket contains. You
can avoid S3 entirely and serve your bootstrap Ignition config file from any
address that the bootstrap machine can reach.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Create the bucket:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws s3 mb s3://&lt;cluster-name&gt;-infra <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>&lt;cluster-name&gt;-infra</code> is the bucket name.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Upload the <code>bootstrap.ign</code> Ignition config file to the bucket:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws s3 cp bootstrap.ign s3://&lt;cluster-name&gt;-infra/bootstrap.ign</pre>
</div>
</div>
</li>
<li>
<p>Verify that the file uploaded:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws s3 ls s3://&lt;cluster-name&gt;-infra/

2019-04-03 16:15:16     314878 bootstrap.ign</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Create a JSON file that contains the parameter values that the template
requires:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="json"><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"InfrastructureName"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="1"></i><b>(1)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mycluster-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="2"></i><b>(2)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RhcosAmi"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="3"></i><b>(3)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ami-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="4"></i><b>(4)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AllowedBootstrapSshCidr"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="5"></i><b>(5)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0.0.0/0"</span><span class="w"> <i class="conum" data-value="6"></i><b>(6)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PublicSubnet"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="7"></i><b>(7)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subnet-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="8"></i><b>(8)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MasterSecurityGroupId"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="9"></i><b>(9)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sg-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="10"></i><b>(10)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VpcId"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="11"></i><b>(11)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vpc-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="12"></i><b>(12)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BootstrapIgnitionLocation"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="13"></i><b>(13)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3://&lt;bucket_name&gt;/bootstrap.ign"</span><span class="w"> <i class="conum" data-value="14"></i><b>(14)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AutoRegisterELB"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="15"></i><b>(15)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="w"> <i class="conum" data-value="16"></i><b>(16)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RegisterNlbIpTargetsLambdaArn"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="17"></i><b>(17)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:lambda:&lt;region&gt;:&lt;account_number&gt;:function:&lt;dns_stack_name&gt;-RegisterNlbIpTargets-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="18"></i><b>(18)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ExternalApiTargetGroupArn"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="19"></i><b>(19)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:elasticloadbalancing:&lt;region&gt;:&lt;account_number&gt;:targetgroup/&lt;dns_stack_name&gt;-Exter-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="20"></i><b>(20)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"InternalApiTargetGroupArn"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="21"></i><b>(21)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:elasticloadbalancing:&lt;region&gt;:&lt;account_number&gt;:targetgroup/&lt;dns_stack_name&gt;-Inter-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="22"></i><b>(22)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"InternalServiceTargetGroupArn"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="23"></i><b>(23)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:elasticloadbalancing:&lt;region&gt;:&lt;account_number&gt;:targetgroup/&lt;dns_stack_name&gt;-Inter-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="24"></i><b>(24)</b>
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The name for your cluster infrastructure that is encoded in your Ignition
config files for the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Specify the infrastructure name that you extracted from the Ignition config
file metadata, which has the format <code>&lt;cluster-name&gt;-&lt;random-string&gt;</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Current Red Hat Enterprise Linux CoreOS (RHCOS) AMI to use for the bootstrap node.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Specify a valid <code>AWS::EC2::Image::Id</code> value.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>CIDR block to allow SSH access to the bootstrap node.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Specify a CIDR block in the format <code>x.x.x.x/16-24</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The public subnet that is associated with your VPC to launch the bootstrap
node into.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Specify the <code>PublicSubnetIds</code> value from the output of the CloudFormation
template for the VPC.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>The master security group ID (for registering temporary rules)</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Specify the <code>MasterSecurityGroupId</code> value from the output of the
CloudFormation template for the security group and roles.</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>The VPC created resources will belong to.</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>Specify the <code>VpcId</code> value from the output of the CloudFormation template
for the VPC.</td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>Location to fetch bootstrap Ignition config file from.</td>
</tr>
<tr>
<td><i class="conum" data-value="14"></i><b>14</b></td>
<td>Specify the S3 bucket and file name in the form
<code>s3://&lt;bucket_name&gt;/bootstrap.ign</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="15"></i><b>15</b></td>
<td>Whether or not to register a network load balancer (NLB).</td>
</tr>
<tr>
<td><i class="conum" data-value="16"></i><b>16</b></td>
<td>Specify <code>yes</code> or <code>no</code>. If you specify <code>yes</code>, you must provide a Lambda
Amazon Resource Name (ARN) value.</td>
</tr>
<tr>
<td><i class="conum" data-value="17"></i><b>17</b></td>
<td>The ARN for NLB IP target registration lambda group.</td>
</tr>
<tr>
<td><i class="conum" data-value="18"></i><b>18</b></td>
<td>Specify the <code>RegisterNlbIpTargetsLambda</code> value from the output of the
CloudFormation template for DNS and load balancing.</td>
</tr>
<tr>
<td><i class="conum" data-value="19"></i><b>19</b></td>
<td>The ARN for external API load balancer target group.</td>
</tr>
<tr>
<td><i class="conum" data-value="20"></i><b>20</b></td>
<td>Specify the <code>ExternalApiTargetGroupArn</code> value from the output of the
CloudFormation template for DNS and load balancing.</td>
</tr>
<tr>
<td><i class="conum" data-value="21"></i><b>21</b></td>
<td>The ARN for internal API load balancer target group.</td>
</tr>
<tr>
<td><i class="conum" data-value="22"></i><b>22</b></td>
<td>Specify the <code>InternalApiTargetGroupArn</code> value from the output of the
CloudFormation template for DNS and load balancing.</td>
</tr>
<tr>
<td><i class="conum" data-value="23"></i><b>23</b></td>
<td>The ARN for internal service load balancer target group.</td>
</tr>
<tr>
<td><i class="conum" data-value="24"></i><b>24</b></td>
<td>Specify the <code>InternalServiceTargetGroupArn</code> value from the output of the
CloudFormation template for DNS and load balancing.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Copy the template from the <strong>CloudFormation template for the bootstrap machine</strong>
section of this topic and save it as a YAML file on your computer. This template
describes the bootstrap machine that your cluster requires.</p>
</li>
<li>
<p>Launch the template:</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must enter the command on a single line.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws cloudformation create-stack --stack-name &lt;name&gt; <i class="conum" data-value="1"></i><b>(1)</b>
     --template-body file://&lt;template&gt;.yaml <i class="conum" data-value="2"></i><b>(2)</b>
     --parameters file://&lt;parameters&gt;.json <i class="conum" data-value="3"></i><b>(3)</b>
     --capabilities CAPABILITY_NAMED_IAM</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>&lt;name&gt;</code> is the name for the CloudFormation stack, such as <code>cluster-bootstrap</code>.
You need the name of this stack if you remove the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>&lt;template&gt;</code> is the relative path to and name of the CloudFormation template
YAML file that you saved.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>&lt;parameters&gt;</code> is the relative path to and name of the CloudFormation
parameters JSON file.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Confirm that the template components exist:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws cloudformation describe-stacks --stack-name &lt;name&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>After the <code>StackStatus</code> displays <code>CREATE_COMPLETE</code>, the output displays values
for the following parameters. You must provide these parameter values to
the other CloudFormation templates that you run to create your cluster:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>BootstrapInstanceId</code>
</td>
<td class="hdlist2">
<p>The bootstrap Instance ID.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>BootstrapPublicIp</code>
</td>
<td class="hdlist2">
<p>The bootstrap node public IP address.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>BootstrapPrivateIp</code>
</td>
<td class="hdlist2">
<p>The bootstrap node private IP address.</p>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="installation-cloudformation-bootstrap_installing-aws-user-infra"><a class="anchor" href="#installation-cloudformation-bootstrap_installing-aws-user-infra"></a>CloudFormation template for the bootstrap machine</h3>
<div class="paragraph">
<p>You can use the following CloudFormation template to deploy the bootstrap
machine that you need for your OpenShift Container Platform cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">AWSTemplateFormatVersion</span><span class="pi">:</span> <span class="s">2010-09-09</span>
<span class="na">Description</span><span class="pi">:</span> <span class="s">Template for OpenShift Cluster Bootstrap (EC2 Instance, Security Groups and IAM)</span>

<span class="na">Parameters</span><span class="pi">:</span>
  <span class="na">InfrastructureName</span><span class="pi">:</span>
    <span class="na">AllowedPattern</span><span class="pi">:</span> <span class="s">^([a-zA-Z][a-zA-Z0-9\-]{0,26})$</span>
    <span class="na">MaxLength</span><span class="pi">:</span> <span class="m">27</span>
    <span class="na">MinLength</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">ConstraintDescription</span><span class="pi">:</span> <span class="s">Infrastructure name must be alphanumeric, start with a letter, and have a maximum of 27 characters.</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">A short, unique cluster ID used to tag cloud resources and identify items owned or used by the cluster.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">RhcosAmi</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Current Red Hat Enterprise Linux CoreOS AMI to use for bootstrap.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Image::Id</span>
  <span class="na">AllowedBootstrapSshCidr</span><span class="pi">:</span>
    <span class="na">AllowedPattern</span><span class="pi">:</span> <span class="s">^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/([0-9]|1[0-9]|2[0-9]|3[0-2]))$</span>
    <span class="na">ConstraintDescription</span><span class="pi">:</span> <span class="s">CIDR block parameter must be in the form x.x.x.x/0-32.</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s">0.0.0.0/0</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">CIDR block to allow SSH access to the bootstrap node.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">PublicSubnet</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The public subnet to launch the bootstrap node into.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Subnet::Id</span>
  <span class="na">MasterSecurityGroupId</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The master security group ID for registering temporary rules.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroup::Id</span>
  <span class="na">VpcId</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The VPC-scoped resources will belong to this VPC.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::VPC::Id</span>
  <span class="na">BootstrapIgnitionLocation</span><span class="pi">:</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s">s3://my-s3-bucket/bootstrap.ign</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Ignition config file location.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">AutoRegisterELB</span><span class="pi">:</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">yes"</span>
    <span class="na">AllowedValues</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">yes"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">no"</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Do you want to invoke NLB registration, which requires a Lambda ARN parameter?</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">RegisterNlbIpTargetsLambdaArn</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">ARN for NLB IP target registration lambda.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">ExternalApiTargetGroupArn</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">ARN for external API load balancer target group.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">InternalApiTargetGroupArn</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">ARN for internal API load balancer target group.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">InternalServiceTargetGroupArn</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">ARN for internal service load balancer target group.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>

<span class="na">Metadata</span><span class="pi">:</span>
  <span class="s">AWS::CloudFormation::Interface:</span>
    <span class="s">ParameterGroups</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Cluster</span><span class="nv"> </span><span class="s">Information"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">InfrastructureName</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Host</span><span class="nv"> </span><span class="s">Information"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">RhcosAmi</span>
      <span class="pi">-</span> <span class="s">BootstrapIgnitionLocation</span>
      <span class="pi">-</span> <span class="s">MasterSecurityGroupId</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Network</span><span class="nv"> </span><span class="s">Configuration"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">VpcId</span>
      <span class="pi">-</span> <span class="s">AllowedBootstrapSshCidr</span>
      <span class="pi">-</span> <span class="s">PublicSubnet</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Load</span><span class="nv"> </span><span class="s">Balancer</span><span class="nv"> </span><span class="s">Automation"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">AutoRegisterELB</span>
      <span class="pi">-</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="pi">-</span> <span class="s">ExternalApiTargetGroupArn</span>
      <span class="pi">-</span> <span class="s">InternalApiTargetGroupArn</span>
      <span class="pi">-</span> <span class="s">InternalServiceTargetGroupArn</span>
    <span class="na">ParameterLabels</span><span class="pi">:</span>
      <span class="na">InfrastructureName</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Infrastructure</span><span class="nv"> </span><span class="s">Name"</span>
      <span class="na">VpcId</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">VPC</span><span class="nv"> </span><span class="s">ID"</span>
      <span class="na">AllowedBootstrapSshCidr</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allowed</span><span class="nv"> </span><span class="s">SSH</span><span class="nv"> </span><span class="s">Source"</span>
      <span class="na">PublicSubnet</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Public</span><span class="nv"> </span><span class="s">Subnet"</span>
      <span class="na">RhcosAmi</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Red</span><span class="nv"> </span><span class="s">Hat</span><span class="nv"> </span><span class="s">Enterprise</span><span class="nv"> </span><span class="s">Linux</span><span class="nv"> </span><span class="s">CoreOS</span><span class="nv"> </span><span class="s">AMI</span><span class="nv"> </span><span class="s">ID"</span>
      <span class="na">BootstrapIgnitionLocation</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Bootstrap</span><span class="nv"> </span><span class="s">Ignition</span><span class="nv"> </span><span class="s">Source"</span>
      <span class="na">MasterSecurityGroupId</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Master</span><span class="nv"> </span><span class="s">Security</span><span class="nv"> </span><span class="s">Group</span><span class="nv"> </span><span class="s">ID"</span>
      <span class="na">AutoRegisterELB</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Use</span><span class="nv"> </span><span class="s">Provided</span><span class="nv"> </span><span class="s">ELB</span><span class="nv"> </span><span class="s">Automation"</span>

<span class="na">Conditions</span><span class="pi">:</span>
  <span class="na">DoRegistration</span><span class="pi">:</span> <span class="kt">!Equals</span> <span class="pi">[</span><span class="s2">"</span><span class="s">yes"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">AutoRegisterELB</span><span class="pi">]</span>

<span class="na">Resources</span><span class="pi">:</span>
  <span class="na">BootstrapIamRole</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::IAM::Role</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">AssumeRolePolicyDocument</span><span class="pi">:</span>
        <span class="na">Version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2012-10-17"</span>
        <span class="na">Statement</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
          <span class="na">Principal</span><span class="pi">:</span>
            <span class="na">Service</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s2">"</span><span class="s">ec2.amazonaws.com"</span>
          <span class="na">Action</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s2">"</span><span class="s">sts:AssumeRole"</span>
      <span class="na">Path</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/"</span>
      <span class="na">Policies</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">PolicyName</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">-"</span><span class="pi">,</span> <span class="pi">[</span><span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">,</span> <span class="s2">"</span><span class="s">bootstrap"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">policy"</span><span class="pi">]]</span>
        <span class="na">PolicyDocument</span><span class="pi">:</span>
          <span class="na">Version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2012-10-17"</span>
          <span class="na">Statement</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span> <span class="s2">"</span><span class="s">ec2:Describe*"</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="s2">"</span><span class="s">*"</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span> <span class="s2">"</span><span class="s">ec2:AttachVolume"</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="s2">"</span><span class="s">*"</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span> <span class="s2">"</span><span class="s">ec2:DetachVolume"</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="s2">"</span><span class="s">*"</span>
          <span class="pi">-</span> <span class="na">Effect</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Allow"</span>
            <span class="na">Action</span><span class="pi">:</span> <span class="s2">"</span><span class="s">s3:GetObject"</span>
            <span class="na">Resource</span><span class="pi">:</span> <span class="s2">"</span><span class="s">*"</span>

  <span class="na">BootstrapInstanceProfile</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">AWS::IAM::InstanceProfile"</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Path</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/"</span>
      <span class="na">Roles</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Ref</span><span class="pi">:</span> <span class="s2">"</span><span class="s">BootstrapIamRole"</span>

  <span class="na">BootstrapSecurityGroup</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroup</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupDescription</span><span class="pi">:</span> <span class="s">Cluster Bootstrap Security Group</span>
      <span class="na">SecurityGroupIngress</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>
        <span class="na">FromPort</span><span class="pi">:</span> <span class="m">22</span>
        <span class="na">ToPort</span><span class="pi">:</span> <span class="m">22</span>
        <span class="na">CidrIp</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">AllowedBootstrapSshCidr</span>
      <span class="pi">-</span> <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>
        <span class="na">ToPort</span><span class="pi">:</span> <span class="m">19531</span>
        <span class="na">FromPort</span><span class="pi">:</span> <span class="m">19531</span>
        <span class="na">CidrIp</span><span class="pi">:</span> <span class="s">0.0.0.0/0</span>
      <span class="na">VpcId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">VpcId</span>

  <span class="na">BootstrapInstance</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Instance</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ImageId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RhcosAmi</span>
      <span class="na">IamInstanceProfile</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">BootstrapInstanceProfile</span>
      <span class="na">InstanceType</span><span class="pi">:</span> <span class="s2">"</span><span class="s">i3.large"</span>
      <span class="na">NetworkInterfaces</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">AssociatePublicIpAddress</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
        <span class="na">DeviceIndex</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0"</span>
        <span class="na">GroupSet</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">BootstrapSecurityGroup"</span>
        <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">MasterSecurityGroupId"</span>
        <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">PublicSubnet"</span>
      <span class="na">UserData</span><span class="pi">:</span>
        <span class="s">Fn::Base64: !Sub</span>
        <span class="s">- '{"ignition":{"config":{"replace":{"source":"${S3Loc}","verification":{}}},"timeouts":{},"version":"2.1.0"},"networkd":{},"passwd":{},"storage":{},"systemd":{}}'</span>
        <span class="s">- {</span>
          <span class="s">S3Loc</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">BootstrapIgnitionLocation</span>
        <span class="err">}</span>

  <span class="na">RegisterBootstrapApiTarget</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoRegistration</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::NLBRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="na">TargetArn</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">ExternalApiTargetGroupArn</span>
      <span class="na">TargetIp</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">BootstrapInstance.PrivateIp</span>

  <span class="na">RegisterBootstrapInternalApiTarget</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoRegistration</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::NLBRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="na">TargetArn</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternalApiTargetGroupArn</span>
      <span class="na">TargetIp</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">BootstrapInstance.PrivateIp</span>

  <span class="na">RegisterBootstrapInternalServiceTarget</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoRegistration</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::NLBRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="na">TargetArn</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternalServiceTargetGroupArn</span>
      <span class="na">TargetIp</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">BootstrapInstance.PrivateIp</span>

<span class="na">Outputs</span><span class="pi">:</span>
  <span class="na">BootstrapInstanceId</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Bootstrap Instance ID.</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">BootstrapInstance</span>

  <span class="na">BootstrapPublicIp</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The bootstrap node public IP address.</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">BootstrapInstance.PublicIp</span>

  <span class="na">BootstrapPrivateIp</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The bootstrap node private IP address.</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">BootstrapInstance.PrivateIp</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-creating-aws-control-plane_installing-aws-user-infra"><a class="anchor" href="#installation-creating-aws-control-plane_installing-aws-user-infra"></a>Creating the control plane machines in AWS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You must create the control plane machines in Amazon Web Services (AWS) for your
cluster to use. The easiest way to create these nodes is
to modify the provided CloudFormation template.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not use the provided CloudFormation template to create your control plane
nodes, you must review the provided information and manually create
the infrastructure. If your cluster does not initialize correctly, you might
have to contact Red Hat support with your installation logs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Configure an AWS account.</p>
</li>
<li>
<p>Generate the Ignition config files for your cluster.</p>
</li>
<li>
<p>Create and configure a VPC and assocated subnets in AWS.</p>
</li>
<li>
<p>Create and configure DNS, load balancers, and listeners in AWS.</p>
</li>
<li>
<p>Create control plane and compute roles.</p>
</li>
<li>
<p>Create the bootstrap machine.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a JSON file that contains the parameter values that the template
requires:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="json"><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"InfrastructureName"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="1"></i><b>(1)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mycluster-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="2"></i><b>(2)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RhcosAmi"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="3"></i><b>(3)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ami-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="4"></i><b>(4)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AutoRegisterDNS"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="5"></i><b>(5)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="w"> <i class="conum" data-value="6"></i><b>(6)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PrivateHostedZoneId"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="7"></i><b>(7)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="8"></i><b>(8)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PrivateHostedZoneName"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="9"></i><b>(9)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mycluster.example.com"</span><span class="w"> <i class="conum" data-value="10"></i><b>(10)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Master0Subnet"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="11"></i><b>(11)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subnet-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="12"></i><b>(12)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Master1Subnet"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="11"></i><b>(11)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subnet-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="12"></i><b>(12)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Master2Subnet"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="11"></i><b>(11)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subnet-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="12"></i><b>(12)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MasterSecurityGroupId"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="13"></i><b>(13)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sg-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="14"></i><b>(14)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IgnitionLocation"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="15"></i><b>(15)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api-int.&lt;cluster_name&gt;.&lt;domain_name&gt;:22623/config/master"</span><span class="w"> <i class="conum" data-value="16"></i><b>(16)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CertificateAuthorities"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="17"></i><b>(17)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"data:text/plain;charset=utf-8;base64,ABC...xYz=="</span><span class="w"> <i class="conum" data-value="18"></i><b>(18)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MasterInstanceProfileName"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="19"></i><b>(19)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;roles_stack&gt;-MasterInstanceProfile-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="20"></i><b>(20)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MasterInstanceType"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="21"></i><b>(21)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"m4.xlarge"</span><span class="w"> <i class="conum" data-value="22"></i><b>(22)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AutoRegisterELB"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="23"></i><b>(23)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yes"</span><span class="w"> <i class="conum" data-value="24"></i><b>(24)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RegisterNlbIpTargetsLambdaArn"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="25"></i><b>(25)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:lambda:&lt;region&gt;:&lt;account_number&gt;:function:&lt;dns_stack_name&gt;-RegisterNlbIpTargets-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="26"></i><b>(26)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ExternalApiTargetGroupArn"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="27"></i><b>(27)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:elasticloadbalancing:&lt;region&gt;:&lt;account_number&gt;:targetgroup/&lt;dns_stack_name&gt;-Exter-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="28"></i><b>(28)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"InternalApiTargetGroupArn"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="29"></i><b>(29)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:elasticloadbalancing:&lt;region&gt;:&lt;account_number&gt;:targetgroup/&lt;dns_stack_name&gt;-Inter-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="30"></i><b>(30)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"InternalServiceTargetGroupArn"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="31"></i><b>(31)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:elasticloadbalancing:&lt;region&gt;:&lt;account_number&gt;:targetgroup/&lt;dns_stack_name&gt;-Inter-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="32"></i><b>(32)</b>
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The name for your cluster infrastructure that is encoded in your Ignition
config files for the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Specify the infrastructure name that you extracted from the Ignition config
file metadata, which has the format <code>&lt;cluster-name&gt;-&lt;random-string&gt;</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>CurrentRed Hat Enterprise Linux CoreOS (RHCOS) AMI to use for the control plane machines.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Specify an <code>AWS::EC2::Image::Id</code> value.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Whether or not to perform DNS etcd registration.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Specify <code>yes</code> or <code>no</code>. If you specify <code>yes</code>, you must provide Hosted Zone
information.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The Route53 private zone ID to register the etcd targets with.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Specify the <code>PrivateHostedZoneId</code> value from the output of the
CloudFormation template for DNS and load balancing.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>The Route53 zone to register the targets with.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Specify <code>&lt;cluster_name&gt;.&lt;domain_name&gt;</code> where <code>&lt;domain_name&gt;</code> is the Route53
base domain that you used when you generated <code>install-config.yaml</code> file for the
cluster. Do not include the trailing period (.) that is
displayed in the AWS console.</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>A subnet, preferably private, to launch the control plane machines on.</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>Specify a subnet from the <code>PrivateSubnets</code> value from the output of the
CloudFormation template for DNS and load balancing.</td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>The master security group ID to associate with master nodes.</td>
</tr>
<tr>
<td><i class="conum" data-value="14"></i><b>14</b></td>
<td>Specify the <code>MasterSecurityGroupId</code> value from the output of the
CloudFormation template for the security group and roles.</td>
</tr>
<tr>
<td><i class="conum" data-value="15"></i><b>15</b></td>
<td>The location to fetch control plane Ignition config file from.</td>
</tr>
<tr>
<td><i class="conum" data-value="16"></i><b>16</b></td>
<td>Specify the generated Ignition config file location,
<code><a href="https://api-int.&lt;cluster_name&gt;.&lt;domain_name&gt;:22623/config/master" class="bare">https://api-int.&lt;cluster_name&gt;.&lt;domain_name&gt;:22623/config/master</a></code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="17"></i><b>17</b></td>
<td>The base64 encoded certificate authority string to use.</td>
</tr>
<tr>
<td><i class="conum" data-value="18"></i><b>18</b></td>
<td>Specify the value from the <code>master.ign</code> file that is in the installation
directory. This value is the long string with the format
<code>data:text/plain;charset=utf-8;base64,ABC&#8230;&#8203;xYz==</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="19"></i><b>19</b></td>
<td>The IAM profile to associate with master nodes.</td>
</tr>
<tr>
<td><i class="conum" data-value="20"></i><b>20</b></td>
<td>Specify the <code>MasterInstanceProfile</code> parameter value from the output of
the CloudFormation template for the security group and roles.</td>
</tr>
<tr>
<td><i class="conum" data-value="21"></i><b>21</b></td>
<td>The type of AWS instance to use for the control plane machines.</td>
</tr>
<tr>
<td><i class="conum" data-value="22"></i><b>22</b></td>
<td>Allowed values:
<div class="ulist">
<ul>
<li>
<p><code>m4.xlarge</code></p>
</li>
<li>
<p><code>m4.2xlarge</code></p>
</li>
<li>
<p><code>m4.4xlarge</code></p>
</li>
<li>
<p><code>m4.8xlarge</code></p>
</li>
<li>
<p><code>m4.10xlarge</code></p>
</li>
<li>
<p><code>m4.16xlarge</code></p>
</li>
<li>
<p><code>c4.2xlarge</code></p>
</li>
<li>
<p><code>c4.4xlarge</code></p>
</li>
<li>
<p><code>c4.8xlarge</code></p>
</li>
<li>
<p><code>r4.xlarge</code></p>
</li>
<li>
<p><code>r4.2xlarge</code></p>
</li>
<li>
<p><code>r4.4xlarge</code></p>
</li>
<li>
<p><code>r4.8xlarge</code></p>
</li>
<li>
<p><code>r4.16xlarge</code></p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If <code>m4</code> instance types are not available in your region, such as with
<code>eu-west-3</code>, specify an <code>m5</code> type, such as <code>m5.xlarge</code>, instead.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="23"></i><b>23</b></td>
<td>Whether or not to register a network load balancer (NLB).</td>
</tr>
<tr>
<td><i class="conum" data-value="24"></i><b>24</b></td>
<td>Specify <code>yes</code> or <code>no</code>. If you specify <code>yes</code>, you must provide a Lambda
Amazon Resource Name (ARN) value.</td>
</tr>
<tr>
<td><i class="conum" data-value="25"></i><b>25</b></td>
<td>The ARN for NLB IP target registration lambda group.</td>
</tr>
<tr>
<td><i class="conum" data-value="26"></i><b>26</b></td>
<td>Specify the <code>RegisterNlbIpTargetsLambda</code> value from the output of the CloudFormation template for DNS
and load balancing.</td>
</tr>
<tr>
<td><i class="conum" data-value="27"></i><b>27</b></td>
<td>The ARN for external API load balancer target group.</td>
</tr>
<tr>
<td><i class="conum" data-value="28"></i><b>28</b></td>
<td>Specify the <code>ExternalApiTargetGroupArn</code> value from the output of the CloudFormation template for DNS
and load balancing.</td>
</tr>
<tr>
<td><i class="conum" data-value="29"></i><b>29</b></td>
<td>The ARN for internal API load balancer target group.</td>
</tr>
<tr>
<td><i class="conum" data-value="30"></i><b>30</b></td>
<td>Specify the <code>InternalApiTargetGroupArn</code> value from the output of the CloudFormation template for DNS
and load balancing.</td>
</tr>
<tr>
<td><i class="conum" data-value="31"></i><b>31</b></td>
<td>The ARN for internal service load balancer target group.</td>
</tr>
<tr>
<td><i class="conum" data-value="32"></i><b>32</b></td>
<td>Specify the <code>InternalServiceTargetGroupArn</code> value from the output of the CloudFormation template for DNS
and load balancing.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Copy the template from the <strong>CloudFormation template for control plane machines</strong>
section of this topic and save it as a YAML file on your computer. This template
describes the control plane machines that your cluster requires.</p>
</li>
<li>
<p>If you specified an <code>m5</code> instance type as the value for <code>MasterInstanceType</code>,
add that instance type to the <code>MasterInstanceType.AllowedValues</code> parameter
in the CloudFormation template.</p>
</li>
<li>
<p>Launch the template:</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must enter the command on a single line.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws cloudformation create-stack --stack-name &lt;name&gt; <i class="conum" data-value="1"></i><b>(1)</b>
     --template-body file://&lt;template&gt;.yaml <i class="conum" data-value="2"></i><b>(2)</b>
     --parameters file://&lt;parameters&gt;.json <i class="conum" data-value="3"></i><b>(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>&lt;name&gt;</code> is the name for the CloudFormation stack, such as <code>cluster-control-plane</code>.
You need the name of this stack if you remove the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>&lt;template&gt;</code> is the relative path to and name of the CloudFormation template
YAML file that you saved.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>&lt;parameters&gt;</code> is the relative path to and name of the CloudFormation
parameters JSON file.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Confirm that the template components exist:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws cloudformation describe-stacks --stack-name &lt;name&gt;</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="installation-cloudformation-control-plane_installing-aws-user-infra"><a class="anchor" href="#installation-cloudformation-control-plane_installing-aws-user-infra"></a>CloudFormation template for control plane machines</h3>
<div class="paragraph">
<p>You can use the following CloudFormation template to deploy the control plane
machines that you need for your OpenShift Container Platform cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">AWSTemplateFormatVersion</span><span class="pi">:</span> <span class="s">2010-09-09</span>
<span class="na">Description</span><span class="pi">:</span> <span class="s">Template for OpenShift Cluster Node Launch (EC2 master instances)</span>

<span class="na">Parameters</span><span class="pi">:</span>
  <span class="na">InfrastructureName</span><span class="pi">:</span>
    <span class="na">AllowedPattern</span><span class="pi">:</span> <span class="s">^([a-zA-Z][a-zA-Z0-9\-]{0,26})$</span>
    <span class="na">MaxLength</span><span class="pi">:</span> <span class="m">27</span>
    <span class="na">MinLength</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">ConstraintDescription</span><span class="pi">:</span> <span class="s">Infrastructure name must be alphanumeric, start with a letter, and have a maximum of 27 characters.</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">A short, unique cluster ID used to tag nodes for the kubelet cloud provider.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">RhcosAmi</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Current Red Hat Enterprise Linux CoreOS AMI to use for bootstrap.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Image::Id</span>
  <span class="na">AutoRegisterDNS</span><span class="pi">:</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">yes"</span>
    <span class="na">AllowedValues</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">yes"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">no"</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Do you want to invoke DNS etcd registration, which requires Hosted Zone information?</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">PrivateHostedZoneId</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The Route53 private zone ID to register the etcd targets with, such as Z21IXYZABCZ2A4.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">PrivateHostedZoneName</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The Route53 zone to register the targets with, such as cluster.example.com. Omit the trailing period.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">Master0Subnet</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The subnets, recommend private, to launch the master nodes into.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Subnet::Id</span>
  <span class="na">Master1Subnet</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The subnets, recommend private, to launch the master nodes into.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Subnet::Id</span>
  <span class="na">Master2Subnet</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The subnets, recommend private, to launch the master nodes into.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Subnet::Id</span>
  <span class="na">MasterSecurityGroupId</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The master security group ID to associate with master nodes.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroup::Id</span>
  <span class="na">IgnitionLocation</span><span class="pi">:</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s">https://api-int.$CLUSTER_NAME.$DOMAIN:22623/config/master</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Ignition config file location.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">CertificateAuthorities</span><span class="pi">:</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s">data:text/plain;charset=utf-8;base64,ABC...xYz==</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Base64 encoded certificate authority string to use.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">MasterInstanceProfileName</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">IAM profile to associate with master nodes.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">MasterInstanceType</span><span class="pi">:</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s">m4.xlarge</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
    <span class="na">AllowedValues</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">m4.xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">m4.2xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">m4.4xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">m4.8xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">m4.10xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">m4.16xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">c4.2xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">c4.4xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">c4.8xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">r4.xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">r4.2xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">r4.4xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">r4.8xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">r4.16xlarge"</span>
  <span class="na">AutoRegisterELB</span><span class="pi">:</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">yes"</span>
    <span class="na">AllowedValues</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">yes"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">no"</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Do you want to invoke NLB registration, which requires a Lambda ARN parameter?</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">RegisterNlbIpTargetsLambdaArn</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">ARN for NLB IP target registration lambda. Supply the value from the cluster infrastructure or select "no" for AutoRegisterELB.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">ExternalApiTargetGroupArn</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">ARN for external API load balancer target group. Supply the value from the cluster infrastructure or select "no" for AutoRegisterELB.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">InternalApiTargetGroupArn</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">ARN for internal API load balancer target group. Supply the value from the cluster infrastructure or select "no" for AutoRegisterELB.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">InternalServiceTargetGroupArn</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">ARN for internal service load balancer target group. Supply the value from the cluster infrastructure or select "no" for AutoRegisterELB.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>

<span class="na">Metadata</span><span class="pi">:</span>
  <span class="s">AWS::CloudFormation::Interface:</span>
    <span class="s">ParameterGroups</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Cluster</span><span class="nv"> </span><span class="s">Information"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">InfrastructureName</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Host</span><span class="nv"> </span><span class="s">Information"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">MasterInstanceType</span>
      <span class="pi">-</span> <span class="s">RhcosAmi</span>
      <span class="pi">-</span> <span class="s">IgnitionLocation</span>
      <span class="pi">-</span> <span class="s">CertificateAuthorities</span>
      <span class="pi">-</span> <span class="s">MasterSecurityGroupId</span>
      <span class="pi">-</span> <span class="s">MasterInstanceProfileName</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Network</span><span class="nv"> </span><span class="s">Configuration"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">VpcId</span>
      <span class="pi">-</span> <span class="s">AllowedBootstrapSshCidr</span>
      <span class="pi">-</span> <span class="s">Master0Subnet</span>
      <span class="pi">-</span> <span class="s">Master1Subnet</span>
      <span class="pi">-</span> <span class="s">Master2Subnet</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">DNS"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">AutoRegisterDNS</span>
      <span class="pi">-</span> <span class="s">PrivateHostedZoneName</span>
      <span class="pi">-</span> <span class="s">PrivateHostedZoneId</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Load</span><span class="nv"> </span><span class="s">Balancer</span><span class="nv"> </span><span class="s">Automation"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">AutoRegisterELB</span>
      <span class="pi">-</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="pi">-</span> <span class="s">ExternalApiTargetGroupArn</span>
      <span class="pi">-</span> <span class="s">InternalApiTargetGroupArn</span>
      <span class="pi">-</span> <span class="s">InternalServiceTargetGroupArn</span>
    <span class="na">ParameterLabels</span><span class="pi">:</span>
      <span class="na">InfrastructureName</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Infrastructure</span><span class="nv"> </span><span class="s">Name"</span>
      <span class="na">VpcId</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">VPC</span><span class="nv"> </span><span class="s">ID"</span>
      <span class="na">Master0Subnet</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Master-0</span><span class="nv"> </span><span class="s">Subnet"</span>
      <span class="na">Master1Subnet</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Master-1</span><span class="nv"> </span><span class="s">Subnet"</span>
      <span class="na">Master2Subnet</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Master-2</span><span class="nv"> </span><span class="s">Subnet"</span>
      <span class="na">MasterInstanceType</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Master</span><span class="nv"> </span><span class="s">Instance</span><span class="nv"> </span><span class="s">Type"</span>
      <span class="na">MasterInstanceProfileName</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Master</span><span class="nv"> </span><span class="s">Instance</span><span class="nv"> </span><span class="s">Profile</span><span class="nv"> </span><span class="s">Name"</span>
      <span class="na">RhcosAmi</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Red</span><span class="nv"> </span><span class="s">Hat</span><span class="nv"> </span><span class="s">Enterprise</span><span class="nv"> </span><span class="s">Linux</span><span class="nv"> </span><span class="s">CoreOS</span><span class="nv"> </span><span class="s">AMI</span><span class="nv"> </span><span class="s">ID"</span>
      <span class="na">BootstrapIgnitionLocation</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Master</span><span class="nv"> </span><span class="s">Ignition</span><span class="nv"> </span><span class="s">Source"</span>
      <span class="na">CertificateAuthorities</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Ignition</span><span class="nv"> </span><span class="s">CA</span><span class="nv"> </span><span class="s">String"</span>
      <span class="na">MasterSecurityGroupId</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Master</span><span class="nv"> </span><span class="s">Security</span><span class="nv"> </span><span class="s">Group</span><span class="nv"> </span><span class="s">ID"</span>
      <span class="na">AutoRegisterDNS</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Use</span><span class="nv"> </span><span class="s">Provided</span><span class="nv"> </span><span class="s">DNS</span><span class="nv"> </span><span class="s">Automation"</span>
      <span class="na">AutoRegisterELB</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Use</span><span class="nv"> </span><span class="s">Provided</span><span class="nv"> </span><span class="s">ELB</span><span class="nv"> </span><span class="s">Automation"</span>
      <span class="na">PrivateHostedZoneName</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Private</span><span class="nv"> </span><span class="s">Hosted</span><span class="nv"> </span><span class="s">Zone</span><span class="nv"> </span><span class="s">Name"</span>
      <span class="na">PrivateHostedZoneId</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Private</span><span class="nv"> </span><span class="s">Hosted</span><span class="nv"> </span><span class="s">Zone</span><span class="nv"> </span><span class="s">ID"</span>

<span class="na">Conditions</span><span class="pi">:</span>
  <span class="na">DoRegistration</span><span class="pi">:</span> <span class="kt">!Equals</span> <span class="pi">[</span><span class="s2">"</span><span class="s">yes"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">AutoRegisterELB</span><span class="pi">]</span>
  <span class="na">DoDns</span><span class="pi">:</span> <span class="kt">!Equals</span> <span class="pi">[</span><span class="s2">"</span><span class="s">yes"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">AutoRegisterDNS</span><span class="pi">]</span>

<span class="na">Resources</span><span class="pi">:</span>
  <span class="na">Master0</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Instance</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ImageId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RhcosAmi</span>
      <span class="na">BlockDeviceMappings</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">DeviceName</span><span class="pi">:</span> <span class="s">/dev/xvda</span>
        <span class="na">Ebs</span><span class="pi">:</span>
          <span class="na">VolumeSize</span><span class="pi">:</span> <span class="s2">"</span><span class="s">120"</span>
          <span class="na">VolumeType</span><span class="pi">:</span> <span class="s2">"</span><span class="s">gp2"</span>
      <span class="na">IamInstanceProfile</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">MasterInstanceProfileName</span>
      <span class="na">InstanceType</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">MasterInstanceType</span>
      <span class="na">NetworkInterfaces</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">AssociatePublicIpAddress</span><span class="pi">:</span> <span class="s2">"</span><span class="s">false"</span>
        <span class="na">DeviceIndex</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0"</span>
        <span class="na">GroupSet</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">MasterSecurityGroupId"</span>
        <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">Master0Subnet"</span>
      <span class="na">UserData</span><span class="pi">:</span>
        <span class="s">Fn::Base64: !Sub</span>
        <span class="s">- '{"ignition":{"config":{"append":[{"source":"${SOURCE}","verification":{}}]},"security":{"tls":{"certificateAuthorities":[{"source":"${CA_BUNDLE}","verification":{}}]}},"timeouts":{},"version":"2.2.0"},"networkd":{},"passwd":{},"storage":{},"systemd":{}}'</span>
        <span class="s">- {</span>
          <span class="s">SOURCE</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">IgnitionLocation,</span>
          <span class="s">CA_BUNDLE</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">CertificateAuthorities,</span>
        <span class="err">}</span>
      <span class="na">Tags</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Key</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">,</span> <span class="pi">[</span><span class="s2">"</span><span class="s">kubernetes.io/cluster/"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">]]</span>
        <span class="na">Value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">shared"</span>

  <span class="na">RegisterMaster0</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoRegistration</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::NLBRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="na">TargetArn</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">ExternalApiTargetGroupArn</span>
      <span class="na">TargetIp</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">Master0.PrivateIp</span>

  <span class="na">RegisterMaster0InternalApiTarget</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoRegistration</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::NLBRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="na">TargetArn</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternalApiTargetGroupArn</span>
      <span class="na">TargetIp</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">Master0.PrivateIp</span>

  <span class="na">RegisterMaster0InternalServiceTarget</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoRegistration</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::NLBRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="na">TargetArn</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternalServiceTargetGroupArn</span>
      <span class="na">TargetIp</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">Master0.PrivateIp</span>

  <span class="na">Master1</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Instance</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ImageId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RhcosAmi</span>
      <span class="na">BlockDeviceMappings</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">DeviceName</span><span class="pi">:</span> <span class="s">/dev/xvda</span>
        <span class="na">Ebs</span><span class="pi">:</span>
          <span class="na">VolumeSize</span><span class="pi">:</span> <span class="s2">"</span><span class="s">120"</span>
          <span class="na">VolumeType</span><span class="pi">:</span> <span class="s2">"</span><span class="s">gp2"</span>
      <span class="na">IamInstanceProfile</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">MasterInstanceProfileName</span>
      <span class="na">InstanceType</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">MasterInstanceType</span>
      <span class="na">NetworkInterfaces</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">AssociatePublicIpAddress</span><span class="pi">:</span> <span class="s2">"</span><span class="s">false"</span>
        <span class="na">DeviceIndex</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0"</span>
        <span class="na">GroupSet</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">MasterSecurityGroupId"</span>
        <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">Master1Subnet"</span>
      <span class="na">UserData</span><span class="pi">:</span>
        <span class="s">Fn::Base64: !Sub</span>
        <span class="s">- '{"ignition":{"config":{"append":[{"source":"${SOURCE}","verification":{}}]},"security":{"tls":{"certificateAuthorities":[{"source":"${CA_BUNDLE}","verification":{}}]}},"timeouts":{},"version":"2.2.0"},"networkd":{},"passwd":{},"storage":{},"systemd":{}}'</span>
        <span class="s">- {</span>
          <span class="s">SOURCE</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">IgnitionLocation,</span>
          <span class="s">CA_BUNDLE</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">CertificateAuthorities,</span>
        <span class="err">}</span>
      <span class="na">Tags</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Key</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">,</span> <span class="pi">[</span><span class="s2">"</span><span class="s">kubernetes.io/cluster/"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">]]</span>
        <span class="na">Value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">shared"</span>

  <span class="na">RegisterMaster1</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoRegistration</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::NLBRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="na">TargetArn</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">ExternalApiTargetGroupArn</span>
      <span class="na">TargetIp</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">Master1.PrivateIp</span>

  <span class="na">RegisterMaster1InternalApiTarget</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoRegistration</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::NLBRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="na">TargetArn</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternalApiTargetGroupArn</span>
      <span class="na">TargetIp</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">Master1.PrivateIp</span>

  <span class="na">RegisterMaster1InternalServiceTarget</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoRegistration</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::NLBRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="na">TargetArn</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternalServiceTargetGroupArn</span>
      <span class="na">TargetIp</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">Master1.PrivateIp</span>

  <span class="na">Master2</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Instance</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ImageId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RhcosAmi</span>
      <span class="na">BlockDeviceMappings</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">DeviceName</span><span class="pi">:</span> <span class="s">/dev/xvda</span>
        <span class="na">Ebs</span><span class="pi">:</span>
          <span class="na">VolumeSize</span><span class="pi">:</span> <span class="s2">"</span><span class="s">120"</span>
          <span class="na">VolumeType</span><span class="pi">:</span> <span class="s2">"</span><span class="s">gp2"</span>
      <span class="na">IamInstanceProfile</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">MasterInstanceProfileName</span>
      <span class="na">InstanceType</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">MasterInstanceType</span>
      <span class="na">NetworkInterfaces</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">AssociatePublicIpAddress</span><span class="pi">:</span> <span class="s2">"</span><span class="s">false"</span>
        <span class="na">DeviceIndex</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0"</span>
        <span class="na">GroupSet</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">MasterSecurityGroupId"</span>
        <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">Master2Subnet"</span>
      <span class="na">UserData</span><span class="pi">:</span>
        <span class="s">Fn::Base64: !Sub</span>
        <span class="s">- '{"ignition":{"config":{"append":[{"source":"${SOURCE}","verification":{}}]},"security":{"tls":{"certificateAuthorities":[{"source":"${CA_BUNDLE}","verification":{}}]}},"timeouts":{},"version":"2.2.0"},"networkd":{},"passwd":{},"storage":{},"systemd":{}}'</span>
        <span class="s">- {</span>
          <span class="s">SOURCE</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">IgnitionLocation,</span>
          <span class="s">CA_BUNDLE</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">CertificateAuthorities,</span>
        <span class="err">}</span>
      <span class="na">Tags</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Key</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">,</span> <span class="pi">[</span><span class="s2">"</span><span class="s">kubernetes.io/cluster/"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">]]</span>
        <span class="na">Value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">shared"</span>

  <span class="na">RegisterMaster2</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoRegistration</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::NLBRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="na">TargetArn</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">ExternalApiTargetGroupArn</span>
      <span class="na">TargetIp</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">Master2.PrivateIp</span>

  <span class="na">RegisterMaster2InternalApiTarget</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoRegistration</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::NLBRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="na">TargetArn</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternalApiTargetGroupArn</span>
      <span class="na">TargetIp</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">Master2.PrivateIp</span>

  <span class="na">RegisterMaster2InternalServiceTarget</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoRegistration</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">Custom::NLBRegister</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ServiceToken</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RegisterNlbIpTargetsLambdaArn</span>
      <span class="na">TargetArn</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">InternalServiceTargetGroupArn</span>
      <span class="na">TargetIp</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">Master2.PrivateIp</span>

  <span class="na">EtcdSrvRecords</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoDns</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::Route53::RecordSet</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">HostedZoneId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PrivateHostedZoneId</span>
      <span class="na">Name</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">."</span><span class="pi">,</span> <span class="pi">[</span><span class="s2">"</span><span class="s">_etcd-server-ssl._tcp"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">PrivateHostedZoneName</span><span class="pi">]]</span>
      <span class="na">ResourceRecords</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="kt">!Join</span> <span class="pi">[</span>
        <span class="s2">"</span><span class="nv"> </span><span class="s">"</span><span class="pi">,</span>
        <span class="pi">[</span><span class="s2">"</span><span class="s">0</span><span class="nv"> </span><span class="s">10</span><span class="nv"> </span><span class="s">2380"</span><span class="pi">,</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">."</span><span class="pi">,</span> <span class="pi">[</span><span class="s2">"</span><span class="s">etcd-0"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">PrivateHostedZoneName</span><span class="pi">]]],</span>
      <span class="pi">]</span>
      <span class="pi">-</span> <span class="kt">!Join</span> <span class="pi">[</span>
        <span class="s2">"</span><span class="nv"> </span><span class="s">"</span><span class="pi">,</span>
        <span class="pi">[</span><span class="s2">"</span><span class="s">0</span><span class="nv"> </span><span class="s">10</span><span class="nv"> </span><span class="s">2380"</span><span class="pi">,</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">."</span><span class="pi">,</span> <span class="pi">[</span><span class="s2">"</span><span class="s">etcd-1"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">PrivateHostedZoneName</span><span class="pi">]]],</span>
      <span class="pi">]</span>
      <span class="pi">-</span> <span class="kt">!Join</span> <span class="pi">[</span>
        <span class="s2">"</span><span class="nv"> </span><span class="s">"</span><span class="pi">,</span>
        <span class="pi">[</span><span class="s2">"</span><span class="s">0</span><span class="nv"> </span><span class="s">10</span><span class="nv"> </span><span class="s">2380"</span><span class="pi">,</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">."</span><span class="pi">,</span> <span class="pi">[</span><span class="s2">"</span><span class="s">etcd-2"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">PrivateHostedZoneName</span><span class="pi">]]],</span>
      <span class="pi">]</span>
      <span class="na">TTL</span><span class="pi">:</span> <span class="m">60</span>
      <span class="na">Type</span><span class="pi">:</span> <span class="s">SRV</span>

  <span class="na">Etcd0Record</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoDns</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::Route53::RecordSet</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">HostedZoneId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PrivateHostedZoneId</span>
      <span class="na">Name</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">."</span><span class="pi">,</span> <span class="pi">[</span><span class="s2">"</span><span class="s">etcd-0"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">PrivateHostedZoneName</span><span class="pi">]]</span>
      <span class="na">ResourceRecords</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="kt">!GetAtt</span> <span class="s">Master0.PrivateIp</span>
      <span class="na">TTL</span><span class="pi">:</span> <span class="m">60</span>
      <span class="na">Type</span><span class="pi">:</span> <span class="s">A</span>

  <span class="na">Etcd1Record</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoDns</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::Route53::RecordSet</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">HostedZoneId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PrivateHostedZoneId</span>
      <span class="na">Name</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">."</span><span class="pi">,</span> <span class="pi">[</span><span class="s2">"</span><span class="s">etcd-1"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">PrivateHostedZoneName</span><span class="pi">]]</span>
      <span class="na">ResourceRecords</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="kt">!GetAtt</span> <span class="s">Master1.PrivateIp</span>
      <span class="na">TTL</span><span class="pi">:</span> <span class="m">60</span>
      <span class="na">Type</span><span class="pi">:</span> <span class="s">A</span>

  <span class="na">Etcd2Record</span><span class="pi">:</span>
    <span class="na">Condition</span><span class="pi">:</span> <span class="s">DoDns</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::Route53::RecordSet</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">HostedZoneId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">PrivateHostedZoneId</span>
      <span class="na">Name</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">."</span><span class="pi">,</span> <span class="pi">[</span><span class="s2">"</span><span class="s">etcd-2"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">PrivateHostedZoneName</span><span class="pi">]]</span>
      <span class="na">ResourceRecords</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="kt">!GetAtt</span> <span class="s">Master2.PrivateIp</span>
      <span class="na">TTL</span><span class="pi">:</span> <span class="m">60</span>
      <span class="na">Type</span><span class="pi">:</span> <span class="s">A</span>

<span class="na">Outputs</span><span class="pi">:</span>
  <span class="na">PrivateIPs</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The control-plane node private IP addresses.</span>
    <span class="na">Value</span><span class="pi">:</span>
      <span class="kt">!Join</span> <span class="pi">[</span>
        <span class="s2">"</span><span class="s">,"</span><span class="pi">,</span>
        <span class="pi">[</span><span class="kt">!GetAtt</span> <span class="nv">Master0.PrivateIp</span><span class="pi">,</span> <span class="kt">!GetAtt</span> <span class="nv">Master1.PrivateIp</span><span class="pi">,</span> <span class="kt">!GetAtt</span> <span class="nv">Master2.PrivateIp</span><span class="pi">]</span>
      <span class="pi">]</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-aws-user-infra-bootstrap_installing-aws-user-infra"><a class="anchor" href="#installation-aws-user-infra-bootstrap_installing-aws-user-infra"></a>Initializing the bootstrap node on AWS with user-provisioned infrastructure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you create all of the required infrastructure in Amazon Web Services (AWS),
you can install the cluster.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Configure an AWS account.</p>
</li>
<li>
<p>Generate the Ignition config files for your cluster.</p>
</li>
<li>
<p>Create and configure a VPC and assocated subnets in AWS.</p>
</li>
<li>
<p>Create and configure DNS, load balancers, and listeners in AWS.</p>
</li>
<li>
<p>Create control plane and compute roles.</p>
</li>
<li>
<p>Create the bootstrap machine.</p>
</li>
<li>
<p>Create the control plane machines.</p>
</li>
<li>
<p>If you plan to manually manage the worker machines, create the worker machines.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Change to the directory that contains the installation program and run the
following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ ./openshift-install wait-for bootstrap-complete --dir=&lt;installation_directory&gt; \ <i class="conum" data-value="1"></i><b>(1)</b>
    --log-level info <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For <code>&lt;installation_directory&gt;</code>, specify the path to the directory that you
stored the installation files in.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To view different installation details, specify <code>warn</code>, <code>debug</code>, or
<code>error</code> instead of <code>info</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the command exits without a <code>FATAL</code> warning, your production control plane
has initialized.</p>
</div>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="installation-creating-aws-worker_installing-aws-user-infra"><a class="anchor" href="#installation-creating-aws-worker_installing-aws-user-infra"></a>Creating the worker nodes in AWS</h3>
<div class="paragraph">
<p>You can create worker nodes in Amazon Web Services (AWS) for your cluster to use.
The easiest way to manually create these nodes is to modify the provided
CloudFormation template.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The CloudFormation template creates a stack that represents one worker machine.
You must create a stack for each worker machine.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not use the provided CloudFormation template to create your worker
nodes, you must review the provided information and manually create
the infrastructure. If your cluster does not initialize correctly, you might
have to contact Red Hat support with your installation logs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Configure an AWS account.</p>
</li>
<li>
<p>Generate the Ignition config files for your cluster.</p>
</li>
<li>
<p>Create and configure a VPC and assocated subnets in AWS.</p>
</li>
<li>
<p>Create and configure DNS, load balancers, and listeners in AWS.</p>
</li>
<li>
<p>Create control plane and compute roles.</p>
</li>
<li>
<p>Create the bootstrap machine.</p>
</li>
<li>
<p>Create the control plane machines.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a JSON file that contains the parameter values that the CloudFormation
template requires:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="json"><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"InfrastructureName"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="1"></i><b>(1)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mycluster-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="2"></i><b>(2)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RhcosAmi"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="3"></i><b>(3)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ami-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="4"></i><b>(4)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Subnet"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="5"></i><b>(5)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subnet-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="6"></i><b>(6)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WorkerSecurityGroupId"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="7"></i><b>(7)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sg-&lt;random_string&gt;"</span><span class="w"> <i class="conum" data-value="8"></i><b>(8)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IgnitionLocation"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="9"></i><b>(9)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api-int.&lt;cluster_name&gt;.&lt;domain_name&gt;:22623/config/worker"</span><span class="w"> <i class="conum" data-value="10"></i><b>(10)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CertificateAuthorities"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="11"></i><b>(11)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w"> <i class="conum" data-value="12"></i><b>(12)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WorkerInstanceProfileName"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="13"></i><b>(13)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w"> <i class="conum" data-value="14"></i><b>(14)</b>
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ParameterKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WorkerInstanceType"</span><span class="p">,</span><span class="w"> <i class="conum" data-value="15"></i><b>(15)</b>
    </span><span class="nl">"ParameterValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"m4.large"</span><span class="w"> <i class="conum" data-value="16"></i><b>(16)</b>
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The name for your cluster infrastructure that is encoded in your Ignition
config files for the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Specify the infrastructure name that you extracted from the Ignition config
file metadata, which has the format <code>&lt;cluster-name&gt;-&lt;random-string&gt;</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Current Red Hat Enterprise Linux CoreOS (RHCOS) AMI to use for the worker nodes.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Specify an <code>AWS::EC2::Image::Id</code> value.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>A subnet, preferably private, to launch the worker nodes on.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Specify a subnet from the <code>PrivateSubnets</code> value from the output of the
CloudFormation template for DNS and load balancing.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The worker security group ID to associate with worker nodes.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Specify the <code>WorkerSecurityGroupId</code> value from the output of the
CloudFormation template for the security group and roles.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>The location to fetch bootstrap Ignition config file from.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Specify the generated Ignition config location,
<code><a href="https://api-int.&lt;cluster_name&gt;.&lt;domain_name&gt;:22623/config/worker" class="bare">https://api-int.&lt;cluster_name&gt;.&lt;domain_name&gt;:22623/config/worker</a></code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Base64 encoded certificate authority string to use.</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>Specify the value from the <code>worker.ign</code> file that is in the installation
directory. This value is the long string with the format
<code>data:text/plain;charset=utf-8;base64,ABC&#8230;&#8203;xYz==</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>The IAM profile to associate with worker nodes.</td>
</tr>
<tr>
<td><i class="conum" data-value="14"></i><b>14</b></td>
<td>Specify the <code>WorkerInstanceProfile</code> parameter value from the output of
the CloudFormation template for the security group and roles.</td>
</tr>
<tr>
<td><i class="conum" data-value="15"></i><b>15</b></td>
<td>The type of AWS instance to use for the control plane machines.</td>
</tr>
<tr>
<td><i class="conum" data-value="16"></i><b>16</b></td>
<td>Allowed values:
<div class="ulist">
<ul>
<li>
<p><code>m4.large</code></p>
</li>
<li>
<p><code>m4.xlarge</code></p>
</li>
<li>
<p><code>m4.2xlarge</code></p>
</li>
<li>
<p><code>m4.4xlarge</code></p>
</li>
<li>
<p><code>m4.8xlarge</code></p>
</li>
<li>
<p><code>m4.10xlarge</code></p>
</li>
<li>
<p><code>m4.16xlarge</code></p>
</li>
<li>
<p><code>c4.large</code></p>
</li>
<li>
<p><code>c4.xlarge</code></p>
</li>
<li>
<p><code>c4.2xlarge</code></p>
</li>
<li>
<p><code>c4.4xlarge</code></p>
</li>
<li>
<p><code>c4.8xlarge</code></p>
</li>
<li>
<p><code>r4.large</code></p>
</li>
<li>
<p><code>r4.xlarge</code></p>
</li>
<li>
<p><code>r4.2xlarge</code></p>
</li>
<li>
<p><code>r4.4xlarge</code></p>
</li>
<li>
<p><code>r4.8xlarge</code></p>
</li>
<li>
<p><code>r4.16xlarge</code></p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If <code>m4</code> instance types are not available in your region, such as with
<code>eu-west-3</code>, use <code>m5</code> types instead.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div></td>
</tr>
</table>
</div>
</li>
<li>
<p>Copy the template from the <strong>CloudFormation template for worker machines</strong>
section of this topic and save it as a YAML file on your computer. This template
describes the networking objects and load balancers that your cluster requires.</p>
</li>
<li>
<p>If you specified an <code>m5</code> instance type as the value for <code>WorkerInstanceType</code>,
add that instance type to the <code>WorkerInstanceType.AllowedValues</code> parameter
in the CloudFormation template.</p>
</li>
<li>
<p>Create a worker stack.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Launch the template:</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must enter the command on a single line.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws cloudformation create-stack --stack-name &lt;name&gt; <i class="conum" data-value="1"></i><b>(1)</b>
     --template-body file://&lt;template&gt;.yaml \ <i class="conum" data-value="2"></i><b>(2)</b>
     --parameters file://&lt;parameters&gt;.json <i class="conum" data-value="3"></i><b>(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>&lt;name&gt;</code> is the name for the CloudFormation stack, such as <code>cluster-workers</code>.
You need the name of this stack if you remove the cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>&lt;template&gt;</code> is the relative path to and name of the CloudFormation template
YAML file that you saved.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>&lt;parameters&gt;</code> is the relative path to and name of the CloudFormation
parameters JSON file.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Confirm that the template components exist:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws cloudformation describe-stacks --stack-name &lt;name&gt;</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Continue to create worker stacks until you have created enough worker Machines
for your cluster.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must create at least two worker machines, so you must create at least
two stacks that use this CloudFormation template.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="installation-cloudformation-worker_installing-aws-user-infra"><a class="anchor" href="#installation-cloudformation-worker_installing-aws-user-infra"></a>CloudFormation template for worker machines</h4>
<div class="paragraph">
<p>You can use the following CloudFormation template to deploy the worker machines
that you need for your OpenShift Container Platform cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">AWSTemplateFormatVersion</span><span class="pi">:</span> <span class="s">2010-09-09</span>
<span class="na">Description</span><span class="pi">:</span> <span class="s">Template for OpenShift Cluster Node Launch (EC2 worker instance)</span>

<span class="na">Parameters</span><span class="pi">:</span>
  <span class="na">InfrastructureName</span><span class="pi">:</span>
    <span class="na">AllowedPattern</span><span class="pi">:</span> <span class="s">^([a-zA-Z][a-zA-Z0-9\-]{0,26})$</span>
    <span class="na">MaxLength</span><span class="pi">:</span> <span class="m">27</span>
    <span class="na">MinLength</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">ConstraintDescription</span><span class="pi">:</span> <span class="s">Infrastructure name must be alphanumeric, start with a letter, and have a maximum of 27 characters.</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">A short, unique cluster ID used to tag nodes for the kubelet cloud provider.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">RhcosAmi</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Current Red Hat Enterprise Linux CoreOS AMI to use for bootstrap.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Image::Id</span>
  <span class="na">Subnet</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The subnets, recommend private, to launch the master nodes into.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Subnet::Id</span>
  <span class="na">WorkerSecurityGroupId</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The master security group ID to associate with master nodes.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroup::Id</span>
  <span class="na">IgnitionLocation</span><span class="pi">:</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s">https://api-int.$CLUSTER_NAME.$DOMAIN:22623/config/worker</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Ignition config file location.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">CertificateAuthorities</span><span class="pi">:</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s">data:text/plain;charset=utf-8;base64,ABC...xYz==</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">Base64 encoded certificate authority string to use.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">WorkerInstanceProfileName</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">IAM profile to associate with master nodes.</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">WorkerInstanceType</span><span class="pi">:</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s">m4.large</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
    <span class="na">AllowedValues</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">m4.large"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">m4.xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">m4.2xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">m4.4xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">m4.8xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">m4.10xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">m4.16xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">c4.large"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">c4.xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">c4.2xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">c4.4xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">c4.8xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">r4.large"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">r4.xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">r4.2xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">r4.4xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">r4.8xlarge"</span>
    <span class="pi">-</span> <span class="s2">"</span><span class="s">r4.16xlarge"</span>

<span class="na">Metadata</span><span class="pi">:</span>
  <span class="s">AWS::CloudFormation::Interface:</span>
    <span class="s">ParameterGroups</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Cluster</span><span class="nv"> </span><span class="s">Information"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">InfrastructureName</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Host</span><span class="nv"> </span><span class="s">Information"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">WorkerInstanceType</span>
      <span class="pi">-</span> <span class="s">RhcosAmi</span>
      <span class="pi">-</span> <span class="s">IgnitionLocation</span>
      <span class="pi">-</span> <span class="s">CertificateAuthorities</span>
      <span class="pi">-</span> <span class="s">WorkerSecurityGroupId</span>
      <span class="pi">-</span> <span class="s">WorkerInstanceProfileName</span>
    <span class="pi">-</span> <span class="na">Label</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Network</span><span class="nv"> </span><span class="s">Configuration"</span>
      <span class="na">Parameters</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">Subnet</span>
    <span class="na">ParameterLabels</span><span class="pi">:</span>
      <span class="na">Subnet</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Subnet"</span>
      <span class="na">InfrastructureName</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Infrastructure</span><span class="nv"> </span><span class="s">Name"</span>
      <span class="na">WorkerInstanceType</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Worker</span><span class="nv"> </span><span class="s">Instance</span><span class="nv"> </span><span class="s">Type"</span>
      <span class="na">WorkerInstanceProfileName</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Worker</span><span class="nv"> </span><span class="s">Instance</span><span class="nv"> </span><span class="s">Profile</span><span class="nv"> </span><span class="s">Name"</span>
      <span class="na">RhcosAmi</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Red</span><span class="nv"> </span><span class="s">Hat</span><span class="nv"> </span><span class="s">Enterprise</span><span class="nv"> </span><span class="s">Linux</span><span class="nv"> </span><span class="s">CoreOS</span><span class="nv"> </span><span class="s">AMI</span><span class="nv"> </span><span class="s">ID"</span>
      <span class="na">IgnitionLocation</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Worker</span><span class="nv"> </span><span class="s">Ignition</span><span class="nv"> </span><span class="s">Source"</span>
      <span class="na">CertificateAuthorities</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Ignition</span><span class="nv"> </span><span class="s">CA</span><span class="nv"> </span><span class="s">String"</span>
      <span class="na">WorkerSecurityGroupId</span><span class="pi">:</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Worker</span><span class="nv"> </span><span class="s">Security</span><span class="nv"> </span><span class="s">Group</span><span class="nv"> </span><span class="s">ID"</span>

<span class="na">Resources</span><span class="pi">:</span>
  <span class="na">Worker0</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Instance</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">ImageId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">RhcosAmi</span>
      <span class="na">BlockDeviceMappings</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">DeviceName</span><span class="pi">:</span> <span class="s">/dev/xvda</span>
        <span class="na">Ebs</span><span class="pi">:</span>
          <span class="na">VolumeSize</span><span class="pi">:</span> <span class="s2">"</span><span class="s">120"</span>
          <span class="na">VolumeType</span><span class="pi">:</span> <span class="s2">"</span><span class="s">gp2"</span>
      <span class="na">IamInstanceProfile</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">WorkerInstanceProfileName</span>
      <span class="na">InstanceType</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">WorkerInstanceType</span>
      <span class="na">NetworkInterfaces</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">AssociatePublicIpAddress</span><span class="pi">:</span> <span class="s2">"</span><span class="s">false"</span>
        <span class="na">DeviceIndex</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0"</span>
        <span class="na">GroupSet</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">WorkerSecurityGroupId"</span>
        <span class="na">SubnetId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s2">"</span><span class="s">Subnet"</span>
      <span class="na">UserData</span><span class="pi">:</span>
        <span class="s">Fn::Base64: !Sub</span>
        <span class="s">- '{"ignition":{"config":{"append":[{"source":"${SOURCE}","verification":{}}]},"security":{"tls":{"certificateAuthorities":[{"source":"${CA_BUNDLE}","verification":{}}]}},"timeouts":{},"version":"2.2.0"},"networkd":{},"passwd":{},"storage":{},"systemd":{}}'</span>
        <span class="s">- {</span>
          <span class="s">SOURCE</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">IgnitionLocation,</span>
          <span class="s">CA_BUNDLE</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">CertificateAuthorities,</span>
        <span class="err">}</span>
      <span class="na">Tags</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">Key</span><span class="pi">:</span> <span class="kt">!Join</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">,</span> <span class="pi">[</span><span class="s2">"</span><span class="s">kubernetes.io/cluster/"</span><span class="pi">,</span> <span class="kt">!Ref</span> <span class="nv">InfrastructureName</span><span class="pi">]]</span>
        <span class="na">Value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">shared"</span>

<span class="na">Outputs</span><span class="pi">:</span>
  <span class="na">PrivateIP</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The compute node private IP address.</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">Worker0.PrivateIp</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cli-install_installing-aws-user-infra"><a class="anchor" href="#cli-install_installing-aws-user-infra"></a>Installing the OpenShift Command-line Interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can download and install the OpenShift Command-line Interface (CLI),
commonly known as <code>oc</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you installed an earlier version of <code>oc</code>, you cannot use it to complete all
of the commands in OpenShift Container Platform 4.1. You must download and
install the new version of <code>oc</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>From the <a href="https://cloud.redhat.com/openshift/install">Infrastructure Provider</a> page on the Red Hat OpenShift Cluster Manager site, navigate to the page for your installation type and
click <strong>Download Command-line Tools</strong>.</p>
</li>
<li>
<p>From the site that is displayed, download the compressed file for your
operating system.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can install <code>oc</code> on Linux, Windows, or macOS.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Extract the compressed file and place it in a directory that is on your PATH.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cli-logging-in-kubeadmin_installing-aws-user-infra"><a class="anchor" href="#cli-logging-in-kubeadmin_installing-aws-user-infra"></a>Logging in to  the cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can log in to your cluster as a default system user by exporting the cluster <code>kubeconfig</code> file.
The <code>kubeconfig</code> file contains information about the cluster that is used by the CLI to connect a client to the correct cluster and API server.
The file is specific to a cluster and is created during OpenShift Container Platform installation.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Deploy an OpenShift Container Platform cluster.</p>
</li>
<li>
<p>Install the <code>oc</code> CLI.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Export the <code>kubeadmin</code> credentials:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ export KUBECONFIG=&lt;installation_directory&gt;/auth/kubeconfig <i class="conum" data-value="1"></i><b>(1)</b>

$ oc whoami
system:admin</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For <code>&lt;installation_directory&gt;</code>, specify the path to the directory that you stored
the installation files in.</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-approve-csrs_installing-aws-user-infra"><a class="anchor" href="#installation-approve-csrs_installing-aws-user-infra"></a>Approving the CSRs for your machines</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you add machines to a cluster, two pending certificates signing request
(CSRs) are generated for each machine that you added. You must confirm that
these CSRs are approved or, if necessary, approve them yourself.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You added machines to your cluster.</p>
</li>
<li>
<p>Install the <code>jq</code> package.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Confirm that the cluster recognizes the machines:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc get nodes

NAME      STATUS    ROLES   AGE  VERSION
master-0  Ready     master  63m  v1.13.4+b626c2fe1
master-1  Ready     master  63m  v1.13.4+b626c2fe1
master-2  Ready     master  64m  v1.13.4+b626c2fe1
worker-0  NotReady  worker  76s  v1.13.4+b626c2fe1
worker-1  NotReady  worker  70s  v1.13.4+b626c2fe1</pre>
</div>
</div>
<div class="paragraph">
<p>The output lists all of the machines that you created.</p>
</div>
</li>
<li>
<p>Review the pending certificate signing requests (CSRs) and ensure that the
you see a client and server request with <code>Pending</code> or <code>Approved</code> status for
each machine that you added to the cluster:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc get csr

NAME        AGE     REQUESTOR                                                                   CONDITION
csr-8b2br   15m     system:serviceaccount:openshift-machine-config-operator:node-bootstrapper   Pending <i class="conum" data-value="1"></i><b>(1)</b>
csr-8vnps   15m     system:serviceaccount:openshift-machine-config-operator:node-bootstrapper   Pending
csr-bfd72   5m26s   system:node:ip-10-0-50-126.us-east-2.compute.internal                       Pending <i class="conum" data-value="2"></i><b>(2)</b>
csr-c57lv   5m26s   system:node:ip-10-0-95-157.us-east-2.compute.internal                       Pending
...</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A client request CSR.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A server request CSR.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this example, two machines are joining the cluster. You might see more
approved CSRs in the list.</p>
</div>
</li>
<li>
<p>If the CSRs were not approved, after all of the pending CSRs for the machines
you added are in <code>Pending</code> status, approve the CSRs for your cluster machines:</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Because the CSRs rotate automatically, approve your CSRs within an hour
of adding the machines to the cluster. If you do not approve them within an
hour, the certificates will rotate, and more than two certificates will be
present for each node. You must approve all of these certificates. After you
approve the initial CSRs, the subsequent node client CSRs are automatically
approved by the cluster <code>kube-controller-manager</code>. You must implement a method
of automatically approving the kubelet serving certificate requests.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>To approve them individually, run the following command for each valid
CSR:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc adm certificate approve &lt;csr_name&gt; <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>&lt;csr_name&gt;</code> is the name of a CSR from the list of current CSRs.</td>
</tr>
</table>
</div>
</li>
<li>
<p>If all the CSRs are valid, approve them all by running the following
command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc get csr -ojson | jq -r '.items[] | select(.status == {} ) | .metadata.name' | xargs oc adm certificate approve</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-operators-config_installing-aws-user-infra"><a class="anchor" href="#installation-operators-config_installing-aws-user-infra"></a>Initial Operator configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After the control plane initializes, you must immediately configure some
Operators so that they all become available.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your control plane has initialized.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Watch the cluster components come online:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ watch -n5 oc get clusteroperators

NAME                                 VERSION   AVAILABLE   PROGRESSING   DEGRADED   SINCE
authentication                       4.1.0     True        False         False      69s
cloud-credential                     4.1.0     True        False         False      12m
cluster-autoscaler                   4.1.0     True        False         False      11m
console                              4.1.0     True        False         False      46s
dns                                  4.1.0     True        False         False      11m
image-registry                       4.1.0     False       True          False      5m26s
ingress                              4.1.0     True        False         False      5m36s
kube-apiserver                       4.1.0     True        False         False      8m53s
kube-controller-manager              4.1.0     True        False         False      7m24s
kube-scheduler                       4.1.0     True        False         False      12m
machine-api                          4.1.0     True        False         False      12m
machine-config                       4.1.0     True        False         False      7m36s
marketplace                          4.1.0     True        False         False      7m54m
monitoring                           4.1.0     True        False         False      7h54s
network                              4.1.0     True        False         False      5m9s
node-tuning                          4.1.0     True        False         False      11m
openshift-apiserver                  4.1.0     True        False         False      11m
openshift-controller-manager         4.1.0     True        False         False      5m943s
openshift-samples                    4.1.0     True        False         False      3m55s
operator-lifecycle-manager           4.1.0     True        False         False      11m
operator-lifecycle-manager-catalog   4.1.0     True        False         False      11m
service-ca                           4.1.0     True        False         False      11m
service-catalog-apiserver            4.1.0     True        False         False      5m26s
service-catalog-controller-manager   4.1.0     True        False         False      5m25s
storage                              4.1.0     True        False         False      5m30s</pre>
</div>
</div>
</li>
<li>
<p>Configure the Operators that are not available.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="installation-registry-storage-config_installing-aws-user-infra"><a class="anchor" href="#installation-registry-storage-config_installing-aws-user-infra"></a>Image registry storage configuration</h3>
<div class="paragraph">
<p>If the <code>image-registry</code> Operator is not available, you must configure storage
for it. Instructions for both configuring a PersistentVolume, which is required
for production clusters, and for configuring an empty directory as the storage
location, which is available for only non-production clusters, are shown.</p>
</div>
<div class="sect3">
<h4 id="registry-configuring-storage-aws-user-infra_installing-aws-user-infra"><a class="anchor" href="#registry-configuring-storage-aws-user-infra_installing-aws-user-infra"></a>Configuring registry storage for AWS with user-provisioned infrastructure</h4>
<div class="paragraph">
<p>During installation, your cloud credentials are sufficient to create an S3 bucket
and the Registry Operator will automatically configure storage.</p>
</div>
<div class="paragraph">
<p>If the Registry Operator cannot create an S3 bucket, and automatically configure
storage, you can create a S3 bucket and configure storage with the following
procedure.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A cluster on AWS with user-provisioned infrastructure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>Use the following procedure if the Registry Operator cannot create an S3 bucket
and automatically configure storage.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set up a <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/mpuoverview.html#mpu-abort-incomplete-mpu-lifecycle-config">Bucket Lifecycle Policy</a>
to abort incomplete multipart uploads that are one day old.</p>
</li>
<li>
<p>Fill in the storage configuration in
<code>configs.imageregistry.operator.openshift.io/cluster</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc edit configs.imageregistry.operator.openshift.io/cluster

storage:
  s3:
    bucket: &lt;bucket-name&gt;
    region: &lt;region-name&gt;</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To secure your registry images in AWS, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-publicaccessblockconfiguration.html">block public access</a>
to the S3 bucket.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="installation-registry-storage-non-production_installing-aws-user-infra"><a class="anchor" href="#installation-registry-storage-non-production_installing-aws-user-infra"></a>Configuring storage for the image registry in non-production clusters</h4>
<div class="paragraph">
<p>You must configure storage for the image registry Operator. For non-production
clusters, you can set the image registry to an empty directory. If you do so,
all images are lost if you restart the registry.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>To set the image registry storage to an empty directory:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc patch configs.imageregistry.operator.openshift.io cluster --type merge --patch '{"spec":{"storage":{"emptyDir":{}}}}'</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Configure this option for only non-production clusters.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you run this command before the Image Registry Operator initializes its
components, the <code>oc patch</code> command fails with the following error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Error from server (NotFound): configs.imageregistry.operator.openshift.io "cluster" not found</pre>
</div>
</div>
<div class="paragraph">
<p>Wait a few minutes and run the command again.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-aws-user-infra-installation_installing-aws-user-infra"><a class="anchor" href="#installation-aws-user-infra-installation_installing-aws-user-infra"></a>Completing an AWS installation on user-provisioned infrastructure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you start the OpenShift Container Platform installation on Amazon Web Service (AWS)
user-provisioned infrastructure, remove the bootstrap node, and wait for
installation to complete.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Deploy the bootstrap node for an OpenShift Container Platform cluster on user-provisioned AWS infrastructure.</p>
</li>
<li>
<p>Install the <code>oc</code> CLI and log in.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Delete the bootstrap resources. If you used the CloudFormation template,
<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-console-delete-stack.html">delete its stack</a>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ aws cloudformation delete-stack --stack-name &lt;name&gt; <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>&lt;name&gt;</code> is the name of your bootstrap stack.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Complete the cluster installation:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ ./openshift-install --dir=&lt;installation_directory&gt; wait-for install-complete <i class="conum" data-value="1"></i><b>(1)</b>

INFO Waiting up to 30m0s for the cluster to initialize...</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For <code>&lt;installation_directory&gt;</code>, specify the path to the directory that you
stored the installation files in.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Ignition config files that the installation program generates contain certificates that expire after 24 hours. You must keep the cluster running for 24 hours in a non-degraded state to ensure that the first certificate rotation has finished.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Next steps</div>
<ul>
<li>
<p><a href="../../installing/install_config/customizations.html#customizations">Customize your cluster</a>.</p>
</li>
<li>
<p>If necessary, you can
<a href="../../telemetry/opting-out-of-telemetry.html#opting-out-of-telemetry">opt out of telemetry</a>.</p>
</li>
</ul>
</div>
</div>
</div>
      </div>
    </div>
  </div>

  <script src="https://assets.openshift.net/content/modernizr.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/subdomain.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/nav-tertiary.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/reformat-html.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/hc-search.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/page-loader.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/clipboard.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/collapsible.js" type="text/javascript"></script>

  <script>
  var dk = 'openshift-enterprise';
  var version = '4.1';

  var distros = {
    'openshift-origin': ['docs_origin', version],
    'openshift-dedicated': ['docs_dedicated', version],
    'openshift-online': ['docs_online', version],
    'openshift-enterprise': ['docs_cp', version],
    'openshift-aro' : ['docs_aro', version],
    'openshift-rosa' : ['docs_rosa']
  };

  distros[dk] ? hcSearchCategory.apply(null, distros[dk]) : hcSearchCategory("docs");
  </script>

  <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='ssgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='ssgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });

      const collapsibleContent = document.getElementsByTagName("details");
        for (var i=0; i < collapsibleContent.length; i++) {
          collapsibleContent[i].setAttribute("open", "");
        }

    });
    /*]]>*/
  </script>
  <footer id="rh">
    <div class="container">
        <div class="row">
            <div class="col-sm-2">
                <img src="https://assets.openshift.com/hubfs/images/logos/Logo-RedHat-A-Reverse-RGB.svg" class="img-fluid" alt="Red Hat" style="height: 30px;">
            </div>

            <div class="col-sm-3">
                <p class="text-nowrap">Copyright © 2021 Red Hat, Inc.</span></p>
            </div>

            <div class="col">
                <nav class="nav">
                    <a target="_blank" href="https://www.redhat.com/en/about/privacy-policy" class="nav-link">Privacy statement</a>
                    <a target="_blank" href="https://www.openshift.com/legal/terms/" class="nav-link">Terms of use</a>
                    <a target="_blank" href="https://www.redhat.com/en/about/all-policies-guidelines" class="nav-link">All policies and guidelines</a>
                </nav>
            </div>
        </div>
    </div>
</footer>

<!-- Adobe DTM -->
<script type="text/javascript">
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
   _satellite.pageBottom();
}
</script>
<!-- End Adobe DTM -->
</body>
</html>